#!/bin/sh

if [ "$1" == "--help" ]; then
	echo "missing xorg packages"
	exit 1
fi
if [ ! -d ../.git -o ! -d ../source ]; then
	echo "hey, where are you?"
	exit 1
fi

cd ..

upstream=`mktemp`
fw=`mktemp`

for i in app data doc driver font lib proto testdir util xserver
do
	lynx -dump http://xorg.freedesktop.org/releases/individual/$i/|grep bz2$|sed 's|.*/\(.*\)-.*|\1|'
done |sort -u |tr '[A-Z]' '[a-z]'>$upstream
ls source/x11|sed 's|/$||' >$fw
# xf86-video-impact is mips-only :)
# xf86-video-wsfb is for *bsd
# xf86-video-i810: replaced by xf86-video-intel
# compiz is in x11-extra
# mkcfm is removed by priyank
# xkbdata deprecated | not maintained anymore. xkeyboard-config replaced it. 
# xf86-video-glide: makedepends on xfree86..
# constype is solaris-only
diff -u $upstream $fw|grep ^-[^-] |grep -v \
'\(xf86-video-impact\|xf86-video-wsfb\|xf86-video-i810\|compiz\|mkcfm\|xkbdata\|xf86-video-glide\|constype\)'|sed 's/^-//'
rm -f $upstream $fw
