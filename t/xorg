#!/bin/sh

if [ "$1" == "--help" ]; then
	echo "missing xorg packages"
	exit 1
fi
if [ ! -d ../.git -o ! -d ../source ]; then
	echo "hey, where are you?"
	exit 1
fi

cd ..

upstream=`mktemp`
fw=`mktemp`

for i in app data doc driver font lib proto testdir util xserver
do
	lynx -dump http://xorg.freedesktop.org/releases/individual/$i/|grep bz2$|sed 's|.*/\(.*\)-.*|\1|'
done |sort -u |tr '[A-Z]' '[a-z]'>$upstream
ls source/x11|sed 's|/$||' >$fw
# xf86-video-impact is mips-only :)
# xf86-video-wsfb is for *bsd
# compiz is uhh? won't work :p
# mkcfm is removed by priyank
# xkbdata deprecated | not maintained anymore. xkeyboard-config replaced it. 
# xf86-video-vermilion: requires xorg-server >= 1.3.99.0
# xf86-video-intel: requires xorg-server >= 1.2.99.0
# xf86-video-glide: makedepends on xfree86..
# grandr: requires xrandr >= 1.2. initial FB @ http://yugo.frugalware.org/~vmiklos/grandr/FrugalBuild
diff -u $upstream $fw|grep ^-[^-] |grep -v \
'\(xf86-video-impact\|compiz\|xf86-video-wsfb\|mkcfm\|xkbdata\|xf86-video-vermilion\|xf86-video-intel\|xf86-video-glide\|grandr\)'|sed 's/^-//'
rm -f $upstream $fw
