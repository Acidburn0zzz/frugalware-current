\chapter{Az Init}
\label{chap:init}
\section{A rendszermagról}


A Linux magja a {\tt kernel} csomagban van. Olyan kevés patchet próbálunk használni
amennyit csak lehet, hogy közel maradjunk az eredeti Linux maghoz.
Egyetlen kivétel a {\tt bootsplash} patch, ami lehetõvé teszi, hogy szép boot képünk legyen.
A rendszermag alapértelmezetten tartalmazza az IDE disk vezérlõt,
de minden alacsony szintû SCSI driver rendszermag modulként van forgatva.
Ha a Frugalware magja nem támogatja az Ön lemezvezérlõjét, akkor saját magot
is fordíthat. Ne féljen, nem bonyolult.

1) Ha a Telepítés befejezõdik, válassza a "csinál valami speciálisat" menüpontot.

2) Változtassa meg a root könyvtárát {\tt /mnt/target} a {\tt chroot /mnt/target} paranccsal.

3) A rendszermag forráskódját (a hozzáadott patchekkel együtt) megtalálja a {\tt /usr/src/linux} könyvtárban.
Menjen a {\tt/usr/src/linux} könyvtárba, indítsa el a konfigurációs menüt ezzel a paranccsal {\tt make menuconfig}.
Válassza ki azt a drivert amit nem akar, hogy tovább modulként legyen fordítva, mentse el a beállítást és hagyja el a menüt.

4.) A magot a {\tt make} paranccsal fordíthatja le. Ez eltarthat akár néhány tíz percig is.

5.) Másolja át a magot a {\tt /boot} könyvtárba ezzel a paranccsal {\tt cp /usr/src/linux/arch/\textit{yourarch}/boot/bzImage /boot/vmlinuz}.
x86-on a \textit{yourarch} i386.
   
Ez minden.

\section{Init szkriptek}

A Frugalware-ban az init szkriptek a következõ módon vannak jelölve: rc.valami és a {\tt /etc/rc.d} könyvtárban találhatóak meg.

Ezeket a szkripteket a {\tt service} paranccsal menedzselheti:  

{\tt service adsl stop} - leállítja az adsl kapcsolatot

{\tt service httpd start} - elindítja a webszervert

{\tt service clamd add} - a clamd szolgáltatás ez után minden rendszerindításkor elindul

{\tt service sshd del} - az sshd szolgáltatás nem indul el automatikusan rendszerinduláskor

{\tt service acpid list} - kiír egy rövid listát arról hogy az acpid szolgáltatás mely futás szinteken indul el automatikusan


\section{Start mechanizmus}

Ha nem ad meg extra {\tt init=/path/to/init} paramétert, akkor a rendszermag az {\tt /sbin/init}-et fogja elindítani.
Az {\tt init} megkeresi az {\tt /etc/inittab} filet és elindít

1.) minden {\tt S*} szkriptet a {\tt /etc/rc.d/rcS.d} könyvtárból,

2.) minden {\tt S*} szkriptet a {\tt /etc/rc.d/rc\textit{n}.d} könyvtárból, ahol az \textit{n} az alapértelmezett futásszintet jelenti.
Ez alapértelmezetten 4-re van beállítva.

A lehetséges futásszintek listája:

0 = leállás

1 = egyfelhasználós mód

2 = nem használt (beállítva ugyanarra mint a 3-as)

3 = többfelhasználós mód (karakteres módban)

4 = X11 KDM/GDM/XDM (alapértelmezett mód a Frugalwareban)

5 = nem használt (beállítva ugyanarra mint a 3-as)

6 = reboot

Ha az X11 be van állítva, akkor a {\tt /etc/rc.d/rc.4} elindítja a desktop környezetet, ami a {\tt /etc/sysconfig/desktop}-ban van beállítva.

\section{GRUB gfxmenu}

A Frugalware tartalmaz egy szép grafikus grub menüt (köszönet a gfxmenu fejlesztõinek a SuSE-ból).
Ha Önnek ez mégsem tetszik, kikapcsolhatja a gfxmenu-t a grub beállító file-jában {\tt /boot/grub/menu.lst}. Mint pl.:

Elõtte: 
{\tt gfxmenu (hd0,5)/boot/grub/message}

Utána:
{\tt # gfxmenu (hd0,5)/boot/grub/message}


\section{Bootsplash}

A Frugalware rendszermagjában van egy bootsplash patch. Ennek köszönhetõen a felhasználó szép
képet és grafikát láthat a rendszer indulása alatt.
Ha elõnybe helyezi a beszédes módot, és nem akarja minden esetben lenyomni az {\tt F2} gombot,
vagy teljesen ki akarja kapcsolni a bootsplasht, akkor szükséges lesz, hogy hozzáadjon egy extra
paramétert a {\tt /boot/grub/menu.lst}-ben a rendszermag számára.


\begin{tabular}{ll}
{\tt splash=silent} & csendes mód  (alapértelmezett mód a GRUB gfxmenuvel) \\
{\tt splash=verbose} & beszédes mód, szép háttérrel (alapértelmezett mód GRUB gfxmenu nélkül)\\
{\tt splash=none} & teljesen kikapcsolja a bootsplasht \\
\end{tabular}


\textbf{Figyelmeztetés!}: \textit{Nem} használhat framebuffert 24 bit színmélységgel és bootsplash-el együtt.

Összefoglaló a {\tt vga=} paramétereirõl amit használhat és amit \textit{nem}:

\begin{tabular}{lll}
 & 800x600 & 1024x768 \\
16 bit (jó) &  788 & 791 \\
24 bit (rossz) &  789 & 792 \\
\end{tabular}
