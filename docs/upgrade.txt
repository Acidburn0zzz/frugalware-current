= Upgrading from Frugalware 1.1 to 1.2

== Preamble

The aim of this howto is to show how you can upgrade a Frugalware-1.1
(Getorin) system to Frugalware-1.2 (Locris).

== pacman-g2

Locris comes with an improved pacman-g2, so the first step is to
install it:

----
# pacman-g2 -Sy pacman-g2
-----

//== Removing obsolete packages
//
//Some software has been marked as obsolete in Getorin. To remove them:
//
//----
//# pacman-g2 -Rd pygobject-gvfs gst-plugins-bad-x264
//----

== Upgrading the system

Now it's time to upgrade the system itself:

----
# pacman-g2 -Su
:: Replace bluez-libs with frugalware/bluez? [Y/n] 
:: Replace fast-user-switch-applet with frugalware/gdm? [Y/n] 
:: Replace frugalrledit with frugalware/gservice? [Y/n] 
:: Replace nuvola with frugalware/kdeartwork? [Y/n] 
:: Replace dbus-qt3 with frugalware/kdebase-workspace? [Y/n] 
:: Replace kdeaddons with frugalware/kdeplasma-addons? [Y/n] 
:: Replace libungif with frugalware/libgif-libungif? [Y/n] 
:: Replace perl-xml-libxml-common with frugalware/perl-xml-libxml? [Y/n] 
:: Replace xf86-input-magictouch with frugalware/xf86-input-keyboard? [Y/n] 
:: Replace xf86-input-microtouch with frugalware/xf86-input-keyboard? [Y/n] 
:: Replace xf86-input-calcomp with frugalware/xf86-input-mouse? [Y/n] 
:: Replace xf86-input-digitaledge with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-dmc with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-elo2300 with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-jamstudio with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-magellan with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-palmax with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-spaceorb with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-summa with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-tek4957 with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-input-ur98 with frugalware/xf86-input-mouse? [Y/n]
:: Replace xf86-video-cyrix with frugalware/xf86-video-geode? [Y/n]
:: Replace xf86-video-via with frugalware/xf86-video-openchrome? [Y/n]
:: Replace xf86-video-vga with frugalware/xf86-video-vesa? [Y/n]
:: Replace lbxproxy with frugalware/xorg-server? [Y/n]
:: Replace proxymngr with frugalware/xorg-server? [Y/n]
:: Replace liblbxutil with frugalware/xorg-server? [Y/n]
----

You will be asked to replace the above packages automatically.  These
are normal and you are expected to answer 'Y' to these questions (or
just hit ENTER).

After this, the list of to-be-upgraded packages is displayed. Just hit
enter and wait. Make some tea, it can take a while. :-)

//== Installing replacement packages
//
//In case you removed anything in section 3, now you can install the
//replacement packages:
//
//----
//# pacman-g2 -S gst-plugins-ugly-x264
//----

== Kernel-Mode Setting

If you are not using an Intel or a Radeon video card (kernel module
names: i915 and readeon), then just skip this section.

KMS is enabled by default in Locris for Intel and Radeon cards.

KMS stands for Kernel-Mode Setting, more
http://kerneltrap.org/node/8242[here].

If you upgrade and you just reboot, you will have a blank framebuffer,
but once X comes up, you will have a working system. To avoid this
situation you have to edit your `/boot/grub/menu.lst` and remove the
`vga=791` (or similar) kernel parameter from the kernel command line.
That way you will have a similar framebuffer as before.

If you did not have a `vga=` line before (because you manually removed
it) and now you are angry about having a framebuffer, you can add
`i915.modeset=0` to the kernel command line and you will no longer have
a framebuffer.

== UDev config files

We used to have all rules under `/etc/udev/rules.d`, but nowadays only
the configfile-like rules (network interface naming, etc) ones are
there, the rest lives under `/lib/udev/rules.d`. Because of this, we
moved the `/etc/udev/rules.d/50-udev.rules` file to
`/lib/udev/rules.d/50-udev-default.rules`. It's possible that the old
`/etc/udev/rules.d/50-udev.rules` file is still there, if you have drm
problems, please check if you need to remove it.

== KDE 4.x upgrade

KDE has been upgraded from the old 3.x series to the new 4.x one. This
is a major change, multiple parts of the Software Compilation has been
completely rewritten, and as a result, sometimes the old configuration
files are not parsed completely. So be warned, it's expected that you
need to re-configure a few of your favorite KDE applications before they
are ready to work again.

== DHCP client 5.x upgrade

We shipped the DHCP client daemon 3.x series in Getorin and now we
updated to 5.x in Locris. This includes a major internal dhcpcd rework,
but there should be no big incompatibility on the user side. (See
http://roy.marples.name/projects/dhcpcd/wiki/DhcpcdHistory[here] for a
more detailed history.) Minor issues may appear, for example if you do
not want dhcpcd touch your `/etc/resolv.conf` file, and you used the
following directive in a `netconfig` profile:

----
dhcp_opts = -R
----

now you need:


----
dhcp_opts = -C 20-resolv.conf
----

== The reboot

Since the kernel is upgraded, too, you have to reboot your machine.

Done!
