= Upgrading from Frugalware 1.3 to 1.4

== Preamble

The aim of this howto is to show how you can upgrade a Frugalware-1.3
(Haven) system to Frugalware-1.4 (Nexon).

== pacman-g2

The new release comes with an improved pacman-g2, so the first step is
to install it:

----
# pacman-g2 -Sy pacman-g2
-----

== Removing obsolete packages

Some software has been marked as obsolete in the new release. To remove
them:

----
# pacman-g2 -Rd gvfs-gconf
----

The LIRC kernel driver is not part of the default install, but in case
you had it installed, that's now part of the stock kernel, so remove the
separate package:

----
# pacman-g2 -Rd lirc_modules
----

== Backing up config files

sysvinit configuration will be moved from the `sysvinit` package to
`sysvinit-initscripts` that allows having System V init scripts around
even after `sysvinit` itself will be replaced by `systemd`. As a result,
`/etc/inittab` and `/etc/rc.d/rc.local` will be reinstalled. If you have
any valuable customization there, don't forget to make a backup. (Or
just install the `etckeeper` package.)

== Upgrading the system

Now it's time to upgrade the system itself:

----
# pacman-g2 -Su
:: Starting local database upgrade...
----

You will be asked to replace some packages automatically.  These are
normal and you are expected to answer 'Y' to these questions (or just
hit ENTER).

After this, the list of to-be-upgraded packages is displayed. Just hit
enter and wait. Make some tea, it can take a while. :-)

== Updating config files

`pacman-g2` does not touch configuration files in case you customized
them. You should run

----
# find /etc -name '*.pacnew'
----

and update each configuration file based on the `.pacnew` version. Once
you're done with one, you should remove the `.pacnew` file.

== systemd

systemd is not yet the default init system in Nexon, but it's available
for testing. It's installed (but disabled) by default on new installs,
but if you want to try it out after an upgrade, you have to install it
manually:

----
# pacman-g2 -Sy systemd
----

If you want to enable it as well, append

----
init=/bin/systemd
----

to your kernel commandline. Whenever you want to return to sysvinit,
just remove this token from there.

== The reboot

Since the kernel is upgraded, too, you have to reboot your machine.

NOTE: The newer kernel version in Nexon enables KMS (Kernel
Mode-Setting) for more cards, including NVidia cards via the nouveau
drivers. If the boot just hangs after the reboot, a good idea is to try
booting using the `nomodeset` kernel parameter.

Done!
