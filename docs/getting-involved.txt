= This is a small tutorial for those who want to contribute to Frugalware

In the first part i will cover the necessary informations for those who
do _not_ have developer status yet.

In the second part we will set up the necessary config files.

First of all, we ask you to read the following documentations carefully:

* man makepkg
* man pacman-g2
* man repoman
* man FrugalBuild
* man fwmakepkg
* http://frugalware.org/docs/makepkg[makepkg howto]
* http://www.darcs.net/manual/node4.html[darcs getting started]

I know, it is boring reading documentation, but you have to know that
writing them is even worse so do not ask questions when there is the
answer in the documentation. If you can not understand something
feel free to join #frugalware@irc.freenode.net and ask.

== Getting the frugalware-current repo

The frugalware-current repo is the development repo for the packages.

When you want to get it you need the darcs package. Let's get it:
------------------
pacman-g2 -S darcs
------------------

Now create a darcs directory where you can hold all your repos. You can
choose any other name of course.
-----------
mkdir darcs
cd darcs
-----------

Now get the repo with darcs:
------------------------------------------------------------------------------------------------------------
darcs get --partial http://ftp5.frugalware.org/packages/frugalware/pub/frugalware/frugalware-current current
------------------------------------------------------------------------------------------------------------

Now be patient while darcs gets all the patches and then applies them. You
may wonder what is the '--partial' option for. When you use --partial darcs
will not get all the patches, just the ones applyied after the last checkout.
It makes this procedure lot faster. Also you can use other mirrors as well.

Now you should add yourself as an author, otherwise darcs will ask for your
name all the time.
-----------------------------------------------------
cd current
echo 'yourname <email@addr.ess>' >_darcs/prefs/author
-----------------------------------------------------

Now you can make your changes. When finished

----------
darcs what
----------

will show you what you have done. If you satisfied with the changes run

------------
darcs record
------------

to record the changes. You can not send in or push(just devels) patches until
you do not record them.

Here comes the final step. Send in the patch!

----------
darcs send
----------

If everything goes fine your patch should show up on
http://frugalware.org/mailman/listinfo/frugalware-devel[frugalware-devel]
mailing list soon.

NOTE: You have to subscribe to http://frugalware.org/mailman/listinfo/frugalware-devel[frugalware-devel]
mailing list and set up your SMTP server properly.

== Further options for those who have developer account

Once you get a developer account, you have the right to request the following services:

* BTS access (so that we can assign tasks to you)
* darcs write access (you'll always get this, except if you are working on the artwork or so)
* voice on the #frugalware.dev channel
* a @frugalware.org mail address (with imaps/pop3s access)

What you should do:

* You should read the frugalware-devel mailing list. When you're asked, please try to respond.
* If you push patches to darcs, you should subscribe to the frugalware-darcs mailing list. This is list has a big traffic since a new mail is sent for each patch. If you don't have time to read it, subscribe then set the "I would like to reveive no mail" option.
* Also it's good if you can join the user and developer channel when you're online.

Let us see what you should set up to get it work. I will also give some tips
which can make your life easier.

As you will use darcs almost all the time it is a good idea to set up an alias.
----------------------------------------
echo 'alias dr=darcs' >> ~/.bash_profile
----------------------------------------

You should also note that darcs automatically completes its commands, so from
now 'darcs whatsnew' and 'dr what' does exactly the same.

It is time to set up some necessary things. We start with the frugalware-current
repo. Make sure that you are in the root of the frugalware-current repo. Also
do not forget to change the username to your login name on darcs.frugalware.org.
----------------------------------------------------------------------------------------------------------
echo 'username@darcs.frugalware.org:/home/ftp/pub/frugalware/frugalware-current' >_darcs/prefs/defaultrepo
echo 'push apply-as vmiklos' >> _darcs/prefs/defaults
----------------------------------------------------------------------------------------------------------

Do not edit the second line! So that vmiklos have to be vmiklos. It's because the
permissions on the server.

As you will use repoman to upload the fpms (and many other things as you'll see)
we should set it up now. This step is also necessary. Open '~/.repoman.conf' with
your favourite editor and add the following lines:
---------------------------------------------------------------------------------------------
fst_root=~/darcs
current_servers=("username@darcs.frugalware.org:/home/ftp/pub/frugalware/frugalware-current")
stable_servers=("username@darcs.frugalware.org:/home/ftp/pub/frugalware/frugalware-stable")
stable_pushonly="y"
---------------------------------------------------------------------------------------------

Where fst_root is the directory where you store your darcs repos. Username
is your login on darcs.frugalware.org. For details see man repoman.

Now you can try to push your first patch. Go into the directory of the
package and call

------------
darcs what .
------------

It will show your changes in the given directory, so it won't confuse you
if you have got more than one unrecorded change. If the patch seems to be
fine call

------------
repoman push
------------

It will check the FrugalBuild using fblint, then records your changes,
pushes them, uploads the fpms and finally creates the changelog, updates
the fdb etc. So you are done if there was no error message.
