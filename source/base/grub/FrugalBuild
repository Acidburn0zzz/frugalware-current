# Last Modified: Sun Oct 31 11:42:18 CET 2004
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=grub
pkgver=0.95
pkgrel=5
pkgdesc="A GNU multiboot boot loader"
url="http://www.gnu.org/software/grub/"
up2date=`wget --passive-ftp -O - -q ftp://alpha.gnu.org/gnu/grub/ |grep -v sig |grep tar.gz|tail -n 1|cut -d '>' -f 2|cut -d '<' -f 1|sed 's/.tar.gz//'|cut -d - -f 2`
source=(ftp://alpha.gnu.org/gnu/grub/grub-$pkgver.tar.gz \
	grub-$pkgver-gfxboot.diff grubconfig)
depends=('ncurses' 'diffutils')
makedepends=('gfxboot')
md5sums=('4ca8e4363d5f1980f2c63b7f5cdbe0d1' '6ac851aa29c97a2a546859ca67a3a309' \
	 'f96b5d19bc6c5c42d083cb400c65afa5')

# original patch was for debian at
# http://neverborn.org/files/grub-gfxboot/source/grub-gfxboot/ and
# http://www.morphix.org/debian/source/grub-gfxboot/

build() {
	cd $startdir/src/$pkgname-$pkgver
	patch -p1 < $startdir/src/$pkgname-$pkgver-gfxboot.diff
	./configure --prefix=/usr --bindir=/bin --sbindir=/sbin
	
	make || return 1
	
	make prefix=$startdir/pkg/usr bindir=$startdir/pkg/bin \
		sbindir=$startdir/pkg/sbin install
	# message
	mkdir -p $startdir/pkg/boot/grub
	cd /usr/share/gfxboot/themes/frugalware
	mkbootmsg -c frugalware.config message
	mv message $startdir/pkg/boot/grub
	# grubconfig
	mkdir -p $startdir/pkg/var/lib/frugalware/{system,messages}
	install -m755 $startdir/src/grubconfig \
		$startdir/pkg/var/lib/frugalware/system/
	install -m644 $startdir/messages/grubconfig.* \
		$startdir/pkg/var/lib/frugalware/messages/
	cd $startdir/pkg/sbin/
	ln -s ../var/lib/frugalware/system/grubconfig ./
}

# vim: ft=sh
