# Compiling Time: 0.39 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

USE_DEVEL=${USE_DEVEL:-"n"}

pkgname=pacman-g2
pkgver=3.6.3
Fuse $USE_DEVEL && pkgver=3.6.2.10.g928a3ae
pkgrel=3sayshell2
pkgdesc="A .tar.bz2 based package manager library (libpacman) and client (pacman-g2) with dependency support."
url="http://ftp.frugalware.org/pub/other/pacman-g2/"
backup=(etc/{makepkg,pacman}.conf etc/pacman.d/{frugalware,frugalware-current})
depends=('libarchive>=2.0.27' 'glibc>=2.6-2')
makedepends=('doxygen' 'po4a' 'swig' 'java-gcj-compat' 'ecj' 'mono')
Fuse $USE_DEVEL && makedepends=(${makedepends[@]} 'intltool')
Finclude mono
groups=('base' 'chroot-core')
archs=('i686' 'x86_64' 'ppc')
up2date="lynx -dump $url/releases/ |Flasttar"
if ! Fuse $USE_DEVEL; then
	source=($url/releases/$pkgname-$pkgver.tar.gz \
		http://git.frugalware.org/patches/pacman-g2/5e0c759d50e2eb629a08ebc1944ebfe6b452c9c5.patch \
		stable.diff)
	signatures=("$source.asc" '' '')
else
	_F_scm_type="git"
	_F_scm_url="http://git.frugalware.org/repos/pacman-g2/.git/"
	Finclude scm
fi

build()
{
	if Fuse $USE_DEVEL; then
		Funpack_scm
		Fsed '\(^AC_INIT(.*, \)[0-9\.]\+\(, .*\)' "\1$pkgver\2/" configure.ac
		sh autogen.sh
	fi
	Fcd
	lynx -source -dump 'http://git.frugalware.org/gitweb/gitweb.cgi?p=translations.git;a=blob_plain;f=po/pacman/da/libpacman.po;hb=HEAD' > lib/libpacman/po/da.po
	lynx -source -dump 'http://git.frugalware.org/gitweb/gitweb.cgi?p=translations.git;a=blob_plain;f=po/pacman/da/pacman-g2.po;hb=HEAD' > src/pacman-g2/po/da.po
	Fbuild_mono
}

# optimization OK
