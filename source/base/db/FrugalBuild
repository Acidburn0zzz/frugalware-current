# Compiling Time: 1.31 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=db
pkgver=4.6.21
pkgrel=2
pkgdesc="The Berkeley DB embedded database system"
url="http://www.sleepycat.com"
depends=('libstdc++>=4.3.0-3')
groups=('base' 'chroot-core')
archs=('i686' 'x86_64' 'ppc')
up2date="lynx -dump http://www.oracle.com/technology/software/products/berkeley-db/index.html|grep '\]Berkeley DB'|sed 's/.*DB \([^ ]*\) .*/\1/;q'"
source=(http://download.oracle.com/berkeley-db/db-$pkgver.tar.gz)
sha1sums=('5be3beb82e42a78ff671a3f5a4c30e5652972119')
[ "$CARCH" == "x86_64" ] && Fconfopts="$Fconfopts --with-mutex=x86/gcc-assembly"

###
# NOTE! Every time you bump this package, perl-berkeleydb needs bumping, too!
##

build()
{
	
	Fcd
	cd build_unix || Fdie
	../dist/configure $Fconfopts --enable-compat185 \
		--enable-shared --enable-static --enable-cxx || Fdie

	make LIBSO_LIBS=-lpthread || return 1
	
	Fmakeinstall
	
	Fmkdir /usr/share/doc/$pkgname-$pkgver
	Fmv /usr/docs/* /usr/share/doc/$pkgname-$pkgver/
	Frm /usr/docs/
	cp -a ../docs $Fdestdir/usr/share/doc/$pkgname-$pkgver/ || Fdie
}

# optimization ok
