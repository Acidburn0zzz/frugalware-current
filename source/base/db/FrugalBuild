# Compiling Time: 1.31 SBU
# Maintainer: crazy <crazy@frugalware.org>
# Contributor: Miklos Vajna <vmiklos@frugalware.org>

pkgname=db
pkgver=6.2.23
pkgrel=1
pkgdesc="The Berkeley DB embedded database system"
url="http://www.oracle.com/technetwork/database/database-technologies/berkeleydb/downloads/index.html"
depends=('libstdc++>=6.2.1-5')
groups=('base' 'chroot-core')
archs=('i686' 'x86_64')
up2date="Flasttar $url"
source=(http://download.oracle.com/berkeley-db/db-$pkgver.tar.gz)
sha1sums=('646c57b99799dc300207976e2270cdaca1a2f198')

###
# NOTE! Every time you bump this package, perl-berkeleydb needs bumping, too!
##

build()
{
	[ "$CARCH" == "x86_64" ] && Fconfopts+=" --with-mutex=x86/gcc-assembly"

	Fcd
	cd build_unix || Fdie
	_F_conf_configure=../dist/configure
	Fconf --enable-compat185 \
		--enable-shared \
		--disable-static \
		--enable-cxx \
		--enable-stl \
		--enable-localization \
		--enable-dbm

	make LIBSO_LIBS=-lpthread || Fdie

	Fmakeinstall

	Frm /usr/docs/
	# add compat symlink, for example for LibreOffice
	Fln . /usr/include/db
}

# optimization ok
