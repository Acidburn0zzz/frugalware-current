# Last Modified: Tue, 11 Oct 2005 00:16:49 +0200
# Compiling Time: ~1.10 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=db
pkgver=4.3.29
pkgrel=2
pkgdesc="The Berkeley DB embedded database system"
url="http://www.sleepycat.com"
depends=('libstdc++')
makedepends=('j2sdk')
groups=('base' 'chroot-core')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.sleepycat.com/download/db/index.shtml |grep 'With encryption' -3 |grep tar.gz |sed -n '1 p'|sed 's/.tar.gz//'|cut -d ] -f 2"
source=(ftp://sleepycat1.inetu.net/releases/$pkgname-$pkgver.tar.gz)
sha1sums=('7ddac51fcbd5945aed154be2ee1fe166b3acd628')
[ "$CARCH" == "x86_64" ] && opts="--with-mutex=x86/gcc-assembly"

build()
{
	Fcd $pkgname-$pkgver/build_unix
	../dist/configure --prefix=/usr --enable-compat185 \
		--enable-shared --enable-static --enable-cxx \
		--enable-java $opts
	
	make LIBSO_LIBS=-lpthread || return 1
	
	Fmakeinstall
	Fln libdb-4.3.so /usr/lib/libdb-4.2.so
	
	Fmkdir /usr/share/java
	Fmv usr/lib/db.jar usr/share/java/
	Fmkdir /usr/share/doc/$pkgname-$pkgver
	Fmv /usr/docs/* /usr/share/doc/$pkgname-$pkgver/
	Frm /usr/docs/
}

# optimalization ok

# vim: ft=sh
