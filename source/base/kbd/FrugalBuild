# Last Modified: Sat, 18 Mar 2006 22:19:51 +0100
# Compiling Time: 0.05 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=kbd
pkgver=1.12
pkgrel=17
pkgdesc="Keyboard maps and console fonts"
url="http://www.ibiblio.org/pub/Linux/system/keyboards/"
up2date="lynx -dump 'http://www.ibiblio.org/pub/Linux/system/keyboards/?M=D'|grep kbd.*tar.gz$|sed -n 's/.*d-\(.*\)\.t.*/\1/;1 p'"
depends=('sed' 'bash')
rodepends=('bootsplash')
groups=('base')
archs=('i686' 'x86_64' 'ppc')
backup=(etc/sysconfig/font)
install=$pkgname.install
source=(ftp://ftp.win.tue.nl/pub/linux-local/utils/$pkgname/$pkgname-$pkgver.tar.gz \
	$pkgname-$pkgver-{alias,find_map_fix}.patch fontconfig fontconfig.en rc.font \
	rc.font-{de,hu}.po rc.keymap rc.keymap-{de,hu}.po font)
sha1sums=('d4917da308e01e74d67d7b814bf527063b3919fc' \
	  '2a266a3fc520371bba9050ea8fa13f4592892e83' \
	  '420fd29fc06e3518dac3fac8003c8ac71ae3b28e' \
	  '45e7873f885568afc79ddc3bb76043f6b6f70d2e' \
	  'c4349670a04110f9921a339b283c64715caefb94' \
	  '573be433c7e8864f17c7328b6e4114c89c908019' \
	  '7b1e17e399608f54ff70ac22cf8e697e01ea6b23' \
	  'd385735e880bea9f8444dfbc5144007eaaffee32' \
	  '6c0f9f8eae09b57687c43a8298fea5deb6b6e4a5' \
	  'beceda61cdf168e4063873a9ea6312dbc8284613' \
	  'b9c50c54c7f3b1efce7858a39b0dd7490cc742a3' \
	  '84e361527f415ef4d560b3e6affea0d463d544de')

build()
{
	# optimalization
	Fcd
	for i in `find . -name Makefile.in` ; do
		Fsed "^CFLAGS  =" "CFLAGS  +=" $i
	done
	# main package
	Fbuild
	# init script
	Frcd2 font
	Frcd2 keymap
	# setup
	Fexe /var/lib/frugalware/system/fontconfig
	Ffile /var/lib/frugalware/messages/fontconfig.en
	# wrapper script
	Fmkdir /usr/sbin
	echo -e '#!/bin/bash\n\n/var/lib/frugalware/system/font $1' > $Fdestdir/usr/sbin/fontconfig
	chmod 755 $Fdestdir/usr/sbin/fontconfig
	# config
	Ffile /etc/sysconfig/font
}

# optimalization OK
