# Last Modified: Sat, 19 Nov 2005 13:26:55 +0100
# Compiling Time: 0.05 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=kbd
pkgver=1.12
pkgrel=13
pkgdesc="Keyboard maps and console fonts"
up2date="lynx -dump 'http://www.ibiblio.org/pub/Linux/system/keyboards/?M=D'|grep kbd.*tar.gz$|sed -n 's/.*d-\(.*\)\.t.*/\1/;1 p'"
depends=('sed' 'bash' 'glibc' 'bootsplash')
groups=('base')
archs=('i686' 'x86_64')
backup=(etc/sysconfig/font)
install=$pkgname.install
source=(ftp://ftp.win.tue.nl/pub/linux-local/utils/$pkgname/$pkgname-$pkgver.tar.gz \
        fontconfig fontconfig.en rc.font rc.font-{de,hu}.po rc.keymap \
	rc.keymap-{de,hu}.po font)
sha1sums=('d4917da308e01e74d67d7b814bf527063b3919fc' \
          '45e7873f885568afc79ddc3bb76043f6b6f70d2e' \
          'c4349670a04110f9921a339b283c64715caefb94' \
          '2fdb90083c235fa9525956c5b02201e2b9523d6a' \
          '7b1e17e399608f54ff70ac22cf8e697e01ea6b23' \
          'd385735e880bea9f8444dfbc5144007eaaffee32' \
          '4299348df9ba5b8674d1a56cd1813ce9b666a7a6' \
          'beceda61cdf168e4063873a9ea6312dbc8284613' \
          'b9c50c54c7f3b1efce7858a39b0dd7490cc742a3' \
          '84e361527f415ef4d560b3e6affea0d463d544de')

build()
{
	# optimalization
	Fcd
	for i in `find . -name Makefile.in` ; do
		Fsed "^CFLAGS  =" "CFLAGS  +=" $i
	done
	# main package
	Fbuild
	# init script
	Frcd2 font
	Frcd2 keymap
	# setup
	Fexe /var/lib/frugalware/system/fontconfig
	Ffile /var/lib/frugalware/messages/fontconfig.en
	# wrapper script
	Fmkdir /usr/sbin
	echo -e '#!/bin/bash\n\n/var/lib/frugalware/system/font $1' > $Fdestdir/usr/sbin/fontconfig
	chmod 755 $Fdestdir/usr/sbin/fontconfig
	# config
	Ffile /etc/sysconfig/font
}

# vim: ft=sh

# optimalization OK
