# Last Modified: Sun, 30 Oct 2005 15:24:56 +0100
# Compiling Time: 0.05 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=kbd
pkgver=1.12
pkgrel=11
pkgdesc="Keyboard maps and console fonts"
up2date="lynx -dump 'http://www.ibiblio.org/pub/Linux/system/keyboards/?M=D'|grep kbd.*tar.gz$|sed -n 's/.*d-\(.*\)\.t.*/\1/;1 p'"
depends=('sed' 'bash' 'glibc' 'bootsplash')
groups=('base')
archs=('i686' 'x86_64')
backup=(etc/sysconfig/{font,keymap})
install=$pkgname.install
source=(ftp://ftp.win.tue.nl/pub/linux-local/utils/$pkgname/$pkgname-$pkgver.tar.gz \
        fontconfig rc.font rc.keymap font keymap)
sha1sums=('d4917da308e01e74d67d7b814bf527063b3919fc' \
          '45e7873f885568afc79ddc3bb76043f6b6f70d2e' \
          '6cc2260c08c916cf8d8f189f2f490f93d1e43baf' \
          'ffb715102c5c0ce95f656bf3653b915c6fb09c0b' \
          '84e361527f415ef4d560b3e6affea0d463d544de' \
          'baf65f475c098155cf457be59e95648d2975e55c')

build()
{
	# optimalization
	Fcd
	for i in `find . -name Makefile.in` ; do
		Fsed "^CFLAGS  =" "CFLAGS  +=" $i
	done
	# main package
	Fbuild
	# init script
	Frcd font
	Frcd keymap
	Frm /etc/rc.d/rc.messages/fontconfig.en
	# setup
	Fexe /var/lib/frugalware/system/fontconfig
	for i in $Fsrcdir/../messages/fontconfig.* ; do
		Ffile ../messages/`basename $i` /var/lib/frugalware/messages/`basename $i`
	done
	# wrapper script
	Fmkdir /usr/sbin
	echo -e '#!/bin/bash\n\n/var/lib/frugalware/system/font $1' > $Fdestdir/usr/sbin/fontconfig
	chmod 755 $Fdestdir/usr/sbin/fontconfig
	# config
	Ffile /etc/sysconfig/font
	Ffile /etc/sysconfig/keymap
}

# vim: ft=sh

# optimalization OK
