# Last Modified: Wed Aug 18 12:28:05 CEST 2004
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=dcron
pkgver=2.9
pkgrel=4
pkgdesc="Dillon's Cron daemon"
url="http://apollo.backplane.com/FreeSrc/"
depends=('sysklogd' 'psmisc')
backup=(var/spool/cron/crontabs/root)
install=$pkgname.install
up2date=`lynx -dump http://apollo.backplane.com/FreeSrc/ |grep DCRON|cut -d V -f 2`
source=(http://apollo.backplane.com/FreeSrc/dcron29.tgz \
	$pkgname-$pkgver-destdir.diff run-parts.gz run-parts.8.gz rc.crond root)
md5sums=('120fb2ca3d91496b32df0ab01dcaec5e' 'e70842799b39dee6379ed81b13c4998e' \
         'a4ff02d890de7d53e573f1343329cdc8' '08192b49bf1ec31302be765c349851a5' \
	 '8a3a872e4330a5e11e20dcbd7fd5bec2' '985b680e0d943951523007ed687f57f7')

build() {
	cd $startdir/src/dcron
	patch -p1 < $startdir/src/$pkgname-$pkgver-destdir.diff
	
	make || return 1
	
	make DESTDIR=$startdir/pkg install
	
	# crontab
	mkdir -p $startdir/pkg/etc/{rc.d,cron.hourly,cron.daily,cron.weekly,cron.monthly}
	install -D -m 600 $startdir/src/root \
		$startdir/pkg/var/spool/cron/crontabs/root
	# run-parts
	install -D -m 755 $startdir/src/run-parts \
		$startdir/pkg/usr/bin/run-parts
	install -D -m 644 $startdir/src/run-parts.8 \
		$startdir/pkg/usr/man/man8/run-parts.8
	
	# init scripts
	mkdir -p $startdir/pkg/etc/rc.d/rc.messages
	install -m755 $startdir/rc.crond $startdir/pkg/etc/rc.d/rc.crond
	install -m644 $startdir/messages/crond.* \
		$startdir/pkg/etc/rc.d/rc.messages/
}

# vim: ft=sh
