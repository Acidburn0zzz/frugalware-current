# Last Modified: Mon, 23 May 2005 21:15:19 +0200
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>
# Modified by Laszlo Dvornik <dvornik@gnome.hu>

pkgname=udev
pkgver=058
pkgrel=1
pkgdesc="A userspace implementation of devfs"
url="http://www.kernel.org/pub/linux/utils/kernel/hotplug/"
backup=(etc/udev/udev.conf etc/udev/rules.d/50-udev.rules etc/sysconfig/udev)
depends=('glibc' 'hotplug')
groups=('base')
archs=('i686' 'x86_64')
conflicts=('devfsd')
install=$pkgname.install
up2date="lynx -dump \"$url?C=M;O=D\"|grep 'udev-.*tar.bz2 '|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=($url/$pkgname-$pkgver.tar.gz rc.udev udev)
md5sums=('ed0a5bde5f3503e59e4841b052d582b3' '24452ac6d60a5c51d80ae1673f15076b' \
	 '2b093f60c05e5b491c4b32d4421e387f')

build()
{
	Fcd
	cp -f etc/udev/frugalware/udev.rules etc/udev/
	Fsed '\(udevdir =\t${prefix}\)/udev' '\1/dev' Makefile
	Fsed '$(OPTIMIZATION)' "" Makefile
	
	Fbuild || return 1
	
	Fexe /etc/rc.d/rc.udev
	Ffile /etc/sysconfig/udev
	mknod -m 700 $Fdestdir/dev/console c 5 1
	mknod -m 666 $Fdestdir/dev/null c 1 3
}

# optimalization ok

# vim: ft=sh
