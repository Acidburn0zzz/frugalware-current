# Last Modified: Thu, 05 Jan 2006 22:50:41 +0100
# Compiling Time: 0.04 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>
# Modified by Laszlo Dvornik <dvornik@gnome.hu>

pkgname=udev
pkgver=079
pkgrel=2
pkgdesc="A userspace implementation of devfs"
url="http://www.kernel.org/pub/linux/utils/kernel/hotplug/"
backup=(etc/udev/{udev.conf,rules.d/50-udev.rules,cdsymlinks.conf} \
	etc/sysconfig/{blacklist,udev})
depends=('glibc')
groups=('base' 'core')
archs=('i686' 'x86_64')
conflicts=('devfsd' 'pcmcia-cs' 'hotplug')
up2date="lynx -dump \"$url?C=M;O=D\"|grep 'udev-.*tar.bz2 '|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=($url/$pkgname-$pkgver.tar.gz rc.udev udev blacklist \
	$pkgname-$pkgver-{symlinks,cdperms,media-groups,hotplug}.diff \
	rc.hotplug rc.hotplug-hu.po)
sha1sums=('1374118ab311e87274d318ae459442573a203b77' \
	  'f55ca376de8c474ade65724d209291b434a389dc' \
	  'dcf0c074a1665cae1857fda5545f6fedff671246' \
	  '24a3deaf4f3b368901c7bfcd9a58b0e4552005b4' \
	  '2905adb61cbb8c63caf3d62b11a19ea184d2374d' \
	  '57d5f42e3bf55b503d5fb57700b056d39b6b8145' \
	  'd4ce70a5953af38402dfe780b04f6016afb7557d' \
	  '48bd3889d044562d393a015258e2c6817a1c157a' \
	  '882a384892ed94130bcf0ee3943c8921d7e9b1a2' \
	  'bdb79db083a781acdf1f1a3b805488d36bb93330')

build()
{
	Fpatchall
	cp -f etc/udev/frugalware/udev.rules etc/udev/
	Fsed '\(udevdir =\t${prefix}\)/udev' '\1/dev' Makefile
	Fsed '$(OPTIMIZATION)' "" Makefile
	make || return 1
	Fmakeinstall EXTRAS="extras/ata_id extras/cdrom_id extras/dasd_id extras/edd_id extras/firmware extras/floppy  extras/run_directory extras/scsi_id extras/usb_id extras/volume_id"
	Ffilerel etc/udev/frugalware/udev.rules /etc/udev/rules.d/50-udev.rules
	Fexe /etc/rc.d/rc.udev
	Frcd2 hotplug
	Ffile /etc/sysconfig/blacklist
	Ffile /etc/sysconfig/udev
	mknod -m 700 $Fdestdir/dev/console c 5 1
	mknod -m 666 $Fdestdir/dev/null c 1 3
}

# optimalization ok

# vim: ft=sh
