# Last Modified: Sat, 29 Oct 2005 18:27:09 +0200
# Compiling Time: ~1 minute
# Maintainer: VMiklos <vmiklos@frugalware.org>
# Modified by Adam Zlehovszky

pkgname=hotplug
pkgver=2004_09_23
pkgrel=2
pkgdesc="Lets you plug in new USB and PCI devices and use them immediately"
depends=()
groups=('base' 'chroot-core')
archs=('i686' 'x86_64')
url="http://telia.dl.sourceforge.net/sourceforge/linux-hotplug/"
backup=(etc/hotplug/{usb.usermap,usb.handmap,usb.distmap,blacklist})
install=$pkgname.install
up2date="lynx -dump 'http://www.kernel.org/pub/linux/utils/kernel/hotplug/?C=M;O=D'|grep 'hotplug-[0-9_]*\.tar.gz$' |sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=(ftp://ftp.kernel.org/pub/linux/utils/kernel/hotplug/$pkgname-$pkgver.tar.gz rc.$pkgname $pkgname-$pkgver-interfaces.diff $pkgname-$pkgver-silent.diff) 
sha1sums=('76da21f14e8652f6b796d0d7ed7dbaa9b2a04b27' \
          '2c8fca05e2921bcf075d0e99fd2750a3b8ab078b' \
          'f01d80f446aa49909a10ae691348741397a6a84c' \
          'dd37f8cd112a96bb1ab04f954b8b2ed03825b181')

build() {
	cd $startdir/src/$pkgname-$pkgver
	patch -p1 < $startdir/src/$pkgname-$pkgver-silent.diff
	patch -p1 < $startdir/src/$pkgname-$pkgver-interfaces.diff

	make prefix=$startdir/pkg install

	cp $startdir/src/$pkgname-$pkgver/etc/hotplug/pnp.distmap $startdir/pkg/etc/hotplug/
	mv $startdir/pkg/etc/init.d/hotplug $startdir/pkg/etc/hotplug/
	rmdir $startdir/pkg/etc/init.d
	mkdir -p $startdir/pkg/etc/rc.d/rc.messages
	install -m755 $startdir/rc.$pkgname $startdir/pkg/etc/rc.d/rc.$pkgname
	install -m644 $startdir/messages/$pkgname.* \
		$startdir/pkg/etc/rc.d/rc.messages
	mkdir -p $startdir/pkg/var/lock/subsys
}
# optimalization ok

# vim: ft=sh
