# Last Modified: Fri, 06 Oct 2006 14:07:29 +0200
# Compiling Time: 0.01 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=slocate
pkgver=3.1
pkgrel=1
pkgdesc="Security Enhanced version of the GNU Locate"
url="http://www.geekreview.org/slocate"
depends=('util-linux' 'frugalware')
groups=('base')
archs=('i686' 'x86_64')
backup=('etc/updatedb.conf')
up2date="$pkgver"
#source=(http://slocate.trakker.ca/files/$pkgname-$pkgver.tar.gz \
source=(http://ftp.frugalware.org/pub/other/sources/slocate/$pkgname-$pkgver.tar.bz2 \
        slocate updatedb.conf fix-install.patch)
sha1sums=('730cd64b2b0c22576cd368666f54686a3d5b339b' \
	  '027843ac6833c024b33c90a18b1ab68ef03a5146' \
	  'c6b00373d0391537743f25b89b21a01042a0b6cd' \
	  'dffd2053a870972fdd4b902a2b23f4271abb24a5')

build() {
	Fcd
	Fpatchall
	# Fixup for cflags
	Fsed "CFLAGS=-Wall -Wshadow" "CFLAGS=${CFLAGS}" src/Makefile
	make || return 1
	Fmkdir /usr/bin
	Fmakeinstall

	Ffilerel $Fsrcdir/updatedb.conf /etc/updatedb.conf
	Fexerel $Fsrcdir/slocate /etc/cron.daily/slocate
	# Fixup for perms
	chgrp 21 $Fdestdir/usr/bin/slocate || Fdie
	Fln /usr/bin/slocate /usr/bin/locate
	Fln /usr/bin/slocate /usr/bin/updatedb
	Fln /usr/share/man/man1/slocate.1.gz /usr/share/man/man1/locate.1.gz
	Fmkdir /var/lib/slocate
	touch $Fdestdir/var/lib/slocate/.placeholder || Fdie
	# Fixup for perms
	chgrp 21 $Fdestdir/var/lib/slocate || Fdie
}

# optimization OK
