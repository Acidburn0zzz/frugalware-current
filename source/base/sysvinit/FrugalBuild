# Last Modified: Tue, 10 May 2005 22:09:52 +0200
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=sysvinit
pkgver=2.86
pkgrel=4
pkgdesc="Init, the parent of all processes"
depends=('shadow' 'util-linux' 'coreutils' 'glibc' 'gawk')
groups=('base')
backup=(etc/{inittab,rc.d/rc.local})
install=$pkgname.install
up2date="wget --passive-ftp -O - -q ftp://ftp.cistron.nl/pub/people/miquels/sysvinit/|grep tar.gz|tail -n 1|sed 's/.*sysvinit-\(.*\)\.tar\.gz.*/\1/'"
source=(ftp://ftp.cistron.nl/pub/people/miquels/$pkgname/$pkgname-$pkgver.tar.gz \
	$pkgname-$pkgver.diff inittab)
md5sums=('7d5d61c026122ab791ac04c8a84db967' '1f39e3fdeecc219023c95ebe8c45e065' \
	 'c3ae626de8973d8e1341c87b1cf592a2')

build()
{
	
	Fcd $pkgname-$pkgver/src
	patch -p2 < $Fsrcdir/$pkgname-$pkgver.diff
	Fmkdir /bin /sbin
	Fmkdir /usr/{bin,include}
	Fmkdir /usr/man/man{1,5,8}

	Fsed '-O2' "$CFLAGS" Makefile
	make || return 1

	make MANDIR=/usr/man ROOT=$Fdestdir install
	Frm /usr/bin/wall
	Fmkdir /etc/rc.d/rc.messages
	Fexe ../scripts/* /etc/rc.d/
	Ffile ../messages/* /etc/rc.d/rc.messages/
	Fexe ../messages/rc.messages /etc/rc.d/rc.messages/rc.messages
	Ffile /etc/inittab
	Fln rc.6 /etc/rc.d/rc.0
	Fln rc.reboot /etc/rc.d/rc.halt
}

# vim: ft=sh
