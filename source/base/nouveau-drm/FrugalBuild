# Compiling Time: 0.24 SBU
# Maintainer: Michel Hermier <hermier@frugalware.org>

_F_kernelmod_scriptlet=nouveau-drm.install
Finclude kernel-module
_F_kernelver=$_F_kernelver_ver-$_F_kernelver_rel

pkgname=nouveau-drm
pkgver=`Fsanitizeversion ${_F_kernelver}.g3ca22d1`
pkgrel=1
pkgdesc="Kernel modules for Nvidia cards (opensource)"
groups=('base')
archs=('i686')
options=("${options[@]}" 'nobuild')
url="http://nouveau.freedesktop.org/"
source=(Makefile nouveau-drm.install)
sha1sum=('6fd23ee7d0bb40d70d6445959134919ac5d0dcba'
         '')

_F_scm_type="git"
_F_scm_url="git://anongit.freedesktop.org/nouveau/linux-2.6"
Finclude scm

build()
{
	Funpack_scm

	Fcd
	[ -d nouveau ] || mkdir nouveau || Fdie
	cp -f ../Makefile nouveau/ | Fdie
       	cd nouveau || Fdie
	make LINUXDIR=/usr/src/linux clean || Fdie
	make LINUXDIR=/usr/src/linux || Fdie
	make LINUXDIR=/usr/src/linux INSTALL_MOD_PATH=$Fdestdir install || Fdie

	Fbuild_kernelmod_scriptlet
}

# optimization OK
