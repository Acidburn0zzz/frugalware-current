diff -Naur pacman-2.9.6.orig/doc/makepkg.8.in pacman-2.9.6/doc/makepkg.8.in
--- pacman-2.9.6.orig/doc/makepkg.8.in	2004-08-04 07:57:17.000000000 +0200
+++ pacman-2.9.6/doc/makepkg.8.in	2005-06-13 10:11:02.000000000 +0200
@@ -38,6 +38,7 @@
 backup=(etc/modules.conf)
 makedepends=('bash' 'mawk')
 depends=('glibc' 'zlib')
+archs=('i686')
 source=(ftp://ftp.kernel.org/pub/linux/utils/kernel/$pkgname/v2.4/$pkgname-$pkgver.tar.bz2 \\
         modules.conf)
 md5sums=('2c0cca3ef6330a187c6ef4fe41ecaa4d' \\
@@ -281,6 +282,12 @@
 one could install all KDE packages by installing the 'kde' group.
 
 .TP
+.B archs \fI(array)\fP
+This array defines on which architectures the given package is avalibable.
+If it's not available, that will mean that gensync will skip it when generating
+package databases.
+
+.TP
 .B backup \fI(array)\fP 
 A space-delimited array of filenames (without a preceding slash). The
 \fIbackup\fP line will be propagated to the package meta-info file for
diff -Naur pacman-2.9.5.orig/scripts/gensync pacman-2.9.5/scripts/gensync
--- pacman-2.9.5.orig/scripts/gensync	2005-05-27 00:31:27.000000000 +0200
+++ pacman-2.9.5/scripts/gensync	2005-05-27 00:35:56.000000000 +0200
@@ -22,6 +22,8 @@
 
 myver='2.9.2'
 
+[ -z "$arch" ] && arch=`arch`
+
 usage() {
   echo "gensync $myver"
   echo "usage: $0 <root> <destfile> [package_directory]"
@@ -54,9 +56,9 @@
 get_md5checksum()
 {
 	if [ "$pkgdir" != "" ]; then
-		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	else
-		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	fi
 	if [ -f $pkgfile ]; then
 		md5line=`md5sum $pkgfile`
@@ -85,6 +87,9 @@
 	echo "%DESC%" >>desc
 	echo "$pkgdesc" >>desc
 	echo "" >>desc
+	echo "%ARCH%" >>desc
+	echo "$arch" >>desc
+	echo "" >>desc
 	echo "%CSIZE%" >>desc
 	echo "$csize" >>desc
 	echo "" >>desc
@@ -138,6 +143,19 @@
 	touch -r $1 desc depends
 }
 
+in_array()
+{
+	needle=$1
+	shift 1
+	# backward compatibility: if array() undefined, it's available for all archs
+	[ -z "$1" ] && return 0
+	for i in $*
+	do
+		[ "$i" == "$needle" ] && return 0
+	done
+	return 1
+}
+
 if [ $# -lt 2 ]; then
 	usage
 	exit 0
@@ -163,13 +181,15 @@
 echo "gensync: building database entries, generating md5sums..." >&2
 cd `dirname $2`
 for file in `find $rootdir/* -name FrugalBuild`; do
-	unset nobuild
+	unset nobuild archs
 	source $file || die "errors parsing $file"
-	[ "$nobuild" ] && continue
+	if ! in_array $arch ${archs[@]} || [ "$nobuild" ]; then
+		continue
+	fi
 	if [ "$pkgdir" != "" ]; then
-		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	else
-		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	fi
 	[ -f $pkgfile ] || die "missing package file: $pkgfile"
 	csize=`du -b $pkgfile | cut -f1`
diff -Naur pacman-2.9.5.orig/scripts/makepkg pacman-2.9.5/scripts/makepkg
--- pacman-2.9.5.orig/scripts/makepkg	2005-05-27 00:31:27.000000000 +0200
+++ pacman-2.9.5/scripts/makepkg	2005-05-27 00:28:21.000000000 +0200
@@ -328,10 +328,10 @@
 	exit 1
 fi
 
-if [ -f $PKGDEST/${pkgname}-${pkgver}-${pkgrel}.fpm -a "$FORCE" = "0" -a "$GENMD5" = "0" ]; then
+if [ -f $PKGDEST/${pkgname}-${pkgver}-${pkgrel}-${CARCH}.fpm -a "$FORCE" = "0" -a "$GENMD5" = "0" ]; then
 	if [ "$INSTALL" = "1" ]; then
 		warning "a package has already been built, installing existing package."
-		pacman --upgrade $PKGDEST/${pkgname}-${pkgver}-${pkgrel}.fpm
+		pacman --upgrade $PKGDEST/${pkgname}-${pkgver}-${pkgrel}-${CARCH}.fpm
 		exit $?
 	else
 		error "a package has already been built.  (use -f to overwrite)"
@@ -709,9 +709,9 @@
 msg "Compressing package..."
 cd $startdir/pkg
 if [ -f $startdir/pkg/.INSTALL ]; then
-	cmd="tar czvf $PKGDEST/$pkgname-$pkgver-$pkgrel.fpm .PKGINFO .FILELIST .INSTALL *"
+	cmd="tar czvf $PKGDEST/$pkgname-$pkgver-$pkgrel-$CARCH.fpm .PKGINFO .FILELIST .INSTALL *"
 else
-	cmd="tar czvf $PKGDEST/$pkgname-$pkgver-$pkgrel.fpm .PKGINFO .FILELIST *"
+	cmd="tar czvf $PKGDEST/$pkgname-$pkgver-$pkgrel-$CARCH.fpm .PKGINFO .FILELIST *"
 fi
 $cmd | sort >../filelist
 
@@ -746,7 +746,7 @@
 
 if [ "$INSTALL" = "1" -a "`id -u`" = "0" -a "$INFAKEROOT" != "1" ]; then
 	msg "Running pacman --upgrade..."
-	pacman --upgrade $PKGDEST/${pkgname}-${pkgver}-${pkgrel}.fpm
+	pacman --upgrade $PKGDEST/${pkgname}-${pkgver}-${pkgrel}-${CARCH}.fpm
 	exit $?
 fi
 
diff -Naur pacman-2.9.5.orig/scripts/updatesync pacman-2.9.5/scripts/updatesync
--- pacman-2.9.5.orig/scripts/updatesync	2005-05-27 00:31:27.000000000 +0200
+++ pacman-2.9.5/scripts/updatesync	2005-05-27 00:28:21.000000000 +0200
@@ -23,6 +23,8 @@
 
 myver='2.9.2'
 
+[ -z "$arch" ] && arch=`arch`
+
 usage() {
 	echo "updatesync $myver"
 	echo "usage: $0 <action> <destfile> <option> [package_directory]"
@@ -57,9 +59,9 @@
 get_md5checksum()
 {
 	if [ "$pkgdir" != "" ]; then
-		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	else
-		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	fi
 	if [ -f $pkgfile ]; then
 		md5line=`md5sum $pkgfile`
@@ -88,6 +90,9 @@
 	echo "%DESC%" >>desc
 	echo "$pkgdesc" >>desc
 	echo "" >>desc
+	echo "%ARCH%" >>desc
+	echo "$arch" >>desc
+	echo "" >>desc
 	echo "%CSIZE%" >>desc
 	echo "$csize" >>desc
 	echo "" >>desc
@@ -207,9 +212,9 @@
 	source $option || die "errors parsing $option"
 	if [ ! "$nobuild" ]; then
 	if [ "$pkgdir" != "" ]; then
-		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$pkgdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	else
-		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel.fpm"
+		pkgfile="$destdir/$pkgname-$pkgver-$pkgrel-$arch.fpm"
 	fi
 	[ -f $pkgfile ] || die "missing package file: $pkgfile"
 	csize=`du -b $pkgfile | cut -f1`
diff -Naur pacman-2.9.5.orig/src/pacman.c pacman-2.9.5/src/pacman.c
--- pacman-2.9.5.orig/src/pacman.c	2005-05-27 00:31:27.000000000 +0200
+++ pacman-2.9.5/src/pacman.c	2005-05-27 00:28:21.000000000 +0200
@@ -1166,17 +1166,17 @@
 					char path[PATH_MAX];
 
 					if(pmo_s_printuris) {
-						snprintf(path, PATH_MAX, "%s-%s%s", sync->pkg->name, sync->pkg->version, PKGEXT);
+						snprintf(path, PATH_MAX, "%s-%s-%s%s", sync->pkg->name, sync->pkg->version, sync->pkg->arch, PKGEXT);
 						files = list_add(files, strdup(path));
 					} else {
-						snprintf(path, PATH_MAX, "%s/%s-%s%s",
-							ldir, sync->pkg->name, sync->pkg->version, PKGEXT);
+						snprintf(path, PATH_MAX, "%s/%s-%s-%s%s",
+							ldir, sync->pkg->name, sync->pkg->version, sync->pkg->arch, PKGEXT);
 						if(stat(path, &buf)) {
 							/* file is not in the cache dir, so add it to the list */
-							snprintf(path, PATH_MAX, "%s-%s%s", sync->pkg->name, sync->pkg->version, PKGEXT);
+							snprintf(path, PATH_MAX, "%s-%s-%s%s", sync->pkg->name, sync->pkg->version, sync->pkg->arch, PKGEXT);
 							files = list_add(files, strdup(path));
 						} else {
-							vprint(" %s-%s%s is already in the cache\n", sync->pkg->name, sync->pkg->version, PKGEXT);
+							vprint(" %s-%s-%s%s is already in the cache\n", sync->pkg->name, sync->pkg->version, sync->pkg->arch, PKGEXT);
 							count++;
 						}
 					}
@@ -1248,7 +1248,7 @@
 				char *md5sum1, *md5sum2;
 
 				sync = (syncpkg_t*)i->data;
-				snprintf(pkgname, PATH_MAX, "%s-%s%s", sync->pkg->name, sync->pkg->version, PKGEXT);
+				snprintf(pkgname, PATH_MAX, "%s-%s-%s%s", sync->pkg->name, sync->pkg->version, sync->pkg->arch, PKGEXT);
 
 				md5sum1 = sync->pkg->md5sum;
 				if(md5sum1 == NULL || md5sum1[0] == '\0') {
@@ -1340,7 +1340,7 @@
 				syncpkg_t *sync = (syncpkg_t*)i->data;
 				if(sync->pkg) {
 					MALLOC(str, PATH_MAX);
-					snprintf(str, PATH_MAX, "%s/%s-%s%s", ldir, sync->pkg->name, sync->pkg->version, PKGEXT);
+					snprintf(str, PATH_MAX, "%s/%s-%s-%s%s", ldir, sync->pkg->name, sync->pkg->version, sync->pkg->arch, PKGEXT);
 					files = list_add(files, str);
 					if(sync->pkg->reason == REASON_DEPEND) {
 						dependonly = list_add(dependonly, strdup(str));
