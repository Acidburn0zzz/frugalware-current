diff -Naur pacman-2.9.7.orig/Makefile.in pacman-2.9.7/Makefile.in
--- pacman-2.9.7.orig/Makefile.in	2005-10-04 23:59:52.000000000 +0200
+++ pacman-2.9.7/Makefile.in	2005-10-05 00:00:33.000000000 +0200
@@ -74,7 +74,7 @@
 					$(OBJDIR)strhash.o \
 					$(OBJDIR)rpmvercmp.o
 
-all: libftp.a pacman vercmp convertdb man
+all: libftp.a pacman vercmp convertdb cdu man
 
 pacman: $(OBJECTS) libftp.a
 	$(CXX) $(OBJECTS) -o $@ $(LDFLAGS)
@@ -86,6 +86,9 @@
 convertdb: $(OBJDIR)convertdb.o $(OBJDIR)list.o $(OBJDIR)archive.o $(OBJDIR)util.o
 	$(CXX) $(OBJDIR)convertdb.o $(OBJDIR)list.o $(OBJDIR)archive.o $(OBJDIR)util.o $(LDFLAGS) -o $@
 
+cdu: $(OBJDIR)cdu.o
+	$(CXX) $(OBJDIR)cdu.o $(CXXFLAGS) $(LDFLAGS) -o $@
+
 .c.o: $(SRCS)
 	$(CXX) $(CXXFLAGS) -o $@ -c $<
 
@@ -101,11 +104,12 @@
 libftp.a:
 	(cd libftp; make libftp.a)
 
-install: pacman vercmp convertdb man
+install: pacman vercmp convertdb cdu man
 	$(INSTALL) -D -m0755 pacman $(DESTDIR)$(BINDIR)/pacman
 	$(INSTALL) -D -m0755 pacman.static $(DESTDIR)$(BINDIR)/pacman.static
 	$(INSTALL) -D -m0755 vercmp $(DESTDIR)$(BINDIR)/vercmp
 	$(INSTALL) -D -m0755 convertdb $(DESTDIR)$(BINDIR)/convertdb
+	$(INSTALL) -D -m0755 cdu $(DESTDIR)$(BINDIR)/cdu
 	$(INSTALL) -D -m0755 $(SCRDIR)makepkg $(DESTDIR)$(BINDIR)/makepkg
 	$(INSTALL) -D -m0755 $(SCRDIR)makeworld $(DESTDIR)$(BINDIR)/makeworld
 	$(INSTALL) -D -m0755 $(SCRDIR)gensync $(DESTDIR)$(BINDIR)/gensync
@@ -121,7 +125,7 @@
 	(cd libftp; make clobber)
 
 distclean: clean
-	rm -f pacman pacman.static convertdb vercmp
+	rm -f pacman pacman.static convertdb vercmp cdu
 	rm -f Makefile
 	rm -f config.h config.status config.log
 
diff -Naur pacman-2.9.7.orig/scripts/gensync pacman-2.9.7/scripts/gensync
--- pacman-2.9.7.orig/scripts/gensync	2005-10-04 23:59:52.000000000 +0200
+++ pacman-2.9.7/scripts/gensync	2005-10-05 00:01:24.000000000 +0200
@@ -113,6 +113,9 @@
 	echo "%CSIZE%" >>desc
 	echo "$csize" >>desc
 	echo "" >>desc
+	echo "%SIZE%" >>desc
+	echo "$size" >>desc
+	echo "" >>desc
 	if [ ! -z $pkgmd5sum ]; then
 		echo "%MD5SUM%" >>desc
 		echo "$pkgmd5sum" >>desc
@@ -218,6 +221,7 @@
 	fi
 	[ -f $pkgfile ] || die "missing package file: $pkgfile"
 	csize=`du -b $pkgfile | cut -f1`
+	size=`cdu $pkgfile`
 	if [ "$pkgname" == "pacman" ]; then
 	    pkgmd5sum=`get_md5checksum $pkgfile`
 	    [ -z $pkgmd5sum ] && die "error generating md5 checksum for $pkgfile"
diff -Naur pacman-2.9.7.orig/scripts/updatesync pacman-2.9.7/scripts/updatesync
--- pacman-2.9.7.orig/scripts/updatesync	2005-10-04 23:59:52.000000000 +0200
+++ pacman-2.9.7/scripts/updatesync	2005-10-05 00:01:45.000000000 +0200
@@ -116,6 +116,9 @@
 	echo "%CSIZE%" >>desc
 	echo "$csize" >>desc
 	echo "" >>desc
+	echo "%SIZE%" >>desc
+	echo "$size" >>desc
+	echo "" >>desc
 	if [ ! -z $pkgmd5sum ]; then
 		echo "%MD5SUM%" >>desc
 		echo "$pkgmd5sum" >>desc
@@ -243,6 +246,7 @@
 	fi
 	[ -f $pkgfile ] || die "missing package file: $pkgfile"
 	csize=`du -b $pkgfile | cut -f1`
+	size=`cdu $pkgfile`
 	if [ "$pkgname" == "pacman" ]; then
 	    pkgmd5sum=`get_md5checksum $pkgfile`
 	    [ -z $pkgmd5sum ] && die "error generating md5 checksum for $pkgfile"
diff -Naur pacman-2.9.7.orig/src/cdu.c pacman-2.9.7/src/cdu.c
--- pacman-2.9.7.orig/src/cdu.c	1970-01-01 01:00:00.000000000 +0100
+++ pacman-2.9.7/src/cdu.c	2005-10-05 00:00:33.000000000 +0200
@@ -0,0 +1,56 @@
+/*
+ *  cdu.c
+ * 
+ *  Copyright (c) 2005 by Miklos Vajna <vmiklos@frugalware.org>
+ * 
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, 
+ *  USA.
+ */
+
+#include <stdio.h>
+#include <limits.h>
+#include <archive.h>
+#include <archive_entry.h>
+
+int main(int argc, char **argv)
+{
+	register struct archive *archive;
+	struct archive_entry *entry;
+	int i=0;
+
+	if(argc != 2)
+	{
+		printf("usage: %s archive_file\n", argv[0]);
+		return(1);
+	}
+
+	if ((archive = archive_read_new ()) == NULL)
+		return(1);
+	archive_read_support_compression_all (archive);
+	archive_read_support_format_all (archive);
+	
+	if (archive_read_open_file (archive, argv[1], 10240) != ARCHIVE_OK)
+	{
+		perror("could not open package");
+		return(1);
+	}
+
+	while (archive_read_next_header (archive, &entry) == ARCHIVE_OK)
+		i += archive_entry_size (entry);
+
+	archive_read_finish (archive);
+	printf("%d\n", i);
+	return(0);
+}
