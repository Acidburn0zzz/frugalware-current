# Last Modified: Wed Oct 27 18:47:33 CEST 2004
# Compiling Time: ~4 minutes
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=shadow
pkgver=4.0.5
pkgrel=1
pkgdesc="Shadow password file utilities"
url="http://shadow.pld.org.pl"
backup=(etc/{login.defs,group,passwd,shadow} etc/default/useradd)
depends=()
up2date=`lynx -dump http://shadow.pld.org.pl/|grep Latest|tr -s ' '|cut -d ' ' -f 4`
source=(ftp://ftp.pld.org.pl/software/$pkgname/$pkgname-$pkgver.tar.bz2 \
        adduser group passwd shadow login-defs.diff)
md5sums=('cca17a4843a3b5b324a5398faf81c3b4' \
	 'cc880cb940a66b5da7440390ef7a1406' '9cfb09a207215330324c1fd0d6699d03' \
	 '500fedaf9fc5231d4497104e16202a30' '4d01cd4ea40bd95f1d233614dd970e64'
         'b14a602ce0f4932cb83b7cdb68132ac7')

build() {
	cd $startdir/src/$pkgname-$pkgver
	#patch -p1 < $startdir/src/$pkgname-$pkgver-gcc34.diff
	patch -p0 < $startdir/src/login-defs.diff
	./configure --prefix=/usr --disable-shared --disable-desrpc \
		    --mandir=/usr/man

	make || return 1

	make DESTDIR=$startdir/pkg install
	rm -f $startdir/pkg/bin/{vigr,sg}
	install -D -m644 etc/login.defs.linux $startdir/pkg/etc/login.defs
	install -m644 etc/login.access $startdir/etc/login.access
	install -m755 $startdir/src/adduser $startdir/pkg/usr/sbin/adduser
	install -m644 $startdir/src/{group,passwd} $startdir/pkg/etc/
	install -m600 $startdir/src/shadow $startdir/pkg/etc/
}

# vim: ft=sh
