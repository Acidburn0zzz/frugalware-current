# Compiling Time: 0.04 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=bzip2
pkgver=1.0.3
pkgrel=4
pkgdesc="A block-sorting file compressor"
url="http://www.bzip.org/"
depends=('glibc' 'bash')
groups=('base' 'chroot-core')
archs=('i686' 'x86_64')
up2date="lynx -dump $url|grep current|sed 's/.*s \(.*\), .*/\1/'"
source=(http://www.bzip.org/$pkgver/$pkgname-$pkgver.tar.gz \
	$pkgname-$pkgver-chmod.patch $pkgname-$pkgver-cflags.patch0 \
	$pkgname-1.0.2-NULL-ptr-check.patch $pkgname-1.0.2-tempfile.patch \
	$pkgname-1.0.2-progress.patch)
sha1sums=('7e749510f65c86fbfff37b97144a02f1b8b8617f' \
	  'b1daca700951dc7a6b05171218e55ace141d2c31' \
	  'a3a4a2e3e7d14f4e15b4e5950abde8f853297eed' \
	  '77d8f7ebac6c2c9b9eff8e21695a7e674937600a' \
	  '0bbe58699e3e6f3612b04b3a752ea200c49b9b77' \
	  '90a0032645886b633c9b730d0a1abb88c88a9873')

build()
{
	Fpatchall
	make -f Makefile-libbz2_so || return 1
	make bzip2recover libbz2.a || return 1
	Fexerel bzip2-shared /bin/bzip2
	Fexerel bzip2recover /bin/bzip2recover
	Ffilerel bzip2.1 /usr/share/man/man1/bzip2.1
	Ffilerel bzlib.h /usr/include/bzlib.h
	Fmkdir /lib /usr/lib
	Fexerel libbz2.so.$pkgver /lib
	Fln libbz2.so.$pkgver /lib/libbz2.so.1.0
	Fln libbz2.so.$pkgver /lib/libbz2.so
	Ffilerel libbz2.a /usr/lib/libbz2.a
	Fln ../../lib/libbz2.so /usr/lib/libbz2.so
	Fln bzip2 /bin/bunzip2
	Fln bzip2 /bin/bzcat
	Fln bzip2.1 /usr/share/man/man1/bunzip2.1
	Fln bzip2.1 /usr/share/man/man1/bzcat.1
	Fln bzip2.1 /usr/share/man/man1/bzip2recover.1
}

# optimization OK
