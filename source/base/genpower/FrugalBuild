# Last Modified: Wed Jul 28 12:34:14 CEST 2004
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=genpower
pkgver=1.0.2
pkgrel=3
pkgdesc="UPS monitoring daemon"
depends=('glibc' 'bash')
up2date=`lynx -dump 'http://www.ibiblio.org/pub/Linux/system/ups/?M=D'|grep genpower|grep tar.gz|sed -n '1 p'|tr -s ' '|cut -d ' ' -f 4|sed 's/.tar.gz//'|cut -d - -f 2`
source=(http://www.ibiblio.org/pub/Linux/system/ups/$pkgname-$pkgver.tar.gz \
	genpowerfail-sbin.diff rc.ups)
md5sums=('a9886305197eeaa1b1c39b66be9a7aef' \
	 '6e4ffa2e2475b2fa2ff88fc5e89f81e1' '80e6e9a08248913b2df502159d0cd4ac')

build() {
	cd $startdir/src/$pkgname-$pkgver
	patch -p1 < $startdir/src/genpowerfail-sbin.diff
	sed -i "s/^\(CFLAGS.*= \)\(.*\)$/\1$CFLAGS/"  Makefile

	make || return 1
  
	mkdir -p $startdir/pkg/{usr/man/man8,sbin}
	make BINDIR=$startdir/pkg/sbin SCRIPTDIR=$startdir/pkg/sbin \
		MANDIR=$startdir/pkg/usr/man/man8 install
	mkdir -p $startdir/pkg/etc/rc.d/rc.messages
	install -m755 $startdir/rc.ups $startdir/pkg/etc/rc.d/rc.ups
	install -m644 $startdir/messages/ups.* $startdir/pkg/etc/rc.d/rc.messages

}
