# Compiling time: 0.18 SBU
# Maintainer: Miklos Vajna <vmiklos@frugalware.org>

pkgname=e2fsprogs
pkgver=1.41.1
pkgrel=1
pkgdesc="Utilities needed to create and maintain ext2 and ext3 filesystems"
depends=('glibc>=2.8-3')
rodepends=('coreutils>=6.12-2')
groups=('base' 'chroot-core')
archs=('i686' 'x86_64' 'ppc')
_F_sourceforge_prefix="v"
Finclude sourceforge
url="http://e2fsprogs.sourceforge.net/"
source=($source rc.fsck rc.random)
sha1sums=('f55b95df6956cd5a9f85f7deb90968d24d79a4ab' \
          'a4b2ac27c9e155b29a7dea6e7693f449e6ce6c9f' \
          '7d5e3eecbea952aa1f72808fb810892d82a35461')

build()
{
	Fmake --with-ccopts="$CFLAGS" --enable-elf-shlibs --enable-dynamic-e2fsck \
		--with-root-prefix=""
	# it seems building the test binaries fails
	if [ "$CARCH" != "ppc" ]; then
		make check || return 1
	fi
	make DESTDIR=$Fdestdir install install-libs
	Frcd fsck
	Frcd random
}

# optimization OK
