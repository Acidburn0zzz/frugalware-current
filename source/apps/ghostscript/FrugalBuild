# Compiling Time: 24.09 SBU
# Maintainer: voroskoi <voroskoi@frugalware.org>
# Contributor: DeX77 <dex77@frugalware.org>


## FIXME: - we need build with --enable/--with-{system}-foo
##        - remove xghostscript and built ghostscript with
##          X/mesa/glu .. maybe aad GTK3 GUI

pkgname=ghostscript
pkgver=9.18
pkgrel=1
pkgdesc="An interpreter for the PostScript language."
depends=('libcups>=1.6.1' 'openssl>=1.0.0' 'libkrb5' 'gnutls>=3.4.2')
rodepends=('foomatic-filters' 'urw-fonts')
makedepends=('libxt' 'libxext' 'cups' 'krb5' 'x11-protos')
groups=('apps')
archs=('i686' 'x86_64' 'arm')
license="GPLv2"
url="http://www.ghostscript.com/"
up2date="Flasttar http://downloads.ghostscript.com/public/"
source=("http://downloads.ghostscript.com/public/$pkgname-$pkgver.tar.bz2")
sha1sums=('388fea50a38e422a4c6ff27c184491bf5ecb96e1')

subpkgs=('xghostscript')
subdescs=('A graphical interpreter for the PostScript language.')
subdepends=("libxt libxext cups urw-fonts")
subrodepends=("foomatic-filters")
subgroups=('xapps')
subarchs=('i686 x86_64 arm')
subconflicts=('ghostscript')
subprovides=('ghostscript')


build() {
	if [[ "$CARCH" == "x86_64" ]]; then
		CFLAGS="$CFLAGS -fPIC"
	fi
	Fmake
	make -j1 DESTDIR=${Fdestdir} install-so install || Fdie
	# remove filters that are now maintained in cups-filters as upstream home
        Frm usr/lib/cups/filter/gstopxl
        Frm usr/lib/cups/filter/gstoraster
	Fsplit xghostscript /\*
	make clean || Fdie
	Fmake --without-x
	make -j1 DESTDIR=${Fdestdir} install-so install || Fdie
	# remove filters that are now maintained in cups-filters as upstream home
	Frm usr/lib/cups/filter/gstopxl
	Frm usr/lib/cups/filter/gstoraster
}

# optimization OK
