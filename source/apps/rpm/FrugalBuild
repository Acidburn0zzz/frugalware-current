# Last Modified: Wed, 15 Feb 2006 19:29:54 +0100
# Compiling Time: 0.01 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=rpm
pkgver=4.4.2
pkgrel=4
pkgdesc="Red Hat Package Manager"
url="http://www.rpm.org/"
depends=('bzip2' 'gcc-lib' 'sqlite3' 'popt' 'neon')
groups=('apps')
archs=('i686' 'x86_64')
makedepends=('beecrypt')
up2date="4.4.2"
source=(ftp://jbj.org/pub/$pkgname-4.4.x/$pkgname-$pkgver.tar.gz)
sha1sums=('c2a7ccbb75927f6970d60bb29edc8788133b1fc4')
[ "$CARCH" == "x86_64" ] && \
	source=(${source[@]} rpm_fix_lib64.patch) && \
	sha1sums=(${sha1sums[@]} 'ce35b5405edd9b2ea491ba933177f21f2b1bde75')

build()
{
	Fbuild --without-selinux --without-python

	# conflicts with popt
	Frm /usr/include/popt.h  /usr/lib/libpopt.*
	Frm /usr/man/man3/popt.3
	Frm /usr/share/locale/*/LC_MESSAGES/popt.mo
	# Fixes symlink bug
	Fln /usr/lib/rpm/rpmpopt-$pkgver /usr/lib/rpm/rpmpopt
	# fixes bug "can't create transaction lock"
	Fmkdir /var/lock/rpm
}

# vim: ft=sh

# optimalization OK
