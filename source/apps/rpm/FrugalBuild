# Last Modified: Sun, 31 Jul 2005 16:15:24 +0200
# Compiling Time: ~44 minutes on factory.frugalware.org
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=rpm
pkgver=4.4.2
pkgrel=3
pkgdesc="Red Hat Package Manager"
url="http://www.rpm.org/"
depends=('bzip2' 'gcc-lib' 'sqlite3' 'libstdc++' 'popt' 'neon')
groups=('apps')
archs=('i686' 'x86_64')
makedepends=('beecrypt')
up2date="lynx -dump ftp://jbj.org/pub/rpm-4.4.x/ |grep 'rpm-[0-9\.]*tar.gz$'|sed -n 's/.*-\(.*\)\.t.*/\1/;$ p'"
source=(ftp://jbj.org/pub/$pkgname-devel/$pkgname-$pkgver.tar.gz rpm_fix_lib64.patch)
md5sums=('013a60fb4d7d9ba6b16204b900ca7154' '98755a66b0c5bcc9be022c31230dfa33')

build()
{
	Fcd
	[ "$CARCH" == "x86_64" ] && (Fpatch rpm_fix_lib64.patch || return 1)
	Fmake --without-selinux --without-python || return 1
	Fmakeinstall || return 1

	# conflicts with popt
	Frm /usr/include/popt.h  /usr/lib/libpopt.*
	Frm /usr/man/man3/popt.3
	Frm /usr/share/locale/*/LC_MESSAGES/popt.mo
	# Fixes symlink bug
	Fln /usr/lib/rpm/rpmpopt-$pkgver /usr/lib/rpm/rpmpopt
	# fixes bug "can't create transaction lock"
	Fmkdir /var/lock/rpm
}

# vim: ft=sh

# optimalization OK
