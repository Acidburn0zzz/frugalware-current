# Last Modified: Mon, 09 May 2005 10:44:22 +0200
# Compiling Time: ~44 minutes on factory.frugalware.org
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=rpm
pkgver=4.3.3
pkgrel=1
pkgdesc="Red Hat Package Manager"
url="http://www.rpm.org/"
depends=('bzip2' 'zlib' 'gcc' 'popt')
groups=('apps')
archs=('i686')
makedepends=('beecrypt')
install=$pkgname.install
up2date="lynx -dump http://download.fedora.redhat.com/pub/fedora/linux/core/development/SRPMS/|grep /rpm-.*rpm$|sed 's/.*-\(.*\)-.*/\1/'"
source=(http://ftp.frugalware.org/pub/other/$pkgname/$pkgname-$pkgver.tar.gz)
md5sums=('854c4a9b6f0f0392809dcf1cdd1da61b')

build() {
	cd $startdir/src/$pkgname-$pkgver
	# patch -p1 < $startdir/src/$pkgname-$pkgver-beecrypt4.diff
	./configure --prefix=/usr --without-selinux --without-python
	
	# use -i since debugedit won't compile without a lot more cruft, and we
	# don't need it anyway
	make -i
	
	make -i DESTDIR=$startdir/pkg install

	# conflicts with popt
	rm -rf $startdir/pkg/{usr/include/popt.h,usr/lib/libpopt.*}
	rm -rf $startdir/pkg/usr/man/man3/popt.*
	rm -rf $startdir/pkg/usr/share/locale/*/LC_MESSAGES/popt.mo
	# fixes bug "can't create transaction lock"
	mkdir -p $startdir/pkg/var/lock/rpm
}

# vim: ft=sh
