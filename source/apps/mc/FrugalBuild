# Compiling time: 0.73 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>
# Contributor: VMiklos <vmiklos@frugalware.org>

pkgname=mc
pkgver=4.7.0
pkgrel=1
pkgdesc="The GNU Midnight Commander is a CLI-based file manager"
url="http://www.midnight-commander.org/"
depends=('glib2' 'slang')
makedepends=('cvs')
backup=(usr/share/mc/{cedit.menu,edit.indent.rc,edit.spell.rc,mc.ext,mc.lib})
groups=('apps')
archs=('i686' 'x86_64' 'ppc')
up2date="lynx -dump $url/downloads|grep tar.gz|sed -n 's/.*-\(.*\)\.t.*/\1/;$ p'"
source=(http://ftp.frugalware.org/pub/other/sources/$pkgname/$pkgname-$pkgver.tar.bz2 \
	00-mc-4.6.1-fpm.patch \
	02-mc-4.6.1-sambaconfpath.patch \
	06-mc-4.6.1-frugalbuild-syntax.patch 07-uhu-pkg-add.patch \
	10-mc-delcheck.patch \
	mc-4.6.1-nonblock.patch \
	mc-wrapper.sh-rewrite \
	alt-o.patch)
sha1sums=('027aab31da46d3aee6f06e2896b6c37113201ec6' \
          'eac9466e50e90d5c3cdf8f24caf9640133bd0503' \
          '87c4eaa1769c7ca1bebb76d97dbb7280dca3f10a' \
          '5df4c80dcc64e66659bb1ed6f1ff4438c60a1b66' \
          'e1beaef46208e7fbf3779f2ba5ce16f876250722' \
          'f89fe79cff655ee48274a0a90d24663789c5775f' \
          '34b3e6d4807c9e055dbafeede0ed3aa74efe7224' \
          '4e914dd2c23f4b2a17d61b907956f0ef3717b9aa' \
          'b328adc83dee38a7f14223a7e762d535495a586d')

build() {
	Fcd $pkgname-$pkgver
	Fpatchall
	Fautoreconf
	Fmake --enable-charset --without-gpm-mouse --with-x=no \
		--with-mcfs --with-samba
	cat $Fsrcdir/$pkgname-wrapper.sh-rewrite > $Fsrcdir/$pkgname-$pkgver/lib/mc-wrapper.sh
	Fmakeinstall
	# Need this to work ctrl+o and subshell propeply from user
	chmod u+s $Fdestdir/usr/libexec/mc/cons.saver || Fdie
}

# optimization OK
