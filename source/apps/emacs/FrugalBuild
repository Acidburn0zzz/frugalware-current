# Last Modified: Sat Oct 30 12:06:57 CEST 2004
# Compiling Time: ~10 minutes
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=emacs
pkgver=21.3
pkgrel=3
pkgdesc="An extensible, customizable, self-documenting real-time display editor"
url="http://www.gnu.org/software/emacs/"
depends=('libtiff' 'libjpeg' 'libpng' 'zlib' 'ncurses' 'libungif')
makedepends=('x' 'xaw3d')
up2date=`lynx -dump $url|grep stable|sed 's/.*: \([0-9\.]*\) .*/\1/'`
source=(ftp://ftp.gnu.org/gnu/emacs/$pkgname-$pkgver.tar.gz emacs)
md5sums=('a0bab457cbf5b4f8eb99d1d0a3ada420' '279bb55944e49a759e264d22627341d1')

build() {
	cd $startdir/src/$pkgname-$pkgver

	# without x
	./configure --prefix=/usr --with-x=no --with-pop
	make || return 1
	make prefix=$startdir/pkg/usr install
	( cd $startdir/pkg/usr/bin ; mv emacs-$pkgver emacs-$pkgver-nox11 )
	
	# with x
	./configure --prefix=/usr --with-x11 --with-x-toolkit --with-pop
	make || return 1
	make prefix=$startdir/pkg/usr install
	cd $startdir/pkg/usr/bin
	mv emacs-$pkgver emacs-$pkgver-x11

	# wrapper script
	sed -i "s/%version%/$pkgver/" $startdir/src/emacs
	install $startdir/src/emacs $startdir/pkg/usr/bin/
}

# vim: ft=sh
