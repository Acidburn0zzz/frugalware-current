Index: image-gif.c
===================================================================
--- filter/image-gif.c	(revision 676)
+++ image-gif.c	(working copy)
@@ -37,6 +37,7 @@
 
 #define GIF_INTERLACE	0x40
 #define GIF_COLORMAP	0x80
+#define GIF_MAX_BITS	12
 
 typedef cups_ib_t	gif_cmap_t[256][4];
 typedef short		gif_table_t[4096];
@@ -462,7 +463,7 @@
   pass      = 0;
   code_size = getc(fp);
 
-  if (!pixels)
+  if (code_size > GIF_MAX_BITS || !pixels)
     return (-1);
 
   if (gif_read_lzw(fp, 1, code_size) < 0)
