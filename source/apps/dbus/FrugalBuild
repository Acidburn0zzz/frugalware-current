# Last modified: Mon, 12 Jun 2006 17:58:52 +0200
# Compiling time: 0.48 SBU
# Maintainer: crazy <crazy@frugalware.org>
# Contributor: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=dbus
pkgver=0.62
pkgrel=1
pkgdesc="A message bus system"
url="http://freedesktop.org/wiki/Software_2fdbus"
depends=('libxml2' 'expat' 'glib2' 'libstdc++')
rodepends=('shadow')
makedepends=('pyrex' 'qt' 'gtk+2' 'doxygen')
groups=('apps')
archs=('i686' 'x86_64')
options=('nofakeroot' 'scriptlet')
up2date="lynx -dump http://freedesktop.org/wiki/Software_2fdbus|grep 'latest release'|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=(http://dbus.freedesktop.org/releases/$pkgname-$pkgver.tar.gz rc.$pkgname dbus.sh)
sha1sums=('45acea9bd19902791c6dbd8620256caf9d74a667' \
          '27a266e09eb75f08a7ce9f67aefb9210f7622ac2' \
          '050da3b1f1a26edd5f717a7c7f6424f8c87399b9')

subpkgs=('dbus-gtk+2')
subdescs=('GTK based tools for D-BUS.')
subdepends=('dbus gtk+2')
subgroups=('xapps')
subarchs=('i686 x86_64')

build()
{
	Fbuild  --sysconfdir=/etc --localstatedir=/var \
		--with-x --enable-gtk --enable-glib --enable-python \
		--disable-mono --enable-qt3 --enable-checks \
		--with-system-pid-file=/var/run/dbus/dbus.pid \
		--with-system-socket=/var/run/dbus/system_bus_socket \
		--with-session-socket-dir=/tmp \
		--with-dbus-user=messagebus \
		--enable-doxygen-docs --disable-qt \
		--with-xml=expat --enable-dnotify --with-gnu-ld \
		--disable-xml-docs --disable-asserts --disable-selinux --disable-mono-docs
	Frcd
	## not sure about that
	Fmkdir /var/run/console
	Fexe /etc/profile.d/dbus.sh
	Fsplit dbus-gtk+2 usr/bin/dbus-{launch,viewer} etc/profile.d/dbus.sh
}

# optimization OK
