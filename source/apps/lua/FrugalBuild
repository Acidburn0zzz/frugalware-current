# Last Modified: Sat, 29 Oct 2005 20:22:51 +0200
# Compiling Time: 0.03 SBU
# Maintainer: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=lua
pkgver=5.0.2
pkgrel=2
pkgdesc="A powerful light-weight programming language designed for extending applications."
url="http://www.lua.org/"
depends=('glibc')
groups=('apps' 'devel-core')
archs=('i686' 'x86_64')
up2date="lynx -dump 'http://www.lua.org/ftp/?sortby=7'|grep tar.gz$|sed -n 's/.*-\(.*\).t.*/\1/;1 p'"
source=($url/ftp/$pkgname-$pkgver.tar.gz)
sha1sums=('a200cfd20a9a4c7da1206ae45dddf26186a9e0e7')

build() {
	mkdir $startdir/pkg/usr
	cd $startdir/src/$pkgname-$pkgver
	./configure
	sed -i -e "/#LOADLIB= -DUSE_DLOPEN=1/c LOADLIB= -DUSE_DLOPEN=1" config
	sed -i -e "/#DLLIB= -ldl/c DLLIB= -ldl" config
	sed -i -e "s|INSTALL_ROOT= /usr/local|INSTALL_ROOT= /usr|" config
	sed -i -e "/MYCFLAGS= -O2/c MYCFLAGS=$CFLAGS -fPIC" config

	make || return 1
	make so || return 1

	make INSTALL_ROOT=$startdir/pkg/usr install
	make INSTALL_ROOT=$startdir/pkg/usr soinstall
}

# optimalization ok

# vim: ft=sh
