# Last Modified: Mon, 30 May 2005 15:14:12 +0000
# Compiling Time: ~8 seconds
# Maintainer: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=lua
pkgver=5.0.2
pkgrel=1
pkgdesc="A powerful light-weight programming language designed for extending applications."
url="http://www.lua.org/"
depends=('glibc')
groups=('apps')
archs=('i686' 'x86_64')
up2date="lynx -dump 'http://www.lua.org/ftp/?sortby=7'|grep tar.gz$|sed -n 's/.*-\(.*\).t.*/\1/;1 p'"
source=($url/ftp/$pkgname-$pkgver.tar.gz)
md5sums=('dea74646b7e5c621fef7174df83c34b1')

build() {
	mkdir $startdir/pkg/usr
	cd $startdir/src/$pkgname-$pkgver
	./configure
	sed -i -e "/#LOADLIB= -DUSE_DLOPEN=1/c LOADLIB= -DUSE_DLOPEN=1" config
	sed -i -e "/#DLLIB= -ldl/c DLLIB= -ldl" config
	sed -i -e "s|INSTALL_ROOT= /usr/local|INSTALL_ROOT= /usr|" config
	sed -i -e "/MYCFLAGS= -O2/c MYCFLAGS=$CFLAGS -fPIC" config

	make || return 1
	make so || return 1

	make INSTALL_ROOT=$startdir/pkg/usr install
	make INSTALL_ROOT=$startdir/pkg/usr soinstall
}

# optimalization ok

# vim: ft=sh
