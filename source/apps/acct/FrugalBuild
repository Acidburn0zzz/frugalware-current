# Last Modified: Wed, 15 Jun 2005 21:18:14 +0200
# Compiling Time: ~1 minute
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=acct
pkgver=6.3.2
pkgrel=3
pkgdesc="Process accounting utilities"
url="http://www.gnu.org/software/acct/"
depends=('glibc')
groups=('apps')
archs=('i686' 'x86_64')
up2date="lynx -dump 'http://ftp.gnu.org/pub/gnu/acct/?M=D'|grep ]acct|sed -n -e 's/.*acct-\(.*\)\.tar\.gz .*/\1/' -e '1 p'"
source=(http://ftp.gnu.org/pub/gnu/acct/$pkgname-$pkgver.tar.gz \
	$pkgname-$pkgver-logname.diff rc.acct)
md5sums=('da0055b254f7da8b8920db83ef1ebba1' \
	 '1e0d4ffc651cf2231048b782d2a0e668' '4dae19bf07f2278ab35714fbc049c646')

build() {
	cd $startdir/src/$pkgname-$pkgver
	./configure --prefix=/usr
	patch -p0 < $startdir/src/$pkgname-$pkgver-logname.diff

	make || return 1

	make prefix=$startdir/pkg/usr install
	mkdir -p $startdir/pkg/var/log
	touch $startdir/pkg/var/log/pacct
	chmod 640 $startdir/pkg/var/log/pacct
	
	mkdir -p $startdir/pkg/etc/rc.d/rc.messages
	install -m755 $startdir/rc.$pkgname $startdir/pkg/etc/rc.d/rc.$pkgname
	install -m644 $startdir/messages/$pkgname.* \
		$startdir/pkg/etc/rc.d/rc.messages
	# conflicts with sysvinit
	rm $startdir/pkg/usr/{bin/last,man/man1/last.*}
}

# optimalization ok
