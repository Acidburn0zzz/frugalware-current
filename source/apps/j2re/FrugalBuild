# Last Modified: Fri, 02 Dec 2005 00:45:44 +0100
# Compiling Time: ~0.17 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=j2re
pkgver=5.0_06
oldpkgver=1.5.0_06 # 1.5 = 5.0
realver=`echo $oldpkgver | tr . _`
pkgrel=1
pkgdesc="Sun's java runtime environment"
url="http://java.sun.com"
pkgurl="http://mirror.dcc.online.pt/Java/"
depends=('libstdc++') # NO, please don't add unixodbc, x or alsa-lib to here!
groups=('apps')
archs=('i686' 'x86_64')
# extremely ugly up2date:
# <a href="/j2se/1.5.0/download.jsp">J2SE 5.0</a> <- now 1.5 or 5.0?
up2date="lynx -dump http://java.sun.com/j2se/$(lynx -source -dump http://java.sun.com/j2se/downloads/index.html|grep "J2SE [0-9]"|sed 's|.*j2se/\([^/]*\)/.*|\1|;q')/download.jsp|grep jdk-.*-oth|sed 's/.*jdk-\(.*\)-oth.*/\1/;s/1.5.0/5.0/;q'"
jarch=i586 && jsha1=8244fe7a97647a19f43dd527d975650eb16800c9
[ "$CARCH" == "x86_64" ] && jarch=amd64 && jsha1=0156037ecdc72604e8c7ad752861330dda6fc06f
source=($pkgurl/jre-$realver-linux-$jarch.bin j2re.sh)
sha1sums=("$jsha1" 'd7b32de18152a3ad4d520563c9f847eb864bfbc9')

build()
{
	Fmkdir /usr/lib/{java,mozilla/plugins}
	echo "yes" | sh jre-$realver-linux-$jarch.bin 2> /dev/null || return 1
	cp -rf jre$oldpkgver $Fdestdir/usr/lib/java/jre || return 1
	for i in jre$oldpkgver/* ; do
		if [ -f $i ] ; then
			Frm `echo $i | sed "s|jre$oldpkgver|/usr/lib/java/jre|"`
		fi
	done
	chown -R root.root $Fdestdir/* || return 1
	Fexe /etc/profile.d/$pkgname.sh
	Fln /usr/lib/java/jre/plugin/i386/ns7/libjavaplugin_oji.so \
		/usr/lib/mozilla/plugins/libjavaplugin_oji.so
}

# optimalization ok

# vim: ft=sh
