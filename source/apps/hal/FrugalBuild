# Compiling time: 0.44 SBU
# Maintainer: crazy <crazy@frugalware.org>
# Contributor: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=hal
pkgver=0.5.7.1
pkgrel=3
pkgdesc="Hardware Abstraction Layer"
url="http://freedesktop.org/wiki/Software_2fhal"
depends=('dbus-glib>=0.71' 'udev>=100' 'glib2' 'libcap' 'python' \
	'libusb' 'popt' 'pciutils' 'shadow>=4.0.18.1-2')
makedepends=('pkgconfig' 'perl-xml' 'doxygen')
groups=('apps')
replaces=('submount')
archs=('i686' 'x86_64')
up2date="lynx -dump 'http://people.freedesktop.org/~david/dist/?C=M;O=A'|grep 'hal-\(.*\).tar.gz$'|sort -n -r|head -n 1|sed 's/.*-\(.*\).t.*/\1/'"
source=(http://freedesktop.org/~david/dist/$pkgname-$pkgver.tar.gz \
	rc.hald hal.conf.in.patch \
	hal-0.5.7-dbus-deprecated.patch  \
	hal-0.5.7-fix-for-nfs-and-autofs.patch  \
	hal-0.5.7-pcmcia-readers.patch0 \
	BTS-1165.patch)
sha1sums=('233b67e724e68f41ec3f53adcfb7d139328c5813' \
          'b2feba21a927fafc4f27f4f630a79f9b3e0944fa' \
          'cf0c83c0f65398884467066c8280007577387dcd' \
          '6d6c32f0fc9b19927ba5a34a8cc819e0dcb670f9' \
          '6dc189fa183fc7bdeb8ad85d77b948b24eb8a666' \
          'ddce2cd8dccd1b047f3cc5795a3968bb79ed2a05' \
          '4fd4ddb2d3793c0c8afc72d619434ed763e29b64')

build()
{
	Fbuild \
		--enable-pcmcia-support \
		--with-pid-file=/var/run/hald.pid \
		--with-hal-user=hald \
		--with-hal-group=hald \
		--enable-sysfs-carrier \
		--with-hwdata=/usr/share/misc
        Frm /etc/hotplug.d
        Fmkdir /media
	Frcd hald
}

# optimization OK
