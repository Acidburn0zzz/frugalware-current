# Last Modified: Tue, 17 May 2005 18:15:23 +0200
# Compiling Time: ~26 minutes
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=mysql
pkgver=4.1.12
pkgrel=1
extrapkgver=
pkgdesc="A fast SQL database server"
backup=(etc/my.cnf)
depends=('openssl' 'zlib' 'gcc')
groups=('apps')
archs=('i686')
up2date="lynx -dump http://dev.mysql.com/|grep -1 'Database Server'|sed -n \"s/.* \(.*\)$/\1/;s/$extrapkgver//;3 p\""
mirror="http://ftp.heanet.ie/mirrors/www.mysql.com"
#mirror="http://mirrors.hpcf.upr.edu/mysql"
source=($mirror/Downloads/MySQL-4.1/$pkgname-$pkgver$extrapkgver.tar.gz rc.mysqld my.cnf)
md5sums=('56a6f5cacd97ae290e07bbe19f279af1' \
	 'f872b54595e501e798b6c10dac03cb32' 'e88779427156367763b420bacc96ae9f')

# echo '/* Linuxthreads */' >> /usr/include/pthread.h
# is needed since we use glibc with ntpl enabled

build()
{
	Fcd $pkgname-$pkgver$extrapkgver
	./configure --prefix=/usr --libexecdir=/usr/sbin \
		--without-debug --without-docs --without-bench \
		--with-innodb --enable-local-infile --with-openssl
	Fsed '^.*HAVE_GETHOSTBYNAME_R_GLIBC2_STYLE.*$' '#define HAVE_GETHOSTBYNAME_R_GLIBC2_STYLE' config.h
	Fsed 'size_socket' 'socklen_t' sql/mysqld.cc
	
	make || return 1
	
	Fmakeinstall
	Fln mysql/libmysqlclient.so /usr/lib/
	Fln mysql/libmysqlclient.so.14 /usr/lib/
	Ffile my.cnf /etc/my.cnf
	Frcd mysqld
}

# optimalization ok

# vim: ft=sh
