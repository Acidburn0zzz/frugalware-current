# Last Modified: Tue, 25 Oct 2005 13:50:23 +0200
# Compiling Time: 2.45 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>
# Modified by: BMH1980 <bmh1980de@yahoo.de>

pkgname=mysql
pkgver=5.0.15
pkgrel=1
extrapkgver=
pkgdesc="A fast SQL database server"
backup=(etc/my.cnf)
depends=('openssl' 'libstdc++' 'zlib' 'ncurses' 'perl-dbi' 'perl-mysql')
makedepends=('procps')
groups=('apps')
archs=('i686' 'x86_64')
up2date="lynx -dump http://dev.mysql.com/|grep 'Generally Available'|sed -n 's/.* \(.*\)/\1/;s/$extrapkgver//;1 p'"
mirror="http://ftp.heanet.ie/mirrors/www.mysql.com"
#mirror="http://mirrors.hpcf.upr.edu/mysql"
source=($mirror/Downloads/MySQL-5.0/$pkgname-$pkgver$extrapkgver.tar.gz rc.mysqld my.cnf)
sha1sums=('b6092615de6ef5f861f91810413007c1c63058cf' \
	  '7a42206632b859be8635199c2dfc8ca305756994' \
	  '5e52e3cc67a49f7090f3ae82149118ef6bbab922')

build()
{
	Fcd $pkgname-$pkgver$extrapkgver
	Fconf --libexecdir=/usr/sbin \
		--without-debug \
		--without-bench \
		--with-innodb \
		--enable-local-infile \
		--with-openssl \
		--enable-thread-safe-client \
		--with-raid \
		--with-client-ldflags=-lstdc++ \
		--with-comment="Frugalware Linux - ${pkgname}-${pkgver}"
	Fsed '^.*HAVE_GETHOSTBYNAME_R_GLIBC2_STYLE.*$' '#define HAVE_GETHOSTBYNAME_R_GLIBC2_STYLE' config.h
	Fsed 'size_socket' 'socklen_t' sql/mysqld.cc
	Fsed 'testdir = $(benchdir_root)' 'testdir = $(benchdir_root)/share/mysql' mysql-test/Makefile
	
	make || return 1
	
	Fmakeinstall
	Fln mysql/libmysqlclient.so /usr/lib/
	Fln mysql/libmysqlclient.so.15 /usr/lib/
	Fln mysql/libmysqlclient_r.so.15 /usr/lib/
	Ffile my.cnf /etc/my.cnf
	Frcd mysqld
}

# optimalization ok

# vim: ft=sh
