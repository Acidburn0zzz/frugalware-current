# Compiling Time: 0.25 SBU
# Maintainer: James Buren <ryuo@frugalware.org>

pkgname=libva
pkgver=1.7.3
pkgrel=1
pkgdesc="Uniform library API for hardware acceleration of video decoding."
url="http://www.freedesktop.org/wiki/Software/vaapi"
depends=('wayland>=1.11.0-3' 'libxext>=1.3.3-3' 'libxfixes>=5.0.1-3' 'libdrm>=2.4.70-2')
makedepends+=('x11-protos>=0.1-3')
groups=('x11')
archs=('i686' 'x86_64')
up2date="Fwcat http://cgit.freedesktop.org/$pkgname | grep -om1 '>$pkgname-[0-9.]\+<' | sed 's|^>$pkgname-\(.*\)<$|\1|'"
source=(http://cgit.freedesktop.org/$pkgname/snapshot/$pkgname-$pkgver.tar.bz2)
sha1sums=('3cf8361e4f7908625d41a3237717582188214047')

subpkgs=("$pkgname-glx")
subdescs=("LibVA using gl")
subdepends=('libgl>=12.0.3-3')
subrodepends=("libva>=$pkgver")
subgroups=('x11')
subarchs=('i686 x86_64')
suboptions+=('force')

subpkgs+=("$pkgname-egl")
subdescs+=("LibVA using egl")
subdepends+=('libegl>=12.0.3')
subrodepends+=("libva>=$pkgver")
subgroups+=('x11')
subarchs+=('i686 x86_64')
suboptions+=('force')

subpkgs+=("$pkgname-tpi")
subdescs+=("LibVA using tpi")
subdepends+=('')
subrodepends+=("libva>=$pkgver")
subgroups+=('x11')
subarchs+=('i686 x86_64')
suboptions+=('force')

build()
{
	Fbuild

	for plugin in "${subpkgs[@]}"
	do
		Fsplit $plugin usr/include/va/va*${plugin/libva-/}.h
		Fsplit $plugin usr/lib/${plugin}*
		Fsplit $plugin usr/lib/pkgconfig/${plugin}.pc
	done

}

# optimization OK
