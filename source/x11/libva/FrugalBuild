# Compiling Time: 0.25 SBU
# Maintainer: James Buren <ryuo@frugalware.org>

pkgname=libva
pkgver=1.7.1
pkgrel=1
pkgdesc="Uniform library API for hardware acceleration of video decoding."
url="http://www.freedesktop.org/wiki/Software/vaapi"
depends=('wayland>=1.9.0-2' 'libxext>=1.3.3-2' 'libxfixes>=5.0.1-2' 'libdrm>=2.4.68')
makedepends=('x11-protos>=0.1-3')
groups=('x11')
archs=('i686' 'x86_64' 'arm')
up2date="Fwcat http://cgit.freedesktop.org/$pkgname | grep -om1 '>$pkgname-[0-9.]\+<' | sed 's|^>$pkgname-\(.*\)<$|\1|'"
source=(http://cgit.freedesktop.org/$pkgname/snapshot/$pkgname-$pkgver.tar.bz2)
sha1sums=('24a7de605b2a85383bec4fc8fd7e1b063cacfbc8')

subpkgs=("$pkgname-glx")
subdescs=("LibVA using gl")
subdepends=('libgl>=11.2.1-2')
subrodepends=("libva>=$pkgver")
subgroups=('x11')
subarchs=('i686 x86_64 arm')

subpkgs+=("$pkgname-egl")
subdescs+=("LibVA using egl")
subdepends+=('libegl>=11.2.1-2')
subrodepends+=("libva>=$pkgver")
subgroups+=('x11')
subarchs+=('i686 x86_64 arm')

subpkgs+=("$pkgname-tpi")
subdescs+=("LibVA using tpi")
subdepends+=('')
subrodepends+=("libva>=$pkgver")
subgroups+=('x11')
subarchs+=('i686 x86_64 arm')

build()
{
	Fbuild

	for plugin in "${subpkgs[@]}"
	do
		Fsplit $plugin usr/include/va/va*${plugin/libva-/}.h
		Fsplit $plugin usr/lib/${plugin}*
		Fsplit $plugin usr/lib/pkgconfig/${plugin}.pc
	done

}

# optimization OK
