# Compiling Time: 0.25 SBU
# Maintainer: James Buren <ryuo@frugalware.org>

pkgname=libva
pkgver=1.6.2
pkgrel=1
pkgdesc="Uniform library API for hardware acceleration of video decoding."
url="http://www.freedesktop.org/wiki/Software/vaapi"
depends=('wayland libxext libxfixes libdrm')
makedepends=('x11-protos')
groups=('x11')
archs=('i686' 'x86_64' 'arm')
up2date="Fwcat http://cgit.freedesktop.org/$pkgname | grep -om1 '>$pkgname-[0-9.]\+<' | sed 's|^>$pkgname-\(.*\)<$|\1|'"
source=(http://cgit.freedesktop.org/$pkgname/snapshot/$pkgname-$pkgver.tar.bz2)
sha1sums=('1ea92cb4fb8e768047cad300510d8ba7cd6353ac')

subpkgs+=("$pkgname-glx")
subdescs+=("LibVA using gl")
subdepends+=('libgl')
subrodepends+=("libva-x11=$pkgname")
subgroups+=('x11')
subarchs+=('i686 x86_64 arm')

subpkgs+=("$pkgname-egl")
subdescs+=("LibVA using egl")
subdepends+=('libegl')
subrodepends+=("libva=$pkgname")
subgroups+=('x11')
subarchs+=('i686 x86_64 arm')

subpkgs+=("$pkgname-tpi")
subdescs+=("LibVA using tpi")
subdepends+=('')
subrodepends+=("libva=$pkgname")
subgroups+=('x11')
subarchs+=('i686 x86_64 arm')

subpkgs+=("$pkgname-drm")
subdescs+=("LibVA using DRM")
subdepends+=('libdrm')
subrodepends+=("libva=$pkgname")
subgroups+=('x11')
subarchs+=('i686 x86_64 arm')

build()
{
	Fbuild

	for plugin in "${subpkgs[@]}"
	do
		Fsplit $plugin usr/include/va/va*${plugin/libva-/}.h
		Fsplit $plugin usr/lib/${plugin}*
		Fsplit $plugin usr/lib/pkgconfig/${plugin}.pc
	done

}

# optimization OK
