# Compiling Time: 0.23 SBU
# Maintainer: AlexExtreme <alex@alex-smith.me.uk>

# Do NOT bump this package without explicit permission from the maintainer, and if you do get permission,
# test it FULLY before pushing.

pkgname=tracker
pkgver=0.5.4
pkgrel=4
pkgdesc="Tracker is a first class object database, extensible tag/metadata database, search tool and indexer."
url="http://www.gnome.org/~jamiemcc/tracker/"
depends=('gtk+2>=2.12.0-2' 'gmime' 'dbus-glib>=0.71-2' 'sqlite3' 'gamin' 'poppler-glib>=0.6' 'libvorbis' 'libpng' 'libexif' 'libgsf' 'gstreamer')
makedepends=('intltool' 'perl-xml' 'gnome-desktop' 'gnome-vfs')
groups=('gnome-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.gnome.org/projects/tracker/download.html | Flasttar"
source=($url/$pkgname-$pkgver.tar.gz trackerd.desktop trackerd_wrap)
sha1sums=('1688b6e936193cdf8dca8ccf01fe03b91b5d3fd5' \
	  'b6f38d8e9b40c8c78019d023caa688188fff3042' \
	  '830d6539fdbadf51a468cd6fa37ef5416ef2bc84')
subpkgs=('tracker-search-tool')
subdescs=('GNOME frontend for Tracker')
subdepends=("gnome-desktop gnome-vfs tracker=$pkgver")
subgroups=('gnome-extra')
subarchs=('i686')
unset MAKEFLAGS

build() {
	Fbuild --with-deskbar-applet-handler-dir=/usr/lib/deskbar-applet/handlers/
	
	# Trackerd should run at login
	Fmkdir /usr/share/gnome/autostart
	cp $Fsrcdir/trackerd.desktop $Fdestdir/usr/share/gnome/autostart/ || Fdie
	
	# Wrapper to make it STFU
	Fexerel $Fsrcdir/trackerd_wrap /usr/bin/trackerd_wrap
	
	# Split the GNOME crap out
	Fsplit tracker-search-tool usr/bin/tracker-search-tool
	Fsplit tracker-search-tool usr/share/applications
	Fsplit tracker-search-tool usr/share/pixmaps
}

# optimization OK
