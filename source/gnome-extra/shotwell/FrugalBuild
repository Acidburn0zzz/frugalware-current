# Compiling Time: 2.82 SBU
# Maintainer: Baste <baste@frugalware.org>

pkgname=shotwell
pkgver=0.11.5
pkgrel=3
pkgdesc="A digital photo organizer designed for the GNOME desktop environment"
url="http://yorba.org/shotwell/"
depends=('gconf' 'libgee' 'libgphoto2' 'unique1' 'webkit' 'libgexiv2>=0.3.1-2' 'libraw>=0.14.3' 'librsvg' 'json-glib' 'libgudev')
makedepends=('vala>=0.11' 'intltool')
options=('scriptlet')
_F_gnome_schemas=('/etc/gconf/schemas/shotwell.schemas')
_F_gnome_glib="y"
_F_gnome_desktop="y"
_F_gnome_iconcache="y"
Finclude gnome-scriptlet
groups=('gnome-extra')
archs=('i686' 'x86_64')
up2date="Flasttar $url/install/"
source=(http://yorba.org/download/shotwell/0.11/$pkgname-$pkgver.tar.bz2 \
	http://ftp.gnome.org/pub/gnome/sources/vala/0.12/vala-0.12.1.tar.bz2 \
	build-hack.patch)
sha1sums=('7ca5bd82b0c39ba6f47e40c24b4a521c0729db1b' \
          'defa61ac7b9f97abe8aac7ad7fb3f80f3c0b9657' \
          'a539136e8f62d5353f73a1b9628fd7ff5bc3034b')

build() {
	cd $Fsrcdir/vala-0.12.1
  	./configure --prefix=$Fsrcdir/vala --enable-vapigen
  	make
  	make install
  	export PATH=$Fsrcdir/vala/bin:$PATH
	cd $Fsrcdir/$pkgname-$pkgver
	./configure --prefix=/usr \
	--with-gconf-schema-file-dir=/etc/gconf/schemas \
	--disable-schemas-install \
	--disable-desktop-update \
	--disable-gsettings-convert-install \
	--disable-icon-update || Fdie
	# hack
	make || true
	Fpatch build-hack.patch
	make || Fdie
	Fmakeinstall
	Frm usr/share/icons/hicolor/icon-theme.cache
	Frm usr/share/glib-2.0/schemas/gschemas.compiled
	Fbuild_gnome_scriptlet
}

# optimization OK
