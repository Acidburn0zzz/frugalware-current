# Last modified: Mon, 30 May 2005 12:02:30 +0000
# Compiling time: ~0.2 SBU
# Contributed: VMiklos <vmiklos@frugalware.org>
# Maintainer: Zsolt Szalai <xbit.lists@chello.hu>
# Modified by zleho <zleho@index.hu> and Laszlo Dvornik <dvornik@gnome.hu>

pkgname=fontconfig
pkgver=2.2.3
pkgrel=8
pkgdesc="A library for configuring and customizing font access"
url="http://freedesktop.org/wiki/Software_2ffontconfig"
depends=('expat' 'freetype2')
groups=('lib')
archs=('i686' 'x86_64')
remove=('usr/bin/fc-cache' 'usr/bin/fc-list' 'usr/lib/libfontconfig.a' \
	'usr/lib/libfontconfig.la' 'usr/lib/libfontconfig.so' \
	'usr/lib/libfontconfig.so.1' 'usr/lib/libfontconfig.so.1.0.4' \
	'usr/lib/pkgconfig/fontconfig.pc' \
	'usr/include/fontconfig/fcfreetype.h' \
	'usr/include/fontconfig/fcprivate.h' \
	'usr/include/fontconfig/fontconfig.h' \
	'usr/include/fontconfig')
backup=('etc/fonts/local.conf')
install=$pkgname.install
up2date="lynx -dump 'http://freedesktop.org/fontconfig/release/?C=M;O=D'|grep '[0-8\.][0-9].tar.gz$'|sed -n 's/.*g-\(.*\)\.t.*/\1/;1 p'"
source=(http://freedesktop.org/fontconfig/release/fontconfig-$pkgver.tar.gz \
	00-$pkgname-2.2.3-better-defaults.patch \
	$pkgname.install)
md5sums=('2466a797d645cda5eb466080fdaec416' \
	'3fe7e02a64987b75f012cba0a98af3d9' \
	'29ba8e219f57d2facc0eedc6ebe8f1ee')

build() {
	cd $startdir/src/$pkgname-$pkgver
	patch -p1 < $startdir/src/00-$pkgname-2.2.3-better-defaults.patch || return 1
	sed -i -e "s:\(<dir>~/.fonts</dir>\):\1 <dir>/opt/kde/share/fonts</dir> <dir>/usr/share/ghostscript/fonts</dir>:" fonts.conf.in
	./configure --prefix=/usr --sysconfdir=/etc 

	make || return 1

	make DESTDIR=$startdir/pkg install
	install -d $startdir/pkg/usr/X11R6/lib/
	cd $startdir/pkg/usr/X11R6/lib/
	ln -s /usr/lib/libfontconfig.la libfontconfig.la
}

# vim: ft=sh
