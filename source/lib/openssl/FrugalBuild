# Last Modified: Mon, 11 Jul 2005 16:40:20 +0200
# Compiling Time: ~6 minutes
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: Zsolt Szalai <xbit.lists@chello.hu>

pkgname=openssl
pkgver=0.9.8
pkgrel=1
pkgdesc="The Open Source toolkit for Secure Sockets Layer and Transport Layer Security"
url="http://www.openssl.org/source/"
groups=('lib' 'chroot-core')
archs=('i686' 'x86_64')
depends=('glibc')
up2date="lynx -source http://www.openssl.org/source/ |grep LATEST|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=($url$pkgname-$pkgver.tar.gz)
md5sums=('9da21071596a124acde6080552deac16')

build()
{
	Fcd
	# optimize the build
	sed -i "s/^\(\"linux-elf\".*\) -O3 -fomit-frame-pointer \(.*\)/\1 $CFLAGS \2/" Configure
	./config --prefix=/usr --openssldir=/etc/ssl shared
	
	make || return 1 #Fmake sucks here
	make INSTALL_PREFIX=$Fdestdir MANDIR=/usr/man install

	ln -s libssl.so.$pkgver $startdir/pkg/usr/lib/libssl.so.0  # look out!!
	ln -s libcrypto.so.$pkgver $startdir/pkg/usr/lib/libcrypto.so.0  # look out!!

	(cd $Fdestdir/usr/man/man1 && rename '' openssl_ *)
	(cd $Fdestdir/usr/man/man3 && rename '' openssl_ *)
	(cd $Fdestdir/usr/man/man5 && rename '' openssl_ *)
	(cd $Fdestdir/usr/man/man7 && rename '' openssl_ *)

}

# vim: ft=sh
# optimalization OK
