# Last Modified: Tue, 24 May 2005 22:04:21 +0200
# Compiling Time: ~1 minute
# Contributor: VMiklos <mamajom@axelero.hu>
# Maintainer: Zsolt Szalai <xbit.lists@chello.hu>

pkgname=libpng
pkgver=1.2.8
pkgrel=3
pkgdesc="A collection of routines used to create PNG format graphics files"
url="http://www.libpng.org/"
depends=('zlib' 'glibc')
groups=('lib')
up2date="lynx -dump $url/pub/png/libpng.html |grep version: |sed 's/.*: \(.*\)/\1/'"
source=(http://dl.sourceforge.net/sourceforge/libpng/libpng-$pkgver.tar.bz2)
md5sums=('00cea4539bea4bd34cbf8b82ff9589cd')

build() {
	cd $startdir/src/$pkgname-$pkgver
	# patch -p1 < $startdir/src/CESA-2004-001.patch
	sed -e "s|ZLIBLIB=.*|ZLIBLIB=/usr/lib|" \
		-e "s|ZLIBINC=.*|ZLIBINC=/usr/include|" \
		-e "s/-O3/${CFLAGS}/" \
		-e "s|prefix=/usr/local|prefix=/usr|" \
		-e "s/OBJSDLL = /OBJSDLL = -lz -lm /" scripts/makefile.linux \
		> Makefile
		
	make || return 1
	
	mkdir -p $startdir/pkg/usr/{include,lib,man/man3}
	make prefix=/usr DESTDIR=$startdir/pkg install
}

# vim: ft=sh
