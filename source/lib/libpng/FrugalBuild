# Last Modified: Sat, 07 Jan 2006 16:36:22 +0100
# Compiling Time: 0.09 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: Zsolt Szalai <xbit.lists@chello.hu>

pkgname=libpng
pkgver=1.2.8
pkgrel=3
pkgdesc="A collection of routines used to create PNG format graphics files"
url="http://www.libpng.org/"
depends=('zlib' 'glibc')
groups=('lib')
archs=('i686' 'x86_64' 'ppc')
up2date="lynx -dump $url/pub/png/libpng.html |grep version: |sed 's/.*: \(.*\)/\1/'"
source=(http://dl.sourceforge.net/sourceforge/libpng/libpng-$pkgver.tar.bz2)
sha1sums=('b6d73493eea4095166118b298efecb54a8e3d2f5')

build() {
	cd $startdir/src/$pkgname-$pkgver
	# patch -p1 < $startdir/src/CESA-2004-001.patch
	sed -e "s|ZLIBLIB=.*|ZLIBLIB=/usr/lib|" \
		-e "s|ZLIBINC=.*|ZLIBINC=/usr/include|" \
		-e "s/-O3/${CFLAGS}/" \
		-e "s|prefix=/usr/local|prefix=/usr|" \
		-e "s/OBJSDLL = /OBJSDLL = -lz -lm /" scripts/makefile.linux \
		> Makefile
		
	make || return 1
	
	mkdir -p $startdir/pkg/usr/{include,lib,man/man3}
	make prefix=/usr DESTDIR=$startdir/pkg install
}

# vim: ft=sh

# optimalization OK
