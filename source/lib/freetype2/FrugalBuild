# Compiling Time: 0.27 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=freetype2
pkgver=2.3.5
pkgrel=2
pkgdesc="TrueType font rendering library - 2.0 series (with bytecode interpreter)"
url="http://freetype.sourceforge.net"
groups=('lib')
archs=('i686' 'x86_64')
depends=('zlib')
_F_cd_path="freetype-$pkgver"
up2date="lynx -dump 'http://sourceforge.net/project/showfiles.php?group_id=3157&package_id=3121'|grep 'freetype-' |sed -e 's/.*type-\(.*\).tar.bz2.*/\1/;q'"
source=(http://download.savannah.gnu.org/releases/freetype/freetype-$pkgver.tar.bz2 \
	freetype-2.2.1-memcpy-fix.patch revert_v.1.188.patch)
# NOTE: added patch to *TEMP* revert : http://cvs.savannah.nongnu.org/viewvc/freetype2/src/truetype/ttgload.c?root=freetype&r1=1.187&r2=1.188
# with that patch we segfault at TT_Load_Simple_Glyph() and looks like the bug(s) are triggered by some bitmap fonts
# BUG REPORT : https://savannah.nongnu.org/bugs/index.php?20581  -- crazy --
signatures=("$source.sig" '' '')

build()
{

	Fsed '^/\* \(#define TT_CONFIG_OPTION_BYTECODE_INTERPRETER\) \*/' '\1' include/freetype/config/ftoption.h
	Fbuild
}

# optimization OK
