diff -Naur libmms-0.6.2/src/mmsh.c libmms-0.6.2.new/src/mmsh.c
--- libmms-0.6.2/src/mmsh.c	2011-01-17 11:51:12.000000000 +0100
+++ libmms-0.6.2.new/src/mmsh.c	2014-04-28 09:42:58.760239900 +0200
@@ -307,7 +307,10 @@
         len = 0;
       }
     } else {
-      len ++;
+      if (++len >= sizeof(this->buf)) {
+		lprintf("answer too large\n");
+		return 0;
+	  }
     }
   }
   if (this->stream_type == MMSH_UNKNOWN) {
