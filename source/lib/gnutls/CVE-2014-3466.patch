diff -Naur gnutls-3.2.12/lib/gnutls_handshake.c gnutls-3.2.12.new/lib/gnutls_handshake.c
--- gnutls-3.2.12/lib/gnutls_handshake.c	2014-02-22 18:40:46.000000000 +0100
+++ gnutls-3.2.12.new/lib/gnutls_handshake.c	2014-06-02 15:18:20.152782076 +0200
@@ -1744,7 +1744,7 @@
 	DECR_LEN(len, 1);
 	session_id_len = data[pos++];
 
-	if (len < session_id_len) {
+	if (len < session_id_len || session_id_len > TLS_MAX_SESSION_ID_SIZE) {
 		gnutls_assert();
 		return GNUTLS_E_UNSUPPORTED_VERSION_PACKET;
 	}
