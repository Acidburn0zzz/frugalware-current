# Compiling Time: ~0.8 SBU
# Contributor: Laszlo Dvornik <dvornik@gnome.hu>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=heimdal
pkgver=0.7.2
pkgrel=3
pkgdesc="Heimdal Kerberos V5 libraries"
url="http://www.pdc.kth.se/heimdal/"
groups=('lib')
archs=('i686' 'x86_64')
depends=('db>=4.5.20' 'openssl' 'e2fsprogs' 'texinfo' 'termcap')
up2date="lynx -dump $url |grep current|sed 's/.*e \(.*\) and.*/\1/'"
source=(http://ftp.pdc.kth.se/pub/heimdal/src/$pkgname-$pkgver.tar.gz $pkgname-$pkgver-setuid-patch)
[ "$CARCH" == "x86_64" ] && Fconfopts="$Fconfopts --with-pic --with-gnu-ld"
Finclude texinfo

build()
{
	Fbuild --enable-shared=yes --without-x
	rm $startdir/pkg/usr/include/fnmatch.h
	rm $startdir/pkg/usr/include/glob.h
	rm $startdir/pkg/usr/include/ss/ss.h
	rm $startdir/pkg/usr/lib/libss.*
	for i in ftp pagsh rcp rsh su telnet mk_cmds; do
		mv $startdir/pkg/usr/bin/$i $startdir/pkg/usr/bin/k$i
		mv $startdir/pkg/usr/man/man1/$i.1 $startdir/pkg/usr/man/man1/k$i.1
	done
	mv $startdir/pkg/usr/bin/login $startdir/usr/libexec
	rm $startdir/pkg/usr/man/man8/rshd.8
	rm $startdir/pkg/usr/man/man8/telnetd.8
	rm $startdir/pkg/usr/man/man1/login.1
	rm $startdir/pkg/usr/man/man5/ftpusers.5
	rm $startdir/pkg/usr/man/man5/login.access.5
	rm -rf $startdir/pkg/usr/man/cat*
	# backward compatibility
	Fln libgssapi.so.4 /usr/lib/libgssapi.so.1
}
sha1sums=('a902e6ad7c31d940b588dc0235b348936f0d719d' \
	  'cb10f607d481e6ad8bc2f8111e67e0b995971cd7')

# optimization OK
