# Compiling Time: ~0.8 SBU
# Contributor: Laszlo Dvornik <dvornik@gnome.hu>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=heimdal
pkgver=1.0.1
pkgrel=1
pkgdesc="Heimdal Kerberos V5 libraries"
url="http://www.pdc.kth.se/heimdal/"
groups=('lib')
archs=('i686' 'x86_64')
depends=('e2fsprogs' 'openssl' 'termcap' 'db>=4.6.18')
up2date="lynx -dump $url |grep current|sed 's/.*e \(.*\) and.*/\1/'"
source=(http://ftp.pdc.kth.se/pub/heimdal/src/$pkgname-$pkgver.tar.gz)
[ "$CARCH" == "x86_64" ] && Fconfopts="$Fconfopts --with-pic"
signatures=("$source.asc")
Finclude texinfo

build()
{
	Fbuild --enable-shared=yes --enable-static=no \
		--without-x --enable-pthread-support \
		--libexecdir=/usr/sbin --with-gnu-ld
	for i in ftp login mk_cmds rcp rsh su telnet; do
		Fmv usr/bin/$i usr/bin/k$i
		[ -e $Fdestdir/usr/share/man/man1/$i.1 ] && Fmv usr/share/man/man1/$i.1 usr/share/man/man1/k$i.1
	done
	for i in ftpd rshd telnetd; do
		Fmv usr/sbin/$i usr/sbin/k$i
		Fmv usr/share/man/man8/$i.8 usr/share/man/man8/k$i.8
	done
	Frm usr/share/man/cat*
	# conflicts with man-pages
	Frm usr/share/man/man5/ftpusers.5*
	# conflicts with shadow
	Frm usr/share/man/man5/login.access.5*
	# conflicts with e2fsprogs http://wiki.linuxfromscratch.org/blfs/ticket/1526
	Frm usr/include/ss/ss.h
	Frm usr/lib/libss.*
}

# optimization OK
