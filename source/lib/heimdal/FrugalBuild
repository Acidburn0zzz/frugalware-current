# Last Modified: Thu, 25 Aug 2005 10:33:58 +0200
# Compiling Time: ~0.8 SBU
# Contributor: Laszlo Dvornik <dvornik@gnome.hu>
# Maintainer: Zsolt Szalai <xbit.lists@chello.hu>

pkgname=heimdal
pkgver=0.7
pkgrel=2
pkgdesc="Heimdal Kerberos V5 libraries"
url="http://www.pdc.kth.se/heimdal/"
groups=('lib')
archs=('i686' 'x86_64')
depends=('db' 'openssl' 'e2fsprogs' 'texinfo' 'termcap')
up2date="wget --passive-ftp -O - -q ftp://ftp.pdc.kth.se/pub/heimdal/src/|sed -n 's/.*-\([0-9.]\+\).tar.gz.*/\1/;T;p'|sort -r|sed -n '1p'"
source=(ftp://ftp.pdc.kth.se/pub/heimdal/src/$pkgname-$pkgver.tar.gz)
sha1sums=('a3c8340290424a214a0312c0eb02949354a7867c')
install=$pkgname.install
[ "$CARCH" == "x86_64" ] && Fconfopts="$Fconfopts --with-pic --with-gnu-ld"

build()
{
	Fcd /heimdal-$pkgver
	Fbuild --enable-shared=yes --without-x
	rm $startdir/pkg/usr/include/fnmatch.h
	rm $startdir/pkg/usr/include/glob.h
	rm $startdir/pkg/usr/include/ss/ss.h
	rm $startdir/pkg/usr/lib/libss.*
	for i in ftp pagsh rcp rsh su telnet mk_cmds; do
		mv $startdir/pkg/usr/bin/$i $startdir/pkg/usr/bin/k$i
		mv $startdir/pkg/usr/man/man1/$i.1 $startdir/pkg/usr/man/man1/k$i.1
	done
	mv $startdir/pkg/usr/bin/login $startdir/usr/libexec
	rm $startdir/pkg/usr/man/man8/rshd.8
	rm $startdir/pkg/usr/man/man8/telnetd.8
	rm $startdir/pkg/usr/man/man1/login.1
	rm $startdir/pkg/usr/man/man5/ftpusers.5
	rm $startdir/pkg/usr/man/man5/login.access.5
	rm -rf $startdir/pkg/usr/man/cat*
	# backward compatibility
	Fln libgssapi.so.4 /usr/lib/libgssapi.so.1
}

# vim: ft=sh

# optimalization OK
