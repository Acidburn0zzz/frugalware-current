http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-2906
diff -Naur gd-2.0.33.orig/gd_gif_in.c gd-2.0.33/gd_gif_in.c
--- gd-2.0.33.orig/gd_gif_in.c	2004-11-01 19:28:56.000000000 +0100
+++ gd-2.0.33/gd_gif_in.c	2006-08-06 13:12:04.000000000 +0200
@@ -417,16 +417,17 @@
                                        GetCode(fd, code_size, FALSE, ZeroDataBlockP);
                        return firstcode;
                } else if (code == end_code) {
+                       int             maxcount = 1024;
                        int             count;
                        unsigned char   buf[260];
 
                        if (*ZeroDataBlockP)
                                return -2;
 
-                       while ((count = GetDataBlock(fd, buf, ZeroDataBlockP)) > 0)
+                       while ((count = GetDataBlock(fd, buf, ZeroDataBlockP)) > 0 && --maxcount >= 0)
                                ;
 
-                       if (count != 0)
+                       if (count != 0 || maxcount < 0)
                        return -2;
                }
 
