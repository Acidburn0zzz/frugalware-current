# Compiling time: 0.05 SBU
# Maintainer: bouleetbil <bouleetbil@frogdev.info>

pkgname=libproxy
pkgver=0.4.2
pkgrel=1
pkgdesc="libproxy is a library that provides automatic proxy configuration management."
depends=('glibc' 'dbus' 'xulrunner')
replaces=("$pkgname-xulrunner")
makedepends=('automoc4')
groups=('lib')
archs=('i686' 'x86_64' 'ppc')
Finclude googlecode cmake python
sha1sums=('0715d92398b554e97c18c98c3ac67a4c41b16abc')

subpkgs=("${subpkgs[@]}" "$pkgname-python")
subdescs=("${subdescs[@]}" "$pkgname python binding")
subdepends=("${subdepends[@]}" "python")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'devel-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-webkit")
subdescs=("${subdescs[@]}" "$pkgname webkit support")
subdepends=("${subdepends[@]}" "webkit")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'xlib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-xulrunner")
subdescs=("${subdescs[@]}" "$pkgname xulrunner support")
subdepends=("${subdepends[@]}" "xulrunner")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'xlib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

#subpkgs=("${subpkgs[@]}" "$pkgname-kde")
#subdescs=("${subdescs[@]}" "$pkgname kde support")
#subdepends=("${subdepends[@]}" "kdelibs libkdecore")
#subrodepends=("${subrodepends[@]}" "$pkgname")
#subgroups=("${subgroups[@]}" 'kde-extra')
#subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-gnome")
subdescs=("${subdescs[@]}" "$pkgname gnome support")
subdepends=("${subdepends[@]}" "gconf")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'gnome')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-networkmanager")
subdescs=("${subdescs[@]}" "$pkgname networkmanager support")
subdepends=("${subdepends[@]}" "networkmanager")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'lib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-perl")
subdescs=("${subdescs[@]}" "$pkgname perl support")
subdepends=("${subdepends[@]}" "perl")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'lib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-vala")
subdescs=("${subdescs[@]}" "$pkgname vala support")
subdepends=("${subdepends[@]}" "vala")
subrodepends=("${subrodepends[@]}" "$pkgname")
subgroups=("${subgroups[@]}" 'lib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

#TODO : added kde4 and mono support

build() {
	Fcd
	CMake_build -Dmoduledir=/usr/lib/$pkgname/$pkgver/modules \
		-DWITH_VALA=yes
	Fmv /usr/lib/perl5/site_perl/`perl -e 'printf "%vd", $^V'` /usr/lib/perl5/site_perl/current
	Fsplit $pkgname-perl usr/lib/perl5
	Fsplit $pkgname-vala usr/share/vala
	Fsplit $pkgname-python $_F_python_libdir
	Fsplit $pkgname-gnome usr/lib/$pkgname/$pkgver/modules/config_gnome.so
	Fsplit $pkgname-gnome usr/libexec/pxgconf
	Fsplit $pkgname-networkmanager usr/lib/$pkgname/$pkgver/modules/network_networkmanager.so
	Fsplit $pkgname-webkit usr/lib/$pkgname/$pkgver/modules/pacrunner_webkit.so
	Fsplit $pkgname-xulrunner usr/lib/$pkgname/$pkgver/modules/pacrunner_mozjs.so
	#Fsplit $pkgname-kde usr/lib/$pkgname/modules/$pkgver/config_kde.so
}

# optimization OK
