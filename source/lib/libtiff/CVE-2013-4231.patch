Description: fix denial of service via buffer overflow in gif2tiff
Origin: upstream, cvs diff -u -r 1.12 -r 1.13 tools/gif2tiff.c
Bug: http://bugzilla.maptools.org/show_bug.cgi?id=2450
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=719303

Index: tiff-3.9.5/tools/gif2tiff.c
===================================================================
--- tiff-3.9.5.orig/tools/gif2tiff.c	2014-05-05 15:36:53.936705281 -0400
+++ tiff-3.9.5/tools/gif2tiff.c	2014-05-05 15:36:53.928705281 -0400
@@ -329,6 +329,8 @@
     int status = 1;
 
     datasize = getc(infile);
+    if (datasize > 12)
+	return 0;
     clear = 1 << datasize;
     eoi = clear + 1;
     avail = clear + 2;
