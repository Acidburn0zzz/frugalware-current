Description: fix denial of service and possible code execution in
 gif2tiff tool LZW decompressor
Origin: upstream, cvs diff -u -r 1.13 -r 1.14 tools/gif2tiff.c
Bug-RedHat: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4244

Index: tiff-3.9.5/tools/gif2tiff.c
===================================================================
--- tiff-3.9.5.orig/tools/gif2tiff.c	2014-05-05 15:37:55.412706278 -0400
+++ tiff-3.9.5/tools/gif2tiff.c	2014-05-05 15:37:55.412706278 -0400
@@ -396,6 +396,10 @@
     }
 
     if (oldcode == -1) {
+        if (code >= clear) {
+            fprintf(stderr, "bad input: code=%d is larger than clear=%d\n",code, clear);
+            return 0;
+        }
 	*(*fill)++ = suffix[code];
 	firstchar = oldcode = code;
 	return 1;
