Description: fix denial of service via use-after-free in tiff2pdf
Origin: upstream, cvs diff -u -r 1.71 -r 1.72 tools/tiff2pdf.c
Bug: http://bugzilla.maptools.org/show_bug.cgi?id=2449
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=719303
Bug-RedHat: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4232

Index: tiff-3.9.5/tools/tiff2pdf.c
===================================================================
--- tiff-3.9.5.orig/tools/tiff2pdf.c	2014-05-05 15:37:08.540705518 -0400
+++ tiff-3.9.5/tools/tiff2pdf.c	2014-05-05 15:37:08.536705518 -0400
@@ -2458,7 +2458,8 @@
 					t2p->tiff_datasize, 
 					TIFFFileName(input));
 				t2p->t2p_error = T2P_ERR_ERROR;
-			  _TIFFfree(buffer);
+				_TIFFfree(buffer);
+				return(0);
 			} else {
 				buffer=samplebuffer;
 				t2p->tiff_datasize *= t2p->tiff_samplesperpixel;
