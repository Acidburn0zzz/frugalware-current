# Compiling time: 2.27 SBU
# Maintainer: DeX77 <dex77@frugalware.org>
# Contributor: Janos Kovacs <janny@frugalware.org>

pkgname=fftw
pkgver=3.3.5
pkgrel=5
pkgdesc="C subroutine library for computing the Discrete Fourier Transform (DFT)"
url="http://www.fftw.org/"
license="GPL-2"
depends=('glibc>=2.24-4')
archs=("x86_64")
groups=('lib')
up2date="Flasttar $url/download.html"
source=(http://www.fftw.org/$pkgname-$pkgver.tar.gz)
sha1sums=('875831a7ab87d278f21ac0c3453f12d5ee807da4')
_F_cross32_simple_auto="yes"
Fconfopts+="	--enable-shared \
		--enable-threads"

F32confopts+="	--includedir=/usr/i686-frugalware-linux/include \
		--bindir=/usr/i686-frugalware-linux/bin \
		--libdir=/usr/lib32"
Finclude cross32

build()
{

	Fcd
	_Fconfopts="$Fconfopts"
	Fcross32_prepare
        Fcross32_copy_source
        Fbuild $F32confopts
	Fbuild $F32confopts --enable-float
	Fbuild $F32confopts --enable-long-double

        Fcross32_copy_back_source
        Fcross32_reset_and_fix

        Fcross32_delete_empty
	Fconfopts="$_Fconfopts" ## wt..
        Fsplit "${subpkgs[0]}" /\* ## everything else ignored only first one

	Fcd
	Fbuild --enable-float
	Fexec make clean || Fdie
        Fbuild
	Fexec make clean || Fdie
        Fbuild --enable-long-double

        Fln fftw3.h /usr/include/fftw.h
        Fln fftw3.f /usr/include/fftw.f
}

# optimization OK
