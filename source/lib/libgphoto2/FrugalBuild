# Compiling Time: 1.39 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=libgphoto2
pkgver=2.4.0
pkgrel=1
pkgdesc="A portable library to gives access to many digital cameras"
url="http://www.gphoto.org"
groups=('lib')
archs=('i686' 'x86_64')
depends=('libtool' 'libexif' 'hal' 'e2fsprogs' 'avahi-compat' 'libjpeg')
_F_sourceforge_dirname=gphoto
_F_sourceforge_ext=".tar.bz2"
_F_sourceforge_broken_up2date=1
Finclude sourceforge
sha1sums=('cad25aa281e0749e7f1c83a3715b421f98b0981f')

build() {
	UDEV_RULES="${Fdestdir}/etc/udev/rules.d/40-${pkgname}.rules"
	HAL_FDI="${Fdestdir}/usr/share/hal/fdi/information/20thirdparty/10-camera-libgphoto2.fdi"

	Fmake udevscriptdir=/lib/udev
	Fmakeinstall udevscriptdir=/lib/udev

	# udev rules
	Fmkdir /etc/udev/rules.d
	LD_LIBRARY_PATH="${Fdestdir}/usr/lib" \
	CAMLIBS="${Fdestdir}/usr/lib/libgphoto2/${pkgver}" \
	${Fdestdir}/usr/lib/libgphoto2/print-camera-list udev-rules group camera mode 0660 > ${UDEV_RULES}

	# hal fdi
	Fmkdir /usr/share/hal/fdi/information/20thirdparty
	LD_LIBRARY_PATH="${Fdestdir}/usr/lib" \
	CAMLIBS="${Fdestdir}/usr/lib/libgphoto2/${pkgver}" \
	${Fdestdir}/usr/lib/libgphoto2/print-camera-list hal-fdi > ${HAL_FDI}
}

# optimization OK
