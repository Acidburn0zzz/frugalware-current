# Compiling Time: 1.39 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=libgphoto2
pkgver=2.2.1
pkgrel=5
pkgdesc="A portable library to gives access to many digital cameras"
url="http://www.gphoto.org"
groups=('lib')
archs=('i686' 'x86_64')
makedepends=('libgphoto2')
depends=('libjpeg' 'hal' 'libexif' 'avahi-compat' 'libtool')
_F_sourceforge_dirname=gphoto
_F_sourceforge_ext=".tar.bz2"
_F_sourceforge_broken_up2date=1
Finclude sourceforge
source=(${source[@]} libgphoto2-2.2.x-includes.patch \
	libgphoto2-$pkgver-newdbus-fix.patch)
sha1sums=('cca8ae4c4702444c899a1ab3b88003170f7ccb82' \
	  'f4b6ce1ac65c12fdfb81945faaa6c108a13aa5e6' \
	  'c2a0fe03f34fe4b268aaee8d95dd460e3a289ce8')

build() {
	UDEV_RULES="$Fdestdir/etc/udev/rules.d/70-$pkgname.rules"
	HAL_FDI="$Fdestdir/usr/share/hal/fdi/information/10freedesktop/10-camera-libgphoto2.fdi"

	Fbuild

	# udev rules
	Fmkdir /etc/udev/rules.d
	$Fdestdir/usr/lib/libgphoto2/print-camera-list udev-rules > ${UDEV_RULES}
	sed -e 's/\(.*\)RUN.*/\1GROUP="camera", MODE="0660"/' -i ${UDEV_RULES}

	# hal fdi
	Fmkdir /usr/share/hal/fdi/information/10freedesktop
	$Fdestdir/usr/lib/libgphoto2/print-camera-list udev-rules > ${HAL_FDI}
}

# optimization OK
