# Compiling Time: 1.39 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=libgphoto2
pkgver=2.3.1
pkgrel=2
pkgdesc="A portable library to gives access to many digital cameras"
url="http://www.gphoto.org"
groups=('lib')
archs=('i686' 'x86_64')
makedepends=('libgphoto2>=2.3.0' 'popt')
depends=('libjpeg' 'hal' 'dbus' 'e2fsprogs' 'libexif' 'avahi-compat' 'avahi' 'libtool')
_F_sourceforge_dirname=gphoto
_F_sourceforge_ext=".tar.bz2"
_F_sourceforge_broken_up2date=1
Finclude sourceforge

build() {
	UDEV_RULES="$Fdestdir/etc/udev/rules.d/70-$pkgname.rules"
	HAL_FDI="$Fdestdir/usr/share/hal/fdi/information/10freedesktop/10-camera-libgphoto2.fdi"

	Fmake udevscriptdir=/lib/udev
	Fmakeinstall udevscriptdir=/lib/udev

	# udev rules
	Fmkdir /etc/udev/rules.d
	$Fdestdir/usr/lib/libgphoto2/print-camera-list udev-rules-0.98 > ${UDEV_RULES}
	sed -e 's/\(.*\)RUN.*/\1GROUP="camera", MODE="0660"/' -i ${UDEV_RULES}

	# hal fdi
	Fmkdir /usr/share/hal/fdi/information/10freedesktop
	$Fdestdir/usr/lib/libgphoto2/print-camera-list udev-rules > ${HAL_FDI}
}
sha1sums=('13cc3f05ee298b33cd03ba4b772ef05a3aa49b97')

# optimization OK
