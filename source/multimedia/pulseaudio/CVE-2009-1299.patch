diff -uNrp pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478~/configure.ac pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478/configure.ac
--- pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478~/configure.ac	2010-01-17 15:54:19.000000000 -0800
+++ pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478/configure.ac	2010-03-02 21:19:12.163057106 -0800
@@ -424,7 +424,7 @@ AC_CHECK_FUNCS_ONCE([lrintf strtof])
 AC_FUNC_FORK
 AC_FUNC_GETGROUPS
 AC_FUNC_SELECT_ARGTYPES
-AC_CHECK_FUNCS_ONCE([chmod chown clock_gettime getaddrinfo getgrgid_r getgrnam_r \
+AC_CHECK_FUNCS_ONCE([chmod chown fstat fchown fchmod clock_gettime getaddrinfo getgrgid_r getgrnam_r \
     getpwnam_r getpwuid_r gettimeofday getuid inet_ntop inet_pton mlock nanosleep \
     pipe posix_fadvise posix_madvise posix_memalign setpgid setsid shm_open \
     sigaction sleep sysconf pthread_setaffinity_np])
diff -uNrp pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478~/src/pulsecore/core-util.c pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478/src/pulsecore/core-util.c
--- pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478~/src/pulsecore/core-util.c	2010-01-17 15:54:20.000000000 -0800
+++ pulseaudio-0.9.22~0.9.21+stable-queue-32-g8478/src/pulsecore/core-util.c	2010-03-02 21:18:19.573062096 -0800
@@ -214,16 +214,37 @@ int pa_make_secure_dir(const char* dir, 
     if (r < 0 && errno != EEXIST)
         return -1;
 
-#ifdef HAVE_CHOWN
+#ifdef HAVE_FSTAT
+    int fd = open(dir, O_RDONLY);
+    
+    if (fd < 0)
+      goto fail;
+
+    if (fstat(fd, &st) < 0) {
+      close(fd);
+      goto fail;
+    }
+
+    if(!S_ISDIR(st.st_mode)) {
+      close(fd);
+      errno = EACCES;
+      goto fail;
+    }
+
+#ifdef HAVE_FCHOWN
     if (uid == (uid_t)-1)
         uid = getuid();
     if (gid == (gid_t)-1)
         gid = getgid();
-    (void) chown(dir, uid, gid);
+    (void) fchown(fd, uid, gid);
+#endif
+
+#ifdef HAVE_FCHMOD
+    fchmod(fd, m);
 #endif
 
-#ifdef HAVE_CHMOD
-    chmod(dir, m);
+    close(fd);
+
 #endif
 
 #ifdef HAVE_LSTAT
