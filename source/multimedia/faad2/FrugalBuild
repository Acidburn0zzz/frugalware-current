# Compiling Time: 0.76 SBU
# Maintainer: crazy <crazy@frugalware.org>
# Contributor: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=faad2
pkgver=2.0
pkgrel=5
pkgdesc="ISO AAC audio decoder"
url="http://www.audiocoding.com/"
depends=('libstdc++')
groups=('multimedia')
archs=('i686' 'x86_64')
conflicts=('mpeg4ip')
makedepends=('libsndfile' 'id3lib')
up2date="lynx -dump 'http://sourceforge.net/project/showfiles.php?group_id=704'|grep -m1 'faad2-\(.*\).tar.gz'|sed 's/.*2-\(.*\).tar.gz .*/\1/'"
source=(http://heanet.dl.sourceforge.net/sourceforge/faac/$pkgname-$pkgver.tar.gz \
	$pkgname-makefile.patch faad2-2.0-amd64.patch faad2-2.0-gcc{34,4}.patch)
sha1sums=('fc9f8d0812a9f46bbd851880045131e0e4ab08b8' \
          '2f5dccc9b0667477770cd4c4c5953ee695048660' \
          'c0e7c817365bd7d7c071472cd4274724b7322bfb' \
          'cb40a5a2c669864ed31d3824692dc3802a4f5e9d' \
          '429cb9086d8a1305a1fd6bdec1ab8906bd65b7da')

build()
{
	Fcd $pkgname
	## for all archs()
	export CXXFLAGS="${CXXFLAGS} -fno-strict-aliasing"
	Fpatch $pkgname-makefile.patch
	Fpatch faad2-2.0-gcc34.patch
	Fpatch faad2-2.0-gcc4.patch
	if [ "$CARCH" == "x86_64" ]; then
	  Fpatch faad2-2.0-amd64.patch
	fi
	chmod +x bootstrap || Fdie
	./bootstrap || Fdie
	## need be fixed
	Fmake --with-mp4v2
	Fmakeinstall
}


# optimization OK
