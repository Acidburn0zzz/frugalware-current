# Last Modified: Tue, 23 Aug 2005 16:07:33 +0200
# Compiling Time: 0.71 SBU
# Maintainer: voroskoi <voroskoi@freemail.hu>

pkgname=ffmpeg
pkgver=20050806
pkgrel=2
pkgdesc="FFMpeg is a complete and free Internet live audio and vide  broadcasting solution for Linux/Unix"
url="http://ffmpeg.sourceforge.net/"
depends=('a52dec' 'freetype2' 'lame' 'faac' 'libvorbis' 'libdc1394' \
	 'xvidcore' 'libtheora')
groups=('multimedia')
archs=('i686' 'x86_64')
up2date="lynx -dump http://sourceforge.net/project/showfiles.php?group_id=16082  |grep ffmpeg.*tar |sed -n -e 's/.*g-\(.*\)\.t.*/\1/;s/-/_/;s/0.4.9_pre1/20050806/;1 p'"
source=(http://www2.mplayerhq.hu/MPlayer/cvs/`echo $pkgname | sed 's/ffm/FFM/'`-$pkgver.tar.bz2 \
	ffmpeg-0.4.9-pre1-misc-fixes.patch ffmpeg-config.patch)
sha1sums=('fa758c9bf6c59eb8a42e30c35b4d16d0c0aedc5d' \
	  '01558bef688fc72587911805eda350742d5c2fb0' \
	  '2d55fb081b7b9e3be5912da36b8eda463ebab85a')

[ "$CHROOT" = "1" ] || \
	{
		error "You must build $pkgname in a chroot environment!"
		Fdie
	}

build()
{
	Fcd `echo $pkgname | sed 's/ffm/FFM/'`-$pkgver
	Fmkdir usr/bin
	Fpatch ffmpeg-0.4.9-pre1-misc-fixes.patch
	Fpatch ffmpeg-config.patch
	Fsed "@VERSION@" "$pkgver" ffmpeg-config.in

	Fmake --enable-gpl \
		--enable-mp3lame \
		--enable-vorbis \
		--enable-pp \
		--enable-faac \
		--enable-faad \
		--enable-a52 \
		--enable-shared \
		--enable-pthreads \
		--enable-libogg \
		--enable-theora \
		--enable-xvid \
		--enable-a52 \
		--enable-shared-pp \
		--enable-shared
	
	Fmakeinstall prefix=$Fdestdir/usr \
		     bindir=$Fdestdir/usr/bin \
		     libdir=$Fdestdir/usr/lib \
		     mandir=$Fdestdir/usr/man\
		     SHARED_PP="yes"
	Fexerel ffmpeg-config.in /usr/bin/ffmpeg-config
	Ffilerel /usr/share/man/man1/ffmpeg-config.1
}

# vim: ft=sh

# optimalization OK
