# Compiling Time: 1.87 SBU
# Maintainer: Devil505 <devil505linux@gmail.com>

pkgname=google-gadgets
pkgver=0.11.2
pkgrel=4
pkgdesc="Google Gadgets for Linux"
depends=('libstdc++' 'libxml2' 'libxau' 'libxdmcp' 'libtool' 'libxdamage' \
	'xulrunner' 'nspr' 'libxft' 'libxt' 'libice' 'gst-plugins-base' 'curl>=7.19.0' \
	'dbus' 'libsoup' 'startup-notification' 'webkit')
#optional depend: network-manager, we'll see later
options=('scriptlet')
_F_googlecode_ext=".tar.bz2"
_F_googlecode_name="google-gadgets-for-linux"
Finclude googlecode
_F_gnome_iconcache="y"
Finclude gnome-scriptlet
groups=('xapps')
archs=('i686' 'x86_64' 'ppc')
Fconfopts="${Fconfopts[@]} --disable-werror \
		--with-oem-brand=Frugalware \
		--with-ssl-ca-file=/etc/ssl/certs/ca-certificates.crt \
		--with-browser-plugins-dir=/usr/lib/mozilla/plugins"
_F_cd_path="$_F_googlecode_name-$pkgver"
sha1sums=('22716f5ae640c7f201012d9d75868137c23ebc79')

subpkgs=("$pkgname-gtk" "$pkgname-qt" 'libggadget' 'libggadget-gtk' 'libggadget-qt' "$pkgname-gst" "$pkgname-xul")
subdescs=('GTK+ Version of Google-Gadgets' 'Google Gadgets main library' \
	'QT4 version of Google Gadgets' 'Google Gadgets GTK+ library' \
	'Google Gadgets QT library' 'GStreamer Module for Google Gadgets' \
	'XULRunner module for Google Gadgets')
subrodepends=("$pkgname=$pkgver libggadget-gtk=$pkgver libggadget=$pkgver $pkgname-gst=$pkgver $pkgname-xul=$pkgver" \
	"$pkgname=$pkgver libggadget=$pkgver libggadget-qt=$pkgver $pkgname-gst=$pkgver" \
	"$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" \
	"$pkgname=$pkgver libggadget=$pkgver" "$pkgname=$pkgver libggadget=$pkgver")
subdepends=("" "" 'libstdc++ libxml2 libxau libxdmcp libtool libxdamage libxft libxt libice'  \
	" atk librsvg curl cairo gtk+2 pango dbus startup-notification" \
	"libqtcore libqtopengl libqtscript libqtwebkit libqtxml libqtdbus libqtnetwork"
	"gst-plugins-base" "xulrunner")
subgroups=('xapps-extra' 'xapps-extra' 'xlib' 'xlib-extra' 'xlib' 'xlib-extra' 'xlib-extra')
subarchs=('i686 x86_64 ppc' 'i686 x86_64 ppc' 'i686 x86_64 ppc' 'i686 x86_64 ppc' 'i686 x86_64 ppc' 'i686 x86_64 ppc' 'i686 x86_64 ppc')

build()
{
    Fmake
    unset MAKEFLAGS
    Fmakeinstall
    Fbuild_gnome_scriptlet

    Fsplit $pkgname-gtk usr/share/applications/ggl-gtk.desktop
    Fsplit $pkgname-gtk usr/bin/ggl-gtk

    Fsplit $pkgname-qt usr/bin/ggl-qt
    Fsplit $pkgname-qt /usr/share/applications/ggl-qt.desktop

    Fsplit libggadget-gtk usr/lib/libggadget-gtk-*
    Fsplit libggadget-gtk usr/include/google-gadgets/ggadget/gtk
    Fsplit libggadget-gtk usr/lib/pkgconfig/libggadget-gtk*.pc

    Fsplit libggadget-qt usr/lib/libggadget-qt-*
    Fsplit libggadget-qt usr/include/google-gadgets/ggadget/qt
    Fsplit libggadget-qt usr/lib/pkgconfig/libggadget-qt*.pc

    Fsplit $pkgname-gst usr/lib/google-gadgets/modules/gst-audio-framework.so
    Fsplit $pkgname-gst usr/lib/google-gadgets/modules/gst-video-element.so

    Fsplit $pkgname-xul usr/lib/google-gadgets/gtkmoz-browser-child
    Fsplit $pkgname-xul usr/lib/google-gadgets/modules/gtkmoz-browser-element.so
    Fsplit $pkgname-xul usr/lib/google-gadgets/modules/smjs-script-runtime.so

    Fsplit libggadget usr/lib/libggadget-*
    Fsplit libggadget usr/lib/pkgconfig/libggadget-*.pc
    Fsplit libggadget usr/include/google-gadgets/ggadget
    Fsplit libggadget usr/lib/google-gadgets/include/ggadget/sysdeps.h
}

# optimization OK
