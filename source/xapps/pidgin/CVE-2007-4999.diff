diff -Nur pidgin-2.2.1/libpurple/util.c pidgin-2.2.1.new/libpurple/util.c
--- pidgin-2.2.1/libpurple/util.c	2007-09-29 18:39:14.000000000 +0200
+++ pidgin-2.2.1.new/libpurple/util.c	2007-11-26 16:32:27.306345874 +0100
@@ -1566,7 +1566,7 @@
 					pt->dest_tag = "a";
 					tags = g_list_prepend(tags, pt);
 					if(xhtml)
-						g_string_append_printf(xhtml, "<a href='%s'>", g_strstrip(url->str));
+						g_string_append_printf(xhtml, "<a href='%s'>", url ? g_strstrip(url->str) : "");
 					continue;
 				}
 				if(!g_ascii_strncasecmp(c, "<font", 5) && (*(c+5) == '>' || *(c+5) == ' ')) {
