# Compiling Time: 0.06 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=j2re
pkgver=6
oldpkgver=${pkgver/5.0/1.5.0}
realver=${oldpkgver//./_}
pkgrel=2
pkgdesc="Sun's java runtime environment"
url="http://java.sun.com"
depends=('unixodbc' 'libxcb' 'libstdc++5' 'libxp' 'libxi' 'libxtst' 'libgcc' 'alsa-lib')
groups=('xapps')
archs=('i686' 'x86_64')
up2date="elinks -dump https://jdk-distros.dev.java.net/developer.html|grep 'jdk-[0-9].*bin$'|sed 's/.*jdk-\(.*\)-dlj-linux.*/\1/;q'"
if [ "$CARCH" == "i686" ]; then
	_arch="i586"
	sha1sums=('bc7a56952b362e472a0ec179e0852ca7bf0c0507')
elif [ "$CARCH" == "x86_64" ]; then
	_arch="amd64"
	sha1sums=('d51a60c80ac1a8173c53b9a389377b2774a50e92')
fi
source=(http://download.java.net/dlj/binaries/jdk-$realver-dlj-linux-$_arch.bin \
	https://jdk-distros.dev.java.net/source/browse/*checkout*/jdk-distros/trunk/utils/construct.sh \
	j2re.sh)
sha1sums=(${sha1sums[@]} '966b9c8229ef3dfb588c108124f367cc993cb581' \
	  'e5f35c95e9f93e90746e666f0f42daac019bb9e5')

build() {
	Fmkdir /usr/lib/{java,mozilla/plugins}
	mkdir $pkgname
	cd $pkgname
	sh ../jdk-$realver-dlj-linux-$_arch.bin --accept-license
	cd ..
	sh construct.sh $pkgname linux-jdk linux-jre
	Fmkdir /usr/lib/java
	mv linux-jdk/jre $Fdestdir/usr/lib/java
	Fexe /etc/profile.d/$pkgname.sh
	if [ "$CARCH" == "i686" ]; then
	    Fln /usr/lib/java/jre/plugin/i386/ns7/libjavaplugin_oji.so \
		/usr/lib/mozilla/plugins/libjavaplugin_oji.so
	fi
}

# optimization OK
