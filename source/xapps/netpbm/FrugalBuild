# Last Modified: Mon, 22 May 2006 03:58:35 +0200
# Compiling Time: 1.16 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=netpbm
pkgver=10.33
pkgrel=1
pkgdesc="A toolkit for manipulation of graphic images"
groups=('xapps')
archs=('i686' 'x86_64')
depends=('perl' 'libjpeg' 'libpng' 'libtiff')
_F_sourceforge_ext=".tgz"
Finclude sourceforge
source=(${source[@]} config)
sha1sums=('ed1023fc8b5e15db274495b860f2f80df309454e' \
	  '8e22fe49f941dc677305117eb12e3b082687edea')

build()
{
	unset MAKEFLAGS
	Fcd
	cp $Fsrcdir/config Makefile.config
	[ "$CARCH" == "i686" ] && (sed -i "s/^\(CFLAGS =\) .*/\1 $CFLAGS/" Makefile.config)
	[ "$CARCH" == "x86_64" ] && (sed -i "s/^\(CFLAGS =\) .*/\1 $CFLAGS -fPIC/" Makefile.config)
#	[ "$CARCH" == "x86_64" ] && (sed -i "s/^\(CFLAGS_SHLIB =\) .*/\1 -fPIC/" Makefile.config)
	sed -i 's/\(.*\$(SYMLINK) \)\(pnmtopnm\)\(\$(EXE) \)\(pamtopnm\)/\1\4\3\2/' converter/other/Makefile

	make || Fdie
	
	make package pkgdir=$Fdestdir/usr || Fdie
	Frm /usr/{link,README,pkginfo,misc,VERSION,config_template}
}

# optimization OK

