# Last Modified: Tue Aug 10 10:50:28 CEST 2004
# Compiling Time: ~16 minutes
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=mplayer
pkgver=1.0pre5
pkgrel=4
pkgdesc="The Movie Player"
depends=('zlib' 'libjpeg' 'libpng' 'libungif' 'gtk+' 'libvorbis' \
         'cdparanoia' 'codecs' 'sdl' 'audiofile' 'lame')
install=$pkgname.install
up2date=`lynx -dump http://www.mplayerhq.hu/homepage/design7/dload.html|grep 'MPlayer v'|sed -n -e 's/.*MPlayer v\(.*\) source.*/\1/'  -e '1 p'`
source=(http://www.mplayerhq.hu/MPlayer/releases/MPlayer-$pkgver.tar.bz2 \
	http://www.mplayerhq.hu/MPlayer/Skin/Blue-1.1.tar.bz2 \
	http://www.mplayerhq.hu/MPlayer/releases/fonts/font-arial-cp1250.tar.bz2 \
	http://www.mplayerhq.hu/MPlayer/releases/fonts/font-arial-iso-8859-1.tar.bz2 \
	http://www.mplayerhq.hu/MPlayer/releases/fonts/font-arial-iso-8859-2.tar.bz2 \
	http://www.mplayerhq.hu/MPlayer/releases/fonts/font-arial-iso-8859-7.tar.bz2 \
	MPlayerIcons.tar.gz)
md5sums=('fbe6919eb025526e8ed129cd61a49969' '83a9dd5753cbc0484e7e494699fecd52' \
         'd0afd83cd04c29a714a62b427aace5c5' '1ecd31d17b51f16332b1fcc7da36b312' \
	 '7b47904a925cf58ea546ca15f3df160c' '956a9d9ea51970e057f0deb7b2e25889' \
	 '3d295a75b473684f50c3d758b1284c82')

build() {
  cd $startdir/src/MPlayer-$pkgver
  ./configure --prefix=/usr --enable-gui --language=all \
              --enable-runtime-cpudetection --disable-arts

  make || return 1

  make DESTDIR=$startdir/pkg install

  # docs  
  mv $startdir/src/MPlayer-$pkgver/DOCS $startdir/pkg/usr/share/mplayer/
  mv $startdir/src/MPlayerIcons/opt $startdir/pkg/
  
  # skin
  mkdir -p $startdir/pkg/usr/share/mplayer/Skin
  mv $startdir/src/Blue $startdir/pkg/usr/share/mplayer/Skin/default
  chown -R root.root $startdir/pkg/usr/share/mplayer/Skin
  chmod 755 $startdir/pkg/usr/share/mplayer/Skin
  chmod 755 $startdir/pkg/usr/share/mplayer/Skin/default
  chmod 644 $startdir/pkg/usr/share/mplayer/Skin/default/*

  # fonts
  rmdir $startdir/pkg/usr/share/mplayer/font
  for i in cp1250 iso-8859-1 iso-8859-2 iso-8859-7
  do
  	mv $startdir/src/font-arial-$i/font-arial-{14,18,24,28}-$i \
  	$startdir/pkg/usr/share/mplayer/
  done
  
}
