--- libmpdemux/demux_audio.c.orig	2008-02-22 13:42:51.000000000 +0100
+++ libmpdemux/demux_audio.c	2008-02-22 13:43:13.000000000 +0100
@@ -234,6 +234,8 @@
           ptr += 4;
 
           comment = (char *) ptr;
+	  if (&comment[length] < comments || &comment[length] >= &comments[blk_len])
+		  return;
           c = comment[length];
           comment[length] = 0;
