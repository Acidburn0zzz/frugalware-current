# Compiling Time: 0.62 SBU
# Maintainer: Baste <baste@frugalware.org>
# Contributor: Melko <melko@frugalware.org>

USE_DOC=${USE_DOC:-"y"}

pkgname=ibus
pkgver=1.5.14
pkgrel=3
pkgdesc="Intelligent Input Bus."
depends=('gtk+3>=3.22.0' 'libnotify>=0.7.6-2' 'dbus>=1.10.10-4' 'libsystemd>=231-7' \
	'libffi>=3.2.1-2' 'dconf>=0.24.0-2')
makedepends=('intltool' 'iso-codes' 'gobject-introspection>=1.50.0'  'vala>=0.34.0')
groups=('xapps')
archs=('i686' 'x86_64')
_F_gnome_iconcache='y'
_F_gnome_glib="y"
_F_gnome_iconcache="y"
_F_gnome_immodules="y"
Finclude gnome gnome-scriptlet
url="https://github.com/ibus/ibus"
source=("https://github.com/ibus/ibus/releases/download/$pkgver/ibus-$pkgver.tar.gz")
up2date="lynx -dump -source https://github.com/ibus/ibus/releases | grep -m1 tar.gz | sed 's/.*us-\(.*\).t.*/\1/'"
sha1sums=('0b88a8738b2e5b39042637e6e3356dc918c90b07')
Fconfopts+=" --disable-gconf \
	--enable-dconf \
	--disable-gtk2 \
    	--enable-gtk3 \
	--disable-emoji-dict"

if Fuse $USE_DOC; then
        subpkgs=("$pkgname-docs")
        subdescs=("Ibus Documentation")
        subdepends=()
        subgroups=('docs-extra')
        subarchs=('i686 x86_64')
fi


build() {
	Fbuild
        if Fuse $USE_DOC; then
                Fsplit $pkgname-docs usr/share/gtk-doc
        fi
	Fbuild_gnome_scriptlet
}

# optimization OK
