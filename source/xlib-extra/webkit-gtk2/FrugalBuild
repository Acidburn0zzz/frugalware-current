# Compiling Time: 10.15 SBU
# Maintainer: Baste <baste@frugalware.org>

pkgname=webkit-gtk2
_F_archive_name=webkitgtk
pkgver=2.4.9
pkgrel=4
pkgdesc="GTK+ Web content engine library for GTK+ 2.0"
url="http://www.webkit.org"
depends=('enchant>=1.6.0-4' 'gst1-plugins-base>=1.9.2-2' 'gtk+2-libs>=2.24.31-2' 'libsecret>=0.18.4' 'libsoup>=2.56.0' \
	'libxslt>=1.1.28-3' 'libwebp>=0.6.0' 'libxt>=0.5.0-1' 'icu4c>=58.1')
makedepends=('ruby' 'gperf' 'x11-protos' 'gtk+2>=2.24.31-2' 'gobject-introspection>=1.50.0')
groups=('xlib-extra')
archs=('x86_64')
replaces=('webkit')
conflicts=('webkit')
source=(http://webkitgtk.org/releases/$_F_archive_name-${pkgver}.tar.xz webkitgtk-2.4.9-abs.patch)
up2date="lynx -dump -source http://webkitgtk.org/releases |grep 'webkitgtk-2.4' | sort -n -r | sed 's/.*>.*-\(.*\).tar.xz.*/\1/' | head -n1"
options=('scriptlet')
_F_gnome_glib="y"
Finclude gnome-scriptlet
Fconfopts+="	--disable-webkit2 \
		--disable-geolocation \
		--enable-introspection \
		--disable-gtk-doc-html \
		--with-gtk=2.0"

sha1sums=('fbe02db8a4f01a70e7cdf0d16f8a18463e18b104' \
          '81b98775c1a7a5944a6f1f9fe18f4c9260202bd3')

## gcc6 workaround
CXXFLAGS+=" -fno-delete-null-pointer-checks"
CFLAGS+=" -fno-delete-null-pointer-checks"

build() {
	Fcd
	Fpatchall
	Fautoreconf
	Fmake
	Fmakeinstall
	Fbuild_gnome_scriptlet
	Frm usr/share/gtk-doc
	Frm webkitdomgtk/
	Frm webkitgtk/

}

# optimization OK
