# Compiling Time: 0.69 SBU
# Contributor: crazy <crazy@frugalware.org>
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=uim
pkgver=1.8.6.gd63dadd
pkgrel=2
pkgdesc="Uim is a multilingual input method library."
depends=('libedit>=20150325_3.1-3' 'm17n-lib')
makedepends=('intltool' 'x11-protos' 'ruby' 'librsvg')
options=('scriptlet' 'force')
groups=('xlib-extra')
archs=('x86_64')
_F_github_tag=y
_F_github_devel=yes
Finclude github
Fconfopts+="    --with-qt5 --prefix=/usr"
_F_conf_configure="./make-wc.sh"

subpkgs=("$pkgname-qt" "$pkgname-gnome" "$pkgname-emacs")
subdescs=("UIM qt support." "UIM gnome support." "UIM Emacs support.")
subdepends=("qt5-base>=5.9.0-4" "gtk+3" "")
subrodepends=("$pkname" "$pkname" "$pkgname emacs")
subgroups=('xapps-extra' 'gnome-extra' 'xapps-extra')
subarchs=('x86_64' 'x86_64' 'x86_64')
subreplaces=("$pkgname-kde4" "" "")
subconflicts=("$pkgname-kde4" "" "")

build()
{
	Funpack_scm

	unset MAKEFLAGS
	export LANG=en_US.UTF-8
	export LANGUAGE=en_US.UTF-8
	export LC_ALL=en_US.UTF-8
	Fcd

	Fbuild
	Fsplit $pkgname-qt usr/bin/uim-*-qt5
	Fsplit $pkgname-qt usr/libexec/uim-candwin-qt5

	Fsplit $pkgname-gnome	usr/libexec/uim-candwin-horizontal-gtk3
	Fsplit $pkgname-gnome	usr/libexec/uim-candwin-tbl-gtk3
	Fsplit $pkgname-gnome	usr/libexec/uim-candwin-gtk3
	Fsplit $pkgname-gnome	usr/bin/uim-toolbar-gtk3
	Fsplit $pkgname-gnome	usr/bin/uim-toolbar-gtk3-systray
	Fsplit $pkgname-gnome	usr/bin/uim-input-pad-ja-gtk3
	Fsplit $pkgname-gnome	usr/bin/uim-im-switcher-gtk3

	Fsplit $pkgname-emacs usr/share/emacs

}

# optimization OK
