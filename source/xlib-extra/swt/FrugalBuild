# Compiling Time: 0.09 SBU
# Contributor: Miklos Vajna <vmiklos@frugalware.org>
# Maintainer: Marius Cirsta <mcirsta@frugalware.org>

pkgname=swt
pkgver=4.5
date=201506032000
pkgrel=1
pkgdesc="SWT is an open source widget toolkit for Java designed to provide efficient, portable access to the user-interface."
url="http://www.eclipse.org/swt"
Finclude openjava
depends=(${depends[@]} 'gtk+2>=2.16.2-2' 'atk' 'libxtst' 'libstdc++' 'freetype2' 'pango' 'cairo' 'libglu')
makedepends+=('x11-protos')
groups=('xlib-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.eclipse.org/swt/ |grep linux.*zip |sed -ne 's/.*t-\(.*\)-g.*/\1/;1p'"

if [ $CARCH = x86_64 ]; then
source=(http://download.eclipse.org/eclipse/downloads/drops4/R-$pkgver-$date/swt-${pkgver}-gtk-linux-x86_64.zip \
	build.xml)
sha1sums=('eb26c383844f38754f738c7063f15190c4ea55af' \
          '3305b8b293472591d7fb881f9084495249b929ad')
fi

if [ $CARCH = i686 ]; then
source=(http://download.eclipse.org/eclipse/downloads/drops4/R-$pkgver-$date/swt-${pkgver}-gtk-linux-x86.zip \
	build.xml)
sha1sums=('dbf5267d0cd56102efb80448433be4fe439604b2' \
          '3305b8b293472591d7fb881f9084495249b929ad')
fi


build()
{

	rm -rf *so *jar about* version*
	mkdir build
	cd build
	Fextract ../src.zip
	cp $Fsrcdir/build.xml ./
	mkdir src
	mv org src

	for i in awt swt atk glx cairo
	do
		make -f make_linux.mak make_$i || return 1
	done
	Fant compile
	cp version.txt build/version.txt
	cp src/org/eclipse/swt/internal/SWTMessages.properties build/org/eclipse/swt/internal/
	Fant jar
	Ffilerel /usr/share/java/swt.jar
	Fexerel *.so /usr/lib/
	Fdocrel about.html about_files
}

# optimization OK
