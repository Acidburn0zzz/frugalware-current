# Compiling Time: 40.04 SBU
# Maintainer: crazy <crazy@frugalware.org>

USE_DEMOS=${USE_DEMOS:-"n"}

pkgname=qt4
_F_archive_name=qt-everywhere-opensource-src
pkgver=4.6.0
pkgrel=3
## Dummy package is empty ..
pkgdesc="The QT4 GUI toolkit."
url="http://qt.nokia.com/products/"
depends=()
makedepends=('libxft' 'libjpeg' 'libxcursor' \
	'libsm' 'libpng' 'libxtst' 'fontconfig' 'cups' 'bison' \
	'flex' 'imake' 'openssl' 'linuxwacom' \
	'libxdamage' )
groups=('xlib-extra')
archs=('i686' 'x86_64' 'ppc')
options=('scriptlet' 'nodocs')
up2date="Flasttar ftp://ftp.qt.nokia.com/qt/source/"
source=(ftp://ftp.qt.nokia.com/qt/source/$_F_archive_name-$pkgver.tar.gz \
	Trolltech.conf \
	assistant4.desktop \
	assistant4-compat.desktop \
	designer4.desktop \
	linguist4.desktop \
	qdbusviewer.desktop \
	qt4config.desktop \
	qtdemo.desktop)
sha1sums=('c2cbbde83f1ebac3b8dd13a112fcad757d395041' \
          '2468fea7b127253832148115d5aa9e85b2e0aea6' \
          '70413a58f1d4b7260ab407482675b8028cea4e47' \
          'ae0a66ad4fafbaa009635a9ae286949d895046e3' \
          '957376dd30fdf1bbc2ff5545f2f808f90d44c4dc' \
          'bc6527ee1d672cc192c667aeb49540b166e96949' \
          '2099d1e1ef2172369c2b5f51e3dcf88fd66ba38c' \
          '1097be47724cda110a0d099c58a2f2ff6dcacc1e' \
          '7c47da506d5118b87a0cae775886f99fd7de4fd9')
#export QTDIR=$startdir/src/$_F_archive_name-$pkgver
#export PATH=${QTDIR}/bin:${PATH}
export LD_LIBRARY_PATH=$Fsrcdir/$_F_archive_name-$pkgver/lib:${LD_LIBRARY_PATH}
export YACC='yacc -d'

# NOTE: almost all subgroups need be moved to main .. but not yet

# To detected dependecies with makepkg -a
#makedepends=("${makedepends[@]}" "$pkgname=$pkgver")

if false; then
# Subpackage template
subpkgs=("${subpkgs[@]}" "")
subdescs=("${subdescs[@]}" '')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "")
subgroups=("${subgroups[@]}" '')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')
fi

subpkgs=("${subpkgs[@]}" "libqt3support")
subdescs=("${subdescs[@]}" 'Qt4 Qt3support Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver libqtnetwork=$pkgver libqtsql=$pkgver libqtxml=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtassistantclient")
subdescs=("${subdescs[@]}" 'Qt4 AssistantClient Library')
subdepends=("${subdepends[@]}" "libice libxrender libxext")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver libqtnetwork=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtclucene")
subdescs=("${subdescs[@]}" 'Qt4 CLucene Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtcore")
subdescs=("${subdescs[@]}" 'Qt4 Core Library')
subdepends=("${subdepends[@]}" "glib2 libstdc++ zlib")
subrodepends=("${subrodepends[@]}" "")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

Fconfopts="$Fconfopts -dbus"
subpkgs=("${subpkgs[@]}" "libqtdbus")
subdescs=("${subdescs[@]}" 'Qt4 DBus Library')
subdepends=("${subdepends[@]}" "dbus>=0.93")
subrodepends=("${subrodepends[@]}" "libqtxml=$pkgver")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" 'qt4-qdbus')
subreplaces=("${subreplaces[@]}" 'qt4-qdbus')
subprovides=("${subprovides[@]}" 'qt4-qdbus')

subpkgs=("${subpkgs[@]}" "libqtdesigner")
subdescs=("${subdescs[@]}" 'Qt4 Designer Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver libqtscript=$pkgver libqtxml=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" 'libqtdesignercomponents')
subreplaces=("${subreplaces[@]}" 'libqtdesignercomponents')
subprovides=("${subprovides[@]}" 'libqtdesignercomponents')

subpkgs=("${subpkgs[@]}" "libqtgui")
subdescs=("${subdescs[@]}" 'Qt4 Gui Library')
subdepends=("${subdepends[@]}" "libpng libmng libsm gtk+2    fontconfig libxcursor libxrandr libxi libxinerama libxt")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver libqtsvg=$pkgver")
subgroups=("${subgroups[@]}" 'xlib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqthelp")
subdescs=("${subdescs[@]}" 'Qt4 Help Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtclucene=$pkgver libqtgui=$pkgver libqtsql=$pkgver libqtxml=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtmultimedia")
subdescs=("${subdescs[@]}" 'Qt4 Multimedia Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtnetwork")
subdescs=("${subdescs[@]}" 'Qt4 Network Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtopengl")
subdescs=("${subdescs[@]}" 'Qt4 OpenGL Library')
subdepends=("${subdepends[@]}" "libgl libxrender")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver")
subgroups=("${subgroups[@]}" 'xlib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtphonon")
subdescs=("${subdescs[@]}" 'Qt4 Phonon Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtdbus=$pkgver libqtgui=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtscript")
subdescs=("${subdescs[@]}" 'Qt4 Script Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtscripttools")
subdescs=("${subdescs[@]}" 'Qt4 ScriptTools Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver libqtscript=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtsql")
subdescs=("${subdescs[@]}" 'Qt4 Sql Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtsvg")
subdescs=("${subdescs[@]}" 'Qt4 Svg Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver")
subgroups=("${subgroups[@]}" 'xlib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtuitools")
subdescs=("${subdescs[@]}" 'Qt4 UiTools Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtgui=$pkgver libqtxml=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtxml")
subdescs=("${subdescs[@]}" 'Qt4 Xml Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtxmlpatterns")
subdescs=("${subdescs[@]}" 'Qt4 XmlPatterns Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtnetwork=$pkgver")
subgroups=("${subgroups[@]}" 'lib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqttest")
subdescs=("${subdescs[@]}" 'Qt4 Unit Testing Library')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtcore=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "libqtwebkit")
subdescs=("${subdescs[@]}" 'Qt4 WebKit Library')
subdepends=("${subdepends[@]}" "sqlite3 libx11 e2fsprogs")
subrodepends=("${subrodepends[@]}" "libqtphonon=$pkgver libqtxmlpatterns=$pkgver")
subgroups=("${subgroups[@]}" 'xlib qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-assistant")
subdescs=("${subdescs[@]}" 'Qt4 Document Browser')
subdepends=("${subdepends[@]}" "libx11 glib2 libstdc++")
subrodepends=("${subrodepends[@]}" "libqthelp=$pkgver libqtnetwork=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-assistant-compat")
subdescs=("${subdescs[@]}" 'Qt4 Document Browser ( Compat )')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtdbus=$pkgver libqtgui=$pkgver libqtnetwork=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

if Fuse $USE_DEMOS; then
Fconfopts="$Fconfopts -demosdir /usr/share/doc/$pkgname/demos -examplesdir /usr/share/doc/$pkgname/examples"
subpkgs=("${subpkgs[@]}" "$pkgname-demos")
subdescs=("${subdescs[@]}" 'Qt4 Demo and Example Programs.')
subdepends=("${subdepends[@]}" "fontconfig libxdamage")
subrodepends=("${subrodepends[@]}" "libqtassistantclient=$pkgver libqtdesigner=$pkgver libqtdbus=$pkgver libqthelp=$pkgver libqtopengl=$pkgver libqtscript=$pkgver libqtuitools=$pkgver libqt3support=$pkgver libqtsvg=$pkgver libqttest=$pkgver libqtwebkit=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')
else
Fconfopts="$Fconfopts -nomake demos -nomake examples"
fi

subpkgs=("${subpkgs[@]}" "$pkgname-designer")
subdescs=("${subdescs[@]}" 'Qt4 Interface Designer')
subdepends=("${subdepends[@]}" "libpng libsm fontconfig")
subrodepends=("${subrodepends[@]}" "libqt3support=$pkgver libqtdesigner=$pkgver libqtphonon=$pkgver libqtscript=$pkgver libqtwebkit=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-linguist")
subdescs=("${subdescs[@]}" 'Qt4 Translation Tool')
subdepends=("${subdepends[@]}" "libx11")
subrodepends=("${subrodepends[@]}" "libqtnetwork=$pkgver libqtuitools=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-plugin-graphicssystems")
subdescs=("${subdescs[@]}" 'Qt4 GraphicsSystems Plugin')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtopengl=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

Fconfopts="$Fconfopts -plugin-sql-mysql"
subpkgs=("${subpkgs[@]}" "$pkgname-plugin-mysql")
subdescs=("${subdescs[@]}" 'Qt4 MySql plugin')
subdepends=("${subdepends[@]}" "libmysqlclient>=5.0.15")
makedepends=("${makedepends[@]}" 'mysql')
subrodepends=("${subrodepends[@]}" "libqtsql=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

Fconfopts="$Fconfopts -plugin-sql-odbc"
subpkgs=("${subpkgs[@]}" "$pkgname-plugin-odbc")
subdescs=("${subdescs[@]}" 'Qt4 ODBC plugin')
subdepends=("${subdepends[@]}" "unixodbc")
subrodepends=("${subrodepends[@]}" "libqtsql=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-plugin-phonon-backend")
subdescs=("${subdescs[@]}" 'Qt4 Phonon Backend(s) Plugin')
subdepends=("${subdepends[@]}" "gst-plugins-base")
subrodepends=("${subrodepends[@]}" "libqtdbus=$pkgver libqtopengl=$pkgver libqtphonon=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-plugin-psql")
subdescs=("${subdescs[@]}" 'Qt4 PSQL plugin')
subdepends=("${subdepends[@]}" "libpq>=8.2 readline")
makedepends=("${makedepends[@]}" 'postgresql')
subrodepends=("${subrodepends[@]}" "libqtsql=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-plugin-script-qtdbus")
subdescs=("${subdescs[@]}" 'Qt4 Dbus Script Plugin')
subdepends=("${subdepends[@]}" "")
subrodepends=("${subrodepends[@]}" "libqtdbus=$pkgver libqtgui=$pkgver libqtscript=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

Fconfopts="$Fconfopts -plugin-sql-sqlite2 -system-sqlite"
subpkgs=("${subpkgs[@]}" "$pkgname-plugin-sqlite2")
subdescs=("${subdescs[@]}" 'Qt4 SQlite2 plugin')
subdepends=("${subdepends[@]}" "sqlite2")
subrodepends=("${subrodepends[@]}" "libqtsql=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

Fconfopts="$Fconfopts -plugin-sql-sqlite -system-sqlite"
subpkgs=("${subpkgs[@]}" "$pkgname-plugin-sqlite3")
subdescs=("${subdescs[@]}" 'Qt4 SQlite3 plugin')
subdepends=("${subdepends[@]}" "sqlite3")
subrodepends=("${subrodepends[@]}" "libqtsql=$pkgver")
subgroups=("${subgroups[@]}" 'lib-extra qt4-libs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

subpkgs=("${subpkgs[@]}" "$pkgname-tools")
subdescs=("${subdescs[@]}" 'Qt4 Tools')
subdepends=("${subdepends[@]}" "glib2 libstdc++ gst-plugins-base libpng libxrandr libxinerama fontconfig e2fsprogs")
subrodepends=("${subrodepends[@]}" "libqt3support=$pkgver libqtphonon=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')
subconflicts=("${subconflicts[@]}" '')
subreplaces=("${subreplaces[@]}" '')
subprovides=("${subprovides[@]}" '')

## this is here till I've fixed all reverse depends so we not break all apps using qt4 by now
rodepends=("${subpkgs[@]}")

build()
{

	clean_junk()
	{
		## TODO: GOD! , write an patch for this and send upstream ...
		find $Fdestdir/usr/lib -type f -name '*prl' -print -exec sed -i -e "/^QMAKE_PRL_BUILD_DIR/d" {} \;
		if [ -d "$Fdestdir/usr/lib/pkgconfig" ]; then
			Fsed "-L$startdir/src/$_F_archive_name-$pkgver/lib" "-L/usr/lib" $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "$startdir/src/$_F_archive_name-$pkgver/bin/moc" "/usr/bin/moc" $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "$startdir/src/$_F_archive_name-$pkgver/bin/uic" "/usr/bin/uic" $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "-pthread" "" $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "-L/usr/X11R6/lib64" "" $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "-L/usr/lib" "" $Fdestdir/usr/lib/pkgconfig/*.pc
		        Fsed "Libs.private:" "Libs.private: -L/usr/lib -pthread" $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "   " "  " $Fdestdir/usr/lib/pkgconfig/*.pc
			Fsed "    " "  " $Fdestdir/usr/lib/pkgconfig/*.pc
		fi
		if ls "$Fdestdir"/usr/lib/*.prl 2>/dev/null 1>/dev/null; then
			Fsed "-L$startdir/src/$_F_archive_name-$pkgver/lib" "-L/usr/lib" $Fdestdir/usr/lib/*.prl
			Fsed "-pthread" "" $Fdestdir/usr/lib/*.prl
			Fsed "-L/usr/x11R6/lib64" "" $Fdestdir/usr/lib/*.prl
			Fsed "-L/usr/lib" "" $Fdestdir/usr/lib/*.prl
			Fsed "QMAKE_PRL_LIBS =" "QMAKE_PRL_LIBS = -L/usr/lib -pthread" $Fdestdir/usr/lib/*.prl
			Fsed "   " "  " $Fdestdir/usr/lib/*.prl
			Fsed "    " "  " $Fdestdir/usr/lib/*.prl
		fi
		if ls "$Fdestdir"/usr/lib/*.la 2>/dev/null 1>/dev/null; then
			Fsed "-L$startdir/src/$_F_archive_name-$pkgver/lib" "-L/usr/lib" $Fdestdir/usr/lib/*.la
			Fsed "-pthread" "" $Fdestdir/usr/lib/*.la
			Fsed "-L/usr/x11R6/lib64" "" $Fdestdir/usr/lib/*.la
		fi
	}

	do_split()
	{
		do_install "$1"
#		clean_junk
		Fsplit "$2" /usr
	}

	do_libincdirsplit()
	{
		local pkgname="$1" incdirpath="$2"

		# FIXME: can be improved, these are exact copy, and can be Fln to reduce memory
		for include in $Fdestdir/$incdirpath/*; do
			include="usr/include/Qt/$(basename $include)"
			if [ -e "$Fdestdir/$include" ]; then
#				Fmessage "Splitable $include"
				Fsplit $pkgname $include
			fi
		done
		Fsplit $pkgname $incdirpath
	}

	do_libsplit()
	{
		local pkgname="lib${1,,}"

#		Frm usr/include/Qt/*_{mac}.h
#		Frm usr/include/$1/*_{mac}.h

		Fsplit $pkgname "usr/lib/lib$1.*"
		Fsplit $pkgname "usr/lib/pkgconfig/$1.*"
		do_libincdirsplit $pkgname usr/include/$1
	}

	Fcd
	Fpatchall
#	Fsed "DUMMY" "${CFLAGS} -fno-strict-aliasing -Wno-deprecated" mkspecs/common/g++.conf
#	rm -rf $Fsrcdir/$_F_archive_name-$pkgver/{patches,apply_patches} | Fdie
#	mv $Fsrcdir/{patches,apply_patches} $Fsrcdir/$_F_archive_name-$pkgver || Fdie
	## compiler errors / broken patches
#	rm -fv patches/{0226-*,0242-*,0250-*,0251-*} || Fdie
#	chmod +x apply_patches || Fdie
	#./apply_patches || Fdie
	Fexec ./configure $Fconfopts \
		-v -confirm-license -opensource \
		-prefix /usr \
		-datadir /usr/share/$pkgname \
		-docdir /usr/share/doc/$pkgname \
		-libdir /usr/lib \
		-plugindir /usr/lib/$pkgname/plugins \
		-sysconfdir /etc/$pkgname \
		-translationdir /usr/share/$pkgname/translations \
		-fast -reduce-relocations -no-separate-debug-info \
		-shared -nis -stl -pch -sm \
		-qt-gif -system-libpng -system-libjpeg -system-libmng -system-libtiff \
		-system-zlib \
		-cups -glib -gtkstyle -opengl -phonon -phonon-backend -webkit || Fdie

	make || Fdie
	make INSTALL_ROOT=$Fdestdir install || Fdie

	Fmkdir /etc/qt4/
	Ffilerel $Fsrcdir/Trolltech.conf /etc/$pkgname/
	Fmkdir /usr/share/applications/
	Ffilerel $Fsrcdir/{assistant4{,-compat},designer4,linguist4,qdbusviewer,qt4config,qtdemo}.desktop /usr/share/applications/

#	cp -a ../assistant4.desktop $Fdestdir/usr/share/applications/ || Fdie
#	cp -a ../assistant4-compat.desktop $Fdestdir/usr/share/applications/ || Fdie
#	cp -a tools/assistant/compat/images/assistant-128.png $Fdestdir/usr/share/pixmaps/assistant.png || Fdie
#	cp -a tools/assistant/compat/images/assistant-128.png $Fdestdir/usr/share/pixmaps/assistant-compat.png || Fdie

	## delete things we don't want / need
	Frm /usr/include/Qt{,Core}/{qatomic,qfunctions}_{macosx,symbian,vxworks,windows,windowsce}.h
	Frm /usr/share/$pkgname/mkspecs/{,common/,feature/}{aix*,*bsd*,cygwin*,darwin*,hpux*,hurd*,irix*,mac*,sco*,solaris*,symbian*,tru64*,unixware*,vxworks*,win32*,wince*}
	Frm /usr/share/$pkgname/mkspecs/linux-{ecc*,icc*,kcc*,lsb*,pgcc,cxx*}
#	Frm /usr/share/$pkgname/mkspecs/default\*
	Frm /usr/share/$pkgname/mkspecs/unsupported
#	Fln linux-g++ /usr/share/$pkgname/mkspecs/default

	# Early splits.
	Fsplit libqthelp /usr/share/$pkgname/translations/qt_help_\*.qm
	Fsplit $pkgname-assistant-compat /usr/share/$pkgname/translations/assistant_adp_\*.qm
	Fsplit $pkgname-tools "/usr/bin/qdbusviewer"

	# Main splits.
	do_libsplit Qt3Support
	Fsplit libqt3support /usr/bin/{qt3to4,uic3}
	Fsplit libqt3support /usr/lib/$pkgname/plugins/accessible/libqtaccessiblecompatwidgets.so
	Fsplit libqt3support /usr/lib/$pkgname/plugins/designer/libqt3supportwidgets.so
	Fsplit libqt3support /usr/share/$pkgname/q3porting.xml

	do_libincdirsplit libqtassistantclient /usr/include/QtAssistant
	Fsplit libqtassistantclient /usr/lib/libQtAssistantClient.\*
	Fsplit libqtassistantclient /usr/lib/pkgconfig/QtAssistantClient.\*

	Fsplit libqtclucene /usr/lib/libQtCLucene.\*
	Fsplit libqtclucene /usr/lib/pkgconfig/QtCLucene.\*
#	do_libincdirsplit libqtclucene usr/include/CLucene*

#	do_libsplit QtCrypto

	do_libsplit QtCore
	Fsplit libqtcore /etc/$pkgname
	Fsplit libqtcore /usr/bin/{moc,qmake,rcc,uic}
	Fsplit libqtcore /usr/lib/$pkgname/plugins/codecs
	Fsplit libqtcore /usr/share/$pkgname/mkspecs
	Fsplit libqtcore /usr/share/$pkgname/translations/qt_\*.qm

	do_libsplit QtDBus
	Fsplit libqtdbus /usr/bin/qdbus\*

	do_libsplit QtDesigner
	Fsplit libqtdesigner /usr/lib/libQtDesignerComponents.\*
	Fsplit libqtdesigner /usr/lib/pkgconfig/QtDesignerComponents.\*

	do_libsplit QtGui

	do_libsplit QtHelp

	do_libsplit QtMultimedia

	do_libsplit QtNetwork

	do_libsplit QtOpenGL

	do_libincdirsplit libqtphonon /usr/include/phonon
	Fsplit libqtphonon /usr/lib/libphonon.\*
	Fsplit libqtphonon /usr/lib/pkgconfig/phonon.\*
	Fsplit libqtphonon /usr/lib/qt4/plugins/designer/libphononwidgets.so

	do_libsplit QtScript

	do_libsplit QtScriptTools

	do_libsplit QtSql

	do_libsplit QtSvg
	Fsplit libqtsvg /usr/lib/$pkgname/plugins/iconengines/libqsvgicon.so
	Fsplit libqtsvg /usr/lib/$pkgname/plugins/imageformats/libqsvg.so

	do_libsplit QtTest

	do_libsplit QtUiTools

	do_libsplit QtWebKit
	Fsplit libqtwebkit /usr/lib/qt4/plugins/designer/libqwebview.so

	do_libsplit QtXml

	do_libsplit QtXmlPatterns
	Fsplit libqtxmlpatterns /usr/bin/xmlpatterns\*

	Fsplit $pkgname-assistant /usr/bin/{assistant,qcollectiongenerator,qhelpconverter,qhelpgenerator}
	Fsplit $pkgname-assistant /usr/share/applications/assistant4.desktop
	Fsplit $pkgname-assistant /usr/share/$pkgname/translations/assistant_\*.qm

	Fsplit $pkgname-assistant-compat /usr/bin/assistant_adp
	Fsplit $pkgname-assistant-compat /usr/share/applications/assistant4-compat.desktop
#	Fsplit $pkgname-assistant-compat /usr/share/pixmaps/assistant-compat.png

	if Fuse $USE_DEMOS; then
	Fsplit $pkgname-demos /usr/bin/qtdemo
	Fsplit $pkgname-demos /usr/lib/$pkgname/plugins/designer/{libarthurplugin,libcontainerextension,libcustomwidgetplugin,libtaskmenuextension,libworldtimeclockplugin}.so
	Fsplit $pkgname-demos /usr/share/applications/qtdemo.desktop
	Fsplit $pkgname-demos /usr/share/doc/$pkgname/examples
	fi

#	Fmkdir usr/share/applications usr/share/pixmaps
#	cp -a examples/widgets/icons/images/designer.png $Fdestdir/usr/share/pixmaps/ || Fdie

#	## broken at the moment , fix it
#	Fsed "include/QtDesignerComponents" "include/QtDesigner" $Fdestdir/usr/lib/pkgconfig/QtDesignerComponents.pc || Fdie

	Fsplit $pkgname-designer /usr/bin/designer
	Fsplit $pkgname-designer /usr/share/applications/designer4.desktop
	Fsplit $pkgname-designer /usr/share/$pkgname/translations/designer_\*.qm

#	Fmkdir usr/share/applications usr/share/pixmaps
#	cp -a ../linguist4.desktop $Fdestdir/usr/share/applications/ || Fdie
#	cp -a tools/linguist/linguist/images/icons/linguist-128-32.png \
#		$Fdestdir/usr/share/pixmaps/linguist.png || Fdie
	Fsplit $pkgname-linguist /usr/bin/{lconvert,linguist,lrelease,lupdate}
	Fsplit $pkgname-linguist /usr/share/applications/linguist4.desktop
	Fsplit $pkgname-linguist /usr/share/$pkgname/phrasebooks/
	Fsplit $pkgname-linguist /usr/share/$pkgname/translations/linguist_\*.qm

	Fsplit $pkgname-plugin-graphicssystems /usr/lib/$pkgname/plugins/graphicssystems/libqglgraphicssystem.so

	Fsplit $pkgname-plugin-mysql /usr/lib/$pkgname/plugins/sqldrivers/libqsqlmysql.so

	Fsplit $pkgname-plugin-odbc /usr/lib/$pkgname/plugins/sqldrivers/libqsqlodbc.so

	Fsplit $pkgname-plugin-phonon-backend /usr/lib/qt4/plugins/phonon_backend/libphonon_gstreamer.so

	Fsplit $pkgname-plugin-psql /usr/lib/$pkgname/plugins/sqldrivers/libqsqlpsql.so

	Fsplit $pkgname-plugin-script-qtdbus /usr/lib/$pkgname/plugins/script/libqtscriptdbus.so

	Fsplit $pkgname-plugin-sqlite2 /usr/lib/$pkgname/plugins/sqldrivers/libqsqlite2.so

	Fsplit $pkgname-plugin-sqlite3 /usr/lib/$pkgname/plugins/sqldrivers/libqsqlite.so

#	Fmkdir usr/share/applications usr/share/pixmaps
#	cp -a ../{qt4config,qdbusviewer}.desktop $Fdestdir/usr/share/applications/ || Fdie
#	cp -a doc/src/images/qt-logo.png $Fdestdir/usr/share/pixmaps/qtconfig.png || Fdie
#	cp -a tools/qdbus/qdbusviewer/images/qdbusviewer-128.png \
#		$Fdestdir/usr/share/pixmaps/qdbusviewer.png || Fdie
	Fsplit $pkgname-tools /usr/bin/\*
	Fsplit $pkgname-tools /usr/lib/$pkgname/plugins/graphicssystems/libqtracegraphicssystem.so
	Fsplit $pkgname-tools /usr/share/applications/{qt4config,qdbusviewer}.desktop
	Fsplit $pkgname-tools /usr/share/$pkgname/translations/qtconfig_\*.qm

			## License etc
#			for l in *.txt *GPL_* LICENSE*  README INSTALL
#			do
#				Fdocrel $l
#			done

#	Fmkdir usr/share/applications usr/share/pixmaps
#	cp -a doc/src/images/qt-logo.png \
#		$Fdestdir/usr/share/pixmaps/qtdemo.png || Fdie

	# Late split
	Fsplit libqtgui /usr/lib/$pkgname/plugins/{accessible,imageformats,inputmethods}/\*
#	Fsplit $pkgname-designer /usr/lib/$pkgname/plugins/designer/\*
	Fsplit $pkgname-doc /usr/share/doc/$pkgname
}

# optimization OK
