# Compiling Time: 0.02 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=slib
pkgver=3b3
pkgrel=3
pkgdesc="A library providing functions for Scheme implementations"
url="http://swissnet.ai.mit.edu/~jaffer/SLIB.html"
depends=('guile' 'texinfo')
groups=('lib-extra')
up2date="Flasttar http://groups.csail.mit.edu/mac/ftpdir/scm/"
source=(http://groups.csail.mit.edu/mac/ftpdir/scm/${pkgname}-${pkgver}.tar.gz)
archs=('i686' 'x86_64')
sha1sums=('d09c10370cd5a4b036385ce9e14c332af6894985')

build() {
	Fcd $pkgname
	sed -r -i "s,/usr/(local/)?lib/slib,/usr/share/slib,g" *.init || Fdie
	Fmkdir /usr/share/{slib,info}
	cp *.scm *.init *.xyz *.txt *.dat *.ps $Fdestdir/usr/share/slib || Fdie
	Finstallrel 644 slib.info usr/share/info/
	Fdocrel README FAQ COPYING
	Fmkdir usr/bin

        cat << _EOF > "$Fdestdir/usr/bin/slib"

#!/bin/sh
SCHEME_LIBRARY_PATH=/usr/share/slib/
export SCHEME_LIBRARY_PATH
VERSION=${pkgver}
S48_VICINITY="/usr/share/scheme48/"
export S48_VICINITY
_EOF

        cat slib.sh >> "$Fdestdir/usr/bin/slib" || Fdie
        chmod 755 "$Fdestdir/usr/bin/slib" || Fdie

        Fmanrel slib.1

        Fmkdir usr/share/guile/site/
        ln -s /usr/share/slib "$Fdestdir/usr/share/guile/site/" || Fdie
}
