# Compiling Time: 2.17 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=rblibtorrent
pkgver=0.13
pkgrel=2
pkgdesc="LibTorrent is a BitTorrent library written in C++"
_F_sourceforge_name="libtorrent"
Finclude sourceforge
url="http://www.rasterbar.com/products/libtorrent/index.html"
depends=('libboost-mt>=1.35.0' 'zlib' 'icu>=3.8' 'openssl')
makedepends=('boost>=1.35.0')
groups=('lib-extra')
archs=('i686' 'x86_64')
#source=(http://www.libtorrent.org/libtorrent-${pkgver}rc3.tar.gz)
up2date="lynx -dump http://sourceforge.net/project/showfiles.php?group_id=79942|grep -m1 '.tar.gz'|sed 's/.*rent-\(.*\).tar.gz.*/\1/'"
source=($source not-for-upstream.patch)
_F_cd_path="libtorrent-$pkgver"

## NOTE - test won't even build on chroot but that isn't the problem
##        one has to run the tests as 'root' heh.
##        So when bumping this package build on host without not-for-upstream.patch
##        comment the *pc file move , cd src/$pkgname-$pkgver && sudo make check.
##        When all is fine build in chroot with the patch again - crazy -

build()
{
	Fcd
	## -- comment out for make check on host
	rm libtorrent.pc || Fdie
	mv -vf libtorrent.pc.in rblibtorrent.pc.in || Fdie
	## ---
	Fpatchall
	Fautoreconf
 	Fmake \
		--libdir=/usr/lib/libtorrent \
		--enable-debug=no \
		--with-zlib=system \
		--with-boost-date-time=mt \
		--with-boost-filesystem=mt \
		--with-boost-thread=mt \
		--with-boost-regex=mt \
		--with-boost-program_options=mt \
		--enable-examples
	Fmakeinstall
	Fmv usr/lib/libtorrent/pkgconfig usr/lib/pkgconfig/

}
sha1sums=('010c02e350dc68263bb791bc8c37df341301e9bb' \
          '786aee595b80ca39de28481561d60013edff69a1')
# optimization OK
