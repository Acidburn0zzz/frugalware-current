# Last modified: Sat, 12 Mar 2005 17:27:37 +0100
# Compiling time: ~1 minute
# Maintainer: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=gnome-volume-manager
pkgver=1.2.0
pkgrel=1
pkgdesc="A volume manager for GNOME"
url="http://www.gnome.org/"
depends=('gnome-media' 'gthumb' 'totem')
makedepends=('intltool')
groups=('gnome' 'gnome-core')
archs=('i686')
nondevel=1
install=$pkgname.install
[ -e ../up2date.gnome ] && . ../up2date.gnome
source=(http://ftp.gnome.org/pub/gnome/sources/$pkgname/$preup2date/$pkgname-$pkgver.tar.bz2 \
	00-defaults.patch \
	01-browse-fixup.patch \
	02-mount-at-start.patch \
	03-dbus-reconnect-on-bus-exit.patch \
	04-do-not-set-capabilities.patch \
	05-specify-programs.patch \
	06-improve-mounting.patch \
	07-track-cdrom-changes.patch \
	08-compiler-warnings.patch \
	$pkgname-gthumb
	$pkgname.install)
md5sums=('115433f785e854c36988dda31c8af8ee' \
	'f7259c41031cd60536312b1979342126' \
	'07d221a35f5fca1a2d6eb3f439eb2bcc' \
	'b9fa6ef85bfb8d9570ac459286018db8' \
	'e94ff18345bade8b1bf091131771f7ed' \
	'139de993490d19c8764aaadf61998b48' \
	'8aa46e341980549542f75ecd0444ebf0' \
	'b84332897ec0e4bebda52d2279ee5bd3' \
	'992d6df0701afb1913fb31fe7d43e6fc' \
	'd1b98c9a891e8d713fa5d65f164f4354' \
	'cf2b186d15ce42e75383e4dd0f49bef2' \
	'a0ca7f0b4b26e5d82213f8ad40953f0f')

build() {
	cd $startdir/src/$pkgname-$pkgver
	patch -p1 < $startdir/src/00-defaults.patch || return 1
	patch -p1 < $startdir/src/01-browse-fixup.patch || return 1
	patch -p1 < $startdir/src/02-mount-at-start.patch || return 1
	patch -p1 < $startdir/src/03-dbus-reconnect-on-bus-exit.patch || return 1
	patch -p1 < $startdir/src/04-do-not-set-capabilities.patch || return 1
	patch -p1 < $startdir/src/05-specify-programs.patch || return 1
	patch -p1 < $startdir/src/06-improve-mounting.patch || return 1
	patch -p1 < $startdir/src/07-track-cdrom-changes.patch || return 1
	patch -p1 < $startdir/src/08-compiler-warnings.patch || return 1
	./configure --prefix=/usr --sysconfdir=/etc --disable-schemas-install \
		--with-mount-program="/usr/bin/pmount-hal %h -e" \
		--with-umount-program="/usr/bin/pumount %d" \
		--with-nautilus="/usr/bin/nautilus"

	make || return 1

	make GCONF_DISABLE_SCHEMA_INSTALL=1 DESTDIR=$startdir/pkg install
	install -D -m755 -o root -g root $startdir/src/$pkgname-gthumb \
		$startdir/pkg/usr/bin/$pkgname-gthumb
}

# vim: ft=sh
