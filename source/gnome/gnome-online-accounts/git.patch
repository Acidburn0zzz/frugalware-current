From f34402427e2a8c93377ce77f4c53cc3ab3f49035 Mon Sep 17 00:00:00 2001
From: Debarshi Ray <debarshir@gnome.org>
Date: Mon, 22 Apr 2013 18:19:39 +0200
Subject: [PATCH] Use SoupProxyResolverDefault with GoaEwsClient and
 GoaHttpClient

Fixes: https://bugzilla.gnome.org/698178
---
 src/goabackend/goaewsclient.c  | 1 +
 src/goabackend/goahttpclient.c | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/src/goabackend/goaewsclient.c b/src/goabackend/goaewsclient.c
index f195b1c..9ef34d2 100644
--- src/goabackend/goaewsclient.c
+++ src/goabackend/goaewsclient.c
@@ -474,6 +474,7 @@ goa_ews_client_autodiscover (GoaEwsClient        *client,
                                                        SOUP_SESSION_USE_NTLM, TRUE,
                                                        SOUP_SESSION_USE_THREAD_CONTEXT, TRUE,
                                                        NULL);
+  soup_session_add_feature_by_type (data->session, SOUP_TYPE_PROXY_RESOLVER_DEFAULT);
   data->accept_ssl_errors = accept_ssl_errors;
 
   if (cancellable != NULL)
diff --git a/src/goabackend/goahttpclient.c b/src/goabackend/goahttpclient.c
index c98f56c..8dee27f 100644
--- src/goabackend/goahttpclient.c
+++ src/goabackend/goahttpclient.c
@@ -231,6 +231,9 @@ goa_http_client_check (GoaHttpClient       *client,
                                                        SOUP_SESSION_SSL_STRICT, FALSE,
                                                        SOUP_SESSION_USE_THREAD_CONTEXT, TRUE,
                                                        NULL);
+
+  soup_session_add_feature_by_type (data->session, SOUP_TYPE_PROXY_RESOLVER_DEFAULT);
+
   logger = soup_logger_new (SOUP_LOGGER_LOG_BODY, -1);
   soup_logger_set_printer (logger, http_client_log_printer, NULL, NULL);
   soup_session_add_feature (data->session, SOUP_SESSION_FEATURE (logger));
-- 
1.8.2

