# Compiling time: 0.58 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=gdm
pkgver=2.18.3
pkgrel=3
pkgdesc="GNOME Display Manager"
url="http://www.gnome.org/"
backup=(etc/gdm/custom.conf)
depends=('zenity>=2.18.0' 'libgnomeui>=2.18.0' 'libxi' 'fontconfig' 'libxrandr' 'librsvg>=2.16.0' \
	 'libxinerama' 'libxcursor' 'libxevie' 'xorg-server')
rodepends=('xsm' 'sessreg' 'gksu' 'xmessage')
makedepends=('intltool' 'gnome-doc-utils')
groups=('gnome' 'gnome-core')
archs=('i686' 'x86_64')
Finclude gnome
options=(${options[@]} 'force')
source=(${source[@]} $pkgname-2.15.9-gdmconf.patch \
	$pkgname-2.18.0-gksu.patch \
	gdm-2.17.6-no-X11R6.patch \
	$pkgname-2.18.1-desktop-fix-from-svn.patch \
	http://ftp.frugalware.org/pub/other/artwork/gdm-theme/GDM-Frugalware-0.6-4.tar.bz2)

build() {
	Fcd
	Fpatchall
	Fautoreconf
	find . -name Makefile.in -exec sed -i -e 's/-scrollkeeper-update.*//' {} \;
	if [ -f omf.make ]; then
		sed -i -e 's/-scrollkeeper-update.*//' omf.make
	fi
	Fmake --enable-authentication-scheme=shadow --disable-scrollkeeper --enable-ipv6 --with-x
	Fmakeinstall
	
	Fmkdir /etc/X11
	Fmv /usr/share/xsessions /etc/X11/sessions
	Frm /etc/dm

	chmod a+r $Fdestdir/var/gdm || Fdie
	chown root:root $Fdestdir/var/gdm || Fdie

	# Install our GDM theme.
	mv $Fsrcdir/Frugalware $Fdestdir/usr/share/gdm/themes/Frugalware || Fdie
}

sha1sums=('e3285fafe563a1ca1708d067478cfcd6e63acef2' \
          '6caee2c3e8ee9248a2a7293f21670a0ccda5eeb5' \
          'a702961b7851b1e7c946fc8e3fb29bd1d807a02f' \
          '82bb42ae2217465196b8de03b18efcdd832ff137' \
          '35dd60c8a715c3eb645cfa4ccbbb2c9967401d3b' \
          'b6d8125f41f81d8d966e4120ed2fd390994d8ebb')
# optimization OK
