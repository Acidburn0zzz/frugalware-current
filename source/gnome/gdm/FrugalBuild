# Last modified: Tue, 03 Oct 2006 13:52:58 +0200
# Compiling time: 0.51 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=gdm
pkgver=2.16.1
pkgrel=1
pkgdesc="GNOME Display Manager"
url="http://www.gnome.org/"
backup=(etc/gdm/custom.conf)
depends=('zenity>=2.16.1' 'libgnomeui>=2.16.0' \
		'libxi' 'fontconfig' 'libxrandr' 'librsvg>=2.16.0' 'libxinerama' \
		'libxcursor' 'libxevie')
rodepends=('xorg-server' 'xsm' 'sessreg')
makedepends=('intltool' 'gnome-doc-utils')
groups=('gnome' 'gnome-core')
archs=('i686' 'x86_64')
Finclude gnome
source=(${source[@]} $pkgname-2.15.9-gdmconf.patch \
	01-$pkgname-2.6.0.8-gksu.patch \
	http://ftp.frugalware.org/pub/other/artwork/gdm-theme/GDM-Frugalware-0.5-2.tar.bz2 \
	http://ftp.frugalware.org/pub/other/artwork/gdm-theme/GDM-Frugalware-0.5-2-list.tar.bz2)
sha1sums=('2a684d194cea825a6fc14be551d7d33e373ef55c' \
	  'a61f7c9569a2d73a5cf078e61a17cfed7d280b12' \
	  '2abed3ef1a655dec144aadc2b899f0734b853c6b' \
	  'c6047145ca87f6c82e7a1f04b7112086eec53754' \
	  'd36ca3b405b0c20bf2ac56de4324723c07de2db4')

build() {
	Fcd
	find . -name Makefile.in -exec sed -i -e 's/-scrollkeeper-update.*//' {} \;
	if [ -f omf.make ]; then
		sed -i -e 's/-scrollkeeper-update.*//' omf.make
	fi
	Fpatchall
	Fmake --prefix=/usr --sysconfdir=/etc --localstatedir=/var \
		--enable-authentication-scheme=shadow --disable-scrollkeeper --enable-ipv6
	Fmakeinstall
	
	Fmkdir /etc/X11
	Fmv /usr/share/xsessions /etc/X11/sessions
	Frm /etc/dm

	chmod a+r $Fdestdir/var/gdm || Fdie
	chown root:root $Fdestdir/var/gdm || Fdie

	# Install our GDM theme.
	mv $Fsrcdir/Frugalware $Fdestdir/usr/share/gdm/themes/Frugalware || Fdie
	mv $Fsrcdir/Frugalware-list $Fdestdir/usr/share/gdm/themes/Frugalware-list || Fdie
}

# optimization OK
