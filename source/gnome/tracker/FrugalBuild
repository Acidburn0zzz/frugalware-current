# Compiling Time: 3.66 SBU
# Maintainer: Baste <baste@frugalware.org>
# Contributor: bouleetbil <bouleetbil@frogdev.info>
# Contributor: AlexExtreme <alex@alex-smith.me.uk>

USE_NAUTILUS=${USE_NAUTILUS:-"y"}

pkgname=tracker
pkgver=1.12.0
pkgrel=2
pkgdesc="Tracker is a first class object database, extensible tag/metadata database, search tool and indexer."
depends=('dbus-glib>=>=0.108-2' 'sqlite3>=3.14.2-3' 'poppler-glib>=0.50.0' 'libvorbis>=1.3.5-5' 'libpng>=1.6.25-1' \
	'libexif>=0.6.21-3' 'gstreamer1>=1.9.2-2' 'gnome-desktop>=3.24.1' 'exempi>=2.2.2-4' 'upower>=0.99.4-2' \
	'openssl>=1.0.2-8' 'libkrb5>=1.14.4' 'libgee8>=0.20.0' 'libsecret>=0.18.5-2' 'librest>=0.8.0-4' \
	'libmediaart>=1.9.1-2' 'libcue>=2.1.0-2' 'totem-pl-parser>=3.10.7-2')
#rodepends=("libtracker")
makedepends=('intltool>=0.51.0-4' 'gobject-introspection>=1.52.1' 'krb5>=1.14.4' \
		'icu4c>=58.1' 'vala>=0.36.1' 'docbook-xsl>=1.79.1-1' 'json-glib' 'libseccomp')
groups=('gnome')
archs=("x86_64")
_F_gnome_desktop="y"
_F_gnome_iconcache="y"
_F_gnome_glib="y"
_F_gnome_ext=".tar.xz"
_F_gnome_devel="n"
Finclude gnome-scriptlet gnome
sha1sums=('b8db9181bbcfa4a26f168832d04266a260559eba')


subpkgs=("libtracker")
subdescs=("tracker lib")
subdepends=("icu4c>=58.1 libmediaart>=1.9.1-2 libcue>=2.1.0-2 libgsf>=1.14.41-2 libseccomp")
subrodepends=("")
subgroups=('gnome gnome-minimal')
subarchs=("x86_64")
subinstall=("$_F_gnome_scriptlet")

if Fuse $USE_NAUTILUS; then
	subpkgs+=("$pkgname-nautilus")
	subdescs+=("nautilus plugin tracker")
	subdepends+=("nautilus>=3.22.2")
	subrodepends+=("$pkgname")
	subgroups+=('gnome')
	subarchs+=("x86_64")
	subinstall+=('')
fi


build() {
	Fcd
	#Fpatchall
	Fbuild --disable-functional-tests --disable-static

	Fbuild_gnome_scriptlet
	if Fuse $USE_NAUTILUS; then
		Fsplit $pkgname-nautilus usr/lib/nautilus
	fi
	Fsplit libtracker usr/lib
	Fsplit libtracker usr/include
	Fsplit libtracker usr/share/dbus-1
	Fsplit libtracker usr/libexec
	Fsplit libtracker usr/share/glib-2.0
}

# optimization OK
