# Compiling Time: 0.23 SBU
# Maintainer: AlexExtreme <alex@alex-smith.me.uk>

# Do NOT bump this package without explicit permission from the maintainer, and if you do get permission,
# test it FULLY before pushing.

pkgname=tracker
pkgver=0.5.2
pkgrel=1
pkgdesc="Tracker is a first class object database, extensible tag/metadata database, search tool and indexer."
url="http://www.gnome.org/~jamiemcc/tracker/"
depends=('gtk+2' 'gmime' 'dbus-glib>=0.71-2' 'sqlite3' 'gamin' 'gnome-desktop' 'gnome-vfs' \
	 'poppler-glib' 'libvorbis' 'libpng' 'libexif' 'libgsf' 'gstreamer')
makedepends=('intltool' 'perl-xml')
groups=('gnome')
archs=('i686' 'x86_64')
# Damn these weird gnome devels - the latest version is 0.5.2, yet the website still has 0.0.4 as latest
up2date="$pkgver"
source=($url/$pkgname-$pkgver.tar.gz trackerd.desktop trackerd_wrap)
sha1sums=('4137e962aec10a447bc8bad1c52d229f54731cad' \
	  'b6f38d8e9b40c8c78019d023caa688188fff3042' \
	  '8903c4fd4e4d26edd8db9aad893dcbe34736d34e')

build() {
	unset MAKEFLAGS
	Fbuild
	
	# Trackerd should run at login
	Fmkdir /usr/share/gnome/autostart
	cp $Fsrcdir/trackerd.desktop $Fdestdir/usr/share/gnome/autostart/ || Fdie
	
	# Wrapper to make it STFU
	Fexerel $Fsrcdir/trackerd_wrap /usr/bin/trackerd_wrap
}

# optimization OK
