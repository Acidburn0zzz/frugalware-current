# Last modified: Thu, 08 Dec 2005 15:15:29 +0100
# Compiling time: 6.13 SBU
# Maintainer: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=evolution
pkgver=2.4.2.1
pkgrel=1
pkgdesc="Integrated mail, calendar and address book suite for GNOME"
url="http://www.gnome.org/projects/evolution/"
depends=('gal>=2.5.3' 'evolution-data-server>=1.4.2' 'gtkhtml>=3.8.0' 'libgtkhtml' \
	'gnome-pilot-conduits' 'gnome-spell' 'scrollkeeper' 'heimdal')
makedepends=('intltool' 'mono' 'gst-plugins')
groups=('gnome' 'gnome-core')
archs=('i686' 'x86_64')
install=$pkgname.install
Finclude gnome
source=(http://ftp.gnome.org/pub/gnome/sources/$pkgname/$preup2date/$pkgname-$pkgver.tar.bz2 \
	evolution-2.4.2-segfault.patch)
sha1sums=('b3e61e8f013ea35aa137928d1d25a91b3043357d' \
	  '1c97ced74438fd5093d0045c5b7141e86362b47f')

build() {
	Fcd
	Fpatchall
	Fsed 'VERSION_COMMENT, ""' 'VERSION_COMMENT, "Frugalware Linux Distribution"' configure.in
	autoconf || return 1
	find . -name Makefile.in -exec sed -i -e 's/-scrollkeeper-update.*//' {} \;
	if [ -f omf.make ]; then
		sed -i -e 's/-scrollkeeper-update.*//' omf.make
	fi
	Fconf --disable-schemas-install \
	--enable-pilot-conduits=yes --enable-nss=yes --enable-smime=yes \
	--with-openldap=yes --with-nspr-includes=/usr/include/nspr \
	--with-nspr-libs=/usr/lib --with-nss-includes=/usr/include/nss \
	--with-nss-libs=/usr/lib --enable-nntp=yes --enable-plugins=all \
	--enable-ipv6 --enable-mono=yes --enable-exchange=yes --enable-gtk-doc \
	--with-krb5=/usr --disable-debug
	Fsed '.*KILL_PROCESS_CMD.*' '#define KILL_PROCESS_CMD "killall"' config.h
	make || return 1

	Fmakeinstall GCONF_DISABLE_SCHEMA_INSTALL=1
}

# vim: ft=sh

# optimalization OK
