# Last modified: Fri, 17 Jun 2005 14:27:34 +0000
# Compiling time: ~19 minutes
# Maintainer: Laszlo Dvornik <dvornik@gnome.hu>

pkgname=evolution
pkgver=2.2.3
pkgrel=1
pkgdesc="Integrated mail, calendar and address book suite for GNOME"
url="http://www.gnome.org/projects/evolution/"
depends=('gal>=2.4.2' 'evolution-data-server>=1.2.2' 'gtkhtml>=3.6.2' \
	'gnome-pilot-conduits' 'gst-plugins' 'gnome-spell' 'scrollkeeper')
makedepends=('intltool')
groups=('gnome' 'gnome-core')
archs=('i686' 'x86_64')
install=$pkgname.install
[ -e ../up2date.gnome ] && . ../up2date.gnome
source=(http://ftp.gnome.org/pub/gnome/sources/$pkgname/$preup2date/$pkgname-$pkgver.tar.bz2 \
	$pkgname.install evolution-fix-wrong-pilotsdetect.patch)
md5sums=('1e01511c78b2dd0dcb8cf83521c167af' \
	'34faf29416e9e1ced002de5630a863cc' \
	'65ab76763f6451e5f12c9ffb15902dba')

build() {
	Fcd
	Fpatchall || return 1
	autoconf
	find . -name Makefile.in -exec sed -i -e 's/-scrollkeeper-update.*//' {} \;
	if [ -f omf.make ]; then
		sed -i -e 's/-scrollkeeper-update.*//' omf.make
	fi
	./configure --prefix=/usr --sysconfdir=/etc --disable-schemas-install \
	--enable-pilot-conduits=yes --enable-nss=yes --enable-smime=yes \
	--with-openldap=yes --with-nspr-includes=/usr/include/nspr \
	--with-nspr-libs=/usr/lib --with-nss-includes=/usr/include/nss \
	--with-nss-libs=/usr/lib --enable-nntp=yes || return 1

	make || return 1

	make GCONF_DISABLE_SCHEMA_INSTALL=1 DESTDIR=$startdir/pkg install
}

# vim: ft=sh
