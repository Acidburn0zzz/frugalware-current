# Last Modified: Wed, 25 May 2005 23:22:06 +0200
# Compiling Time: ~0.65 SBU
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=kernel-source
pkgver=2.6.11
bsver=3.1.4
pkgrel=6
pkgdesc="Linux kernel source"
url="http://www.kernel.org"
depends=('make' 'gcc' 'kernel-headers')
groups=('devel')
archs=('i686' 'x86_64')
install=$pkgname.install
up2date="lynx -dump $url/kdist/finger_banner |sed -n 's/.* \(.*\)\..*/\1/;1 p'"
source=(ftp://ftp.kernel.org/pub/linux/kernel/v2.6/linux-$pkgver.tar.bz2 \
	config \
	ftp://ftp.suse.com/pub/people/stepan/bootsplash/kernel/bootsplash-$bsver-$pkgver.diff \
	linux-$pkgver-2.6.11.10.diff \
	http://www.kernel.org/pub/linux/devel/binutils/linux-2.6-seg-5.patch)
md5sums=('f00fd1b5a80f52baf9d1d83acddfa325' 'bf69b6b42af31f29295231387cb7c79d' \
	 '063d6cf50ddf8d572483f44f5d936eef' '4ee96a4be857bf002d964ac1ebde6fee' \
	 '214f87fb9d0beef681e3d6a4789fc7f7')

[ "$CARCH" == "x86_64" ] && MARCH=K8

build()
{
	Fcd linux-$pkgver
	Fpatchall
	cp $startdir/src/config .config
	Fsed "486" "`echo ${MARCH:-$CARCH}|sed 's/^i//'`" .config
	yes "" | make config
	Fsed "EXTRAVERSION =.*" "EXTRAVERSION = -fw$pkgrel" Makefile
							
	cd ..
	Fmkdir /usr/src/
	mv linux-$pkgver $Fdestdir/usr/src/linux-$pkgver-fw$pkgrel
	Fln linux-$pkgver-fw$pkgrel /usr/src/linux
}

# vim: ft=sh
