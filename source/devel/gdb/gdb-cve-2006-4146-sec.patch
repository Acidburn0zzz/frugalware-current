diff -Naur gdb-6.5.orig/gdb/dwarf2read.c gdb-6.5/gdb/dwarf2read.c
--- gdb-6.5.orig/gdb/dwarf2read.c	2006-09-04 15:34:23.000000000 +0200
+++ gdb-6.5/gdb/dwarf2read.c	2006-09-04 15:42:43.000000000 +0200
@@ -8855,6 +8855,17 @@
 		     dwarf_stack_op_name (op));
 	  return (stack[stacki]);
 	}
+
+        /* Enforce maximum stach depth of 63 to avoid ++stacki writing
+           outside of the gives size. Also enforce minimum > 0.
+           -- wad@google.com 14 Aug 2006 */
+        if (stacki >= sizeof(stack)/sizeof(*stack) - 1)
+          internal_error (__FILE__, __LINE__,
+                            _("location description stack too deep: %d"),
+                            stacki);
+        if (stacki <= 0)
+          internal_error (__FILE__, __LINE__,
+                            _("location description stack too shallow"));
     }
   return (stack[stacki]);
 }
diff -Naur gdb-6.5.orig/gdb/dwarfread.c gdb-6.5/gdb/dwarfread.c
--- gdb-6.5.orig/gdb/dwarfread.c	2006-09-04 15:34:23.000000000 +0200
+++ gdb-6.5/gdb/dwarfread.c	2006-09-04 15:39:44.000000000 +0200
@@ -2224,6 +2224,16 @@
 	  stacki--;
 	  break;
 	}
+        /* Enforce maximum stack depth of 63 to avoid ++stacki writing
+           outside of the given size. Also enforce minimum > 0.
+           -- wad@google.com 14 Aug 2006 */
+        if (stacki >= sizeof(stack)/sizeof(*stack) - 1)
+          internal_error (__FILE__, __LINE__,
+                            _("location description stack too deep: %d"),
+                            stacki);
+        if (stacki <= 0)
+          internal_error (__FILE__, __LINE__,
+                            _("location description stack too shallow"));
     }
   return (stack[stacki]);
 }
