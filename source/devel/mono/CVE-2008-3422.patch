Index: mcs/class/System.Web/Test/System.Web.UI.HtmlControls/HtmlInputRadioButtonTest.cs
===================================================================
--- mcs/class/System.Web/Test/System.Web.UI.HtmlControls/HtmlInputRadioButtonTest.cs	(revision 109357)
+++ mcs/class/System.Web/Test/System.Web.UI.HtmlControls/HtmlInputRadioButtonTest.cs	(revision 109358)
@@ -236,9 +236,9 @@
 			rb.ID = "id";
 			string attrs = rb.RenderAttributes ();
 			Assert.IsTrue (attrs.IndexOf ("value=\"id\"") >= 0);
-			rb.Value = "hola";
+			rb.Value = "hola<&";
 			attrs = rb.RenderAttributes ();
-			Assert.IsTrue (attrs.IndexOf ("value=\"hola\"") >= 0);
+			Assert.IsTrue (attrs.IndexOf ("value=\"hola&lt;&amp;\"") >= 0);
 		}
 
 #if NET_2_0
Index: mcs/class/System.Web/Test/System.Web.UI.HtmlControls/HtmlImageTest.cs
===================================================================
--- mcs/class/System.Web/Test/System.Web.UI.HtmlControls/HtmlImageTest.cs	(revision 109357)
+++ mcs/class/System.Web/Test/System.Web.UI.HtmlControls/HtmlImageTest.cs	(revision 109358)
@@ -126,13 +126,13 @@
 			img.Alt = "*2*";
 			img.Border = 3;
 			img.Height = 4;
-			img.Src = "*5*";
+			img.Src = "*5<&*";
 			img.Width = 6;
 			
 			Assert.AreEqual (6, img.Attributes.Count, "Attributes.Count");
 
 			HtmlTextWriter writer = img.GetWriter ();
-			Assert.AreEqual (" src=\"*5*\" align=\"*1*\" alt=\"*2*\" border=\"3\" height=\"4\" width=\"6\" /", writer.InnerWriter.ToString ());
+			Assert.AreEqual (" src=\"*5&lt;&amp;*\" align=\"*1*\" alt=\"*2*\" border=\"3\" height=\"4\" width=\"6\" /", writer.InnerWriter.ToString ());
 		}
 	}
 }
Index: mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlForm.cs
===================================================================
--- mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlForm.cs	(revision 109357)
+++ mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlForm.cs	(revision 109358)
@@ -276,7 +276,7 @@
 				w.WriteAttribute ("name", Name);
 
 			w.WriteAttribute ("method", Method);
-			w.WriteAttribute ("action", action);
+			w.WriteAttribute ("action", action, true);
 
 			/*
 			 * This is a hack that guarantees the ID is set properly for HtmlControl to
Index: mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlInputRadioButton.cs
===================================================================
--- mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlInputRadioButton.cs	(revision 109357)
+++ mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlInputRadioButton.cs	(revision 109358)
@@ -126,7 +126,7 @@
 			if (Page != null)
 				Page.ClientScript.RegisterForEventValidation (this.UniqueID, Value);
 #endif
-			writer.WriteAttribute ("value", Value);
+			writer.WriteAttribute ("value", Value, true);
 			Attributes.Remove ("value");
 			base.RenderAttributes (writer);
 		}
Index: mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlSelect.cs
===================================================================
--- mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlSelect.cs	(revision 109357)
+++ mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlSelect.cs	(revision 109358)
@@ -693,10 +693,10 @@
 					}
 				}
 				
-				w.WriteAttribute ("value", item.Value);
+				w.WriteAttribute ("value", item.Value, true);
 				w.Write (HtmlTextWriter.TagRightChar);
 				
-				w.Write (item.Text);
+				w.Write (HttpUtility.HtmlEncode(item.Text));
 				w.WriteEndTag ("option");
 				w.WriteLine ();
 
Index: mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlControl.cs
===================================================================
--- mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlControl.cs	(revision 109357)
+++ mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlControl.cs	(revision 109358)
@@ -90,7 +90,7 @@
 					catch (Exception) {
 						throw new HttpException(attribName + " property had malformed url");
 					}
-					writer.WriteAttribute(attribName, attr);
+					writer.WriteAttribute(attribName, attr, true);
 					Attributes.Remove(attribName);
 				}
 			}
Index: mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlInputButton.cs
===================================================================
--- mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlInputButton.cs	(revision 109357)
+++ mcs/class/System.Web/System.Web.UI.HtmlControls/HtmlInputButton.cs	(revision 109358)
@@ -286,7 +286,7 @@
 				}
 
 				if (onclick.Length > 0) {
-					writer.WriteAttribute ("onclick", onclick);
+					writer.WriteAttribute ("onclick", onclick, true);
 					writer.WriteAttribute ("language", "javascript");
 				}
 			}
@@ -302,7 +302,7 @@
 				
 				if (oc != null) {
 					writer.WriteAttribute ("language", "javascript");
-					writer.WriteAttribute ("onclick", oc);
+					writer.WriteAttribute ("onclick", oc, true);
 				}
 			}
 #endif
