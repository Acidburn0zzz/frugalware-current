# Last Modified: Fri, 14 Jul 2006 21:21:19 +0200
# Compiling Time: 0.01 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=ant-eclipse-ecj
pkgver=3.2
date=200606291905
pkgrel=1
pkgdesc="Ant Compiler Adapter for Eclipse Java Compiler"
url="http://www.eclipse.org/"
depends=('ecj' 'apache-ant')
groups=('devel-extra')
archs=('i686')
up2date="lynx -dump http://download.eclipse.org/eclipse/downloads/|grep Release|sed -n 's/.*]\([0-9\.]*\) .*/\1/;1 p'"
source=(http://download.eclipse.org/eclipse/downloads/drops/R-$pkgver-$date/ecjsrc.zip)

build()
{
	mkdir -p src/org/eclipse/jdt/{core,internal}
	cp org/eclipse/jdt/core/JDTCompilerAdapter.java \
		src/org/eclipse/jdt/core || return 1
	cp -r org/eclipse/jdt/internal/antadapter \
		src/org/eclipse/jdt/internal || return 1
	rm -fr about* org
	cd src

	ecj -bootclasspath /usr/share/java/libgcj-`gcc -dumpversion`.jar:/usr/lib/ant.jar \
		`find org/ -name '*.java'` || return 1
	find -name '*.class' -o -name '*.properties' | \
		xargs fastjar cf ant-eclipse-ecj.jar || return 1

	Ffilerel /usr/share/java/ant-eclipse-ecj.jar
}

sha1sums=('596d3bb9bc855a58b51e417470d0b2beeea6e2cd')
