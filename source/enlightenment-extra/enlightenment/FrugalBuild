# Compiling Time: 0 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=enlightenment
pkgver=0.21.6
pkgrel=1
pkgdesc="Enlightenment Foundation Window Manager"
url="https://www.enlightenment.org/"
_F_archive_grepv="alpha\|beta\|rc"
source=(https://download.enlightenment.org/rel/apps/$pkgname/$pkgname-$pkgver.tar.xz \
	revert-54ecd5e56bfd93ae5c1ab20737c1843f5ba8ab2c.patch revert-72bfd182d16ca4815b58d8200cfc15b14039c8bb.patch)
up2date="Flasttar https://download.enlightenment.org/rel/apps/$pkgname/"
groups=('enlightenment-extra' 'e-apps')
archs=('x86_64' 'i686')
## full-depends here
depends=('efl>=1.18.3' 'glibc' 'libsystemd' 'libunwind' 'harfbuzz' 'fribidi' 'fontconfig' 'freetype2' 'luajit2' 'openssl' 'zlib' \
	'libjpeg' 'hyphen' 'libstdc++' 'libgcc' 'xz' 'lz4' 'libgcrypt' 'glib2' 'graphite2' 'expat' 'bzip2' 'libpng' 'libgpg-error' \
	'pcre' 'libpulse' 'alsa-lib' 'json-c' 'dbus' 'wayland' 'libxkbcommon' 'libxcursor' 'libx11' 'libxcomposite' \
	'libxdamage' 'libxext' 'libxfixes' 'libxinerama' 'libxrandr' 'libxrender' 'libxtst' 'libxscrnsaver' 'libxi' 'libinput' 'libgbm' \
	'libdrm' 'util-linux' 'libsndfile' 'bullet' 'libxcb' 'libasyncns' 'libffi' 'mtdev' 'libevdev' 'libblkid' 'flac' 'libogg' 'libvorbis' \
	'libxau' 'libxdmcp' 'libuuid' 'pam' 'xcb-util-keysyms' 'bluez')
makedepends=('x11-protos' 'xorg-server-xwayland')
sha1sums=('070a5b1f93c0a3efe38afde1fc3f52b452ebebf2' \
          '7abd3f72a477c85f36ce6897366ba4fc0a6d4405' \
          '9bcde013d967b8eb0931e8d7c3f08f996614cccc')
Fconfopts+=" --enable-wayland \
	--enable-wayland-egl \
	--enable-xwayland \
	--disable-wl-weekeyboard"

CFLAGS+=" -fvisibility=hidden -fomit-frame-pointer"
CXXFLAGS+=" -fvisibility=hidden -fomit-frame-pointer"

build() {

	Fbuild
	Fmkdir etc/X11/sessions
	Fmv usr/share/xsessions/enlightenment.desktop etc/X11/sessions/enlightenment.desktop
	Frm usr/share/xsessions
}

# optimization OK
