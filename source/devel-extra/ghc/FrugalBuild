# Compiling Time: 30.17 SBU
# Maintainer: Miklos Vajna <vmiklos@frugalware.org>

pkgname=ghc
pkgver=7.10.2
pkgrel=1
pkgdesc="The Glasgow Haskell Compiler"
url="http://www.haskell.org/ghc/"
depends=('gmp>=5.0.1' 'readline' 'libedit' 'libffi')
makedepends=('ghc' 'docbook-xsl' 'dblatex' 'texlive-fonts-extra')
groups=('devel-extra')
archs=('i686' 'x86_64')
_F_archive_grepv="rc"
options=('scriptlet')
up2date="Flastverdir http://downloads.haskell.org/~ghc/"
source=(http://www.haskell.org/ghc/dist/$pkgver/ghc-$pkgver-src.tar.xz)
sha1sums=('288f78841477cead39944c57574a326fc1313fa8')

replaces=('haskell-transformers' 'haskell-xhtml' 'haskell-array'
          'haskell-binary' 'haskell-containers' 'haskell-deepseq'
          'haskell-haskeline' 'haskell-terminfo')
conflicts=("${replaces[@]}")
provides=("${provides[@]}")

build()
{
	_F_conf_notry="build"
	Fbuild

	Fmkdir etc/ld.so.conf.d/
	cd $Fdestdir

	for i in $(find usr/lib -name "*.so*" -exec dirname {} \; | sort -u);
	do
		Fexec echo "/${i}" >> "$Fdestdir/etc/ld.so.conf.d/ghc.conf" || Fdie

	done

}

# optimization OK
