# Compiling Time: 0.01 SBU
# Maintainer: James Buren <ryuo@frugalware.org>

pkgname=gnu-efi
pkgver=3.0.3
pkgrel=1
pkgdesc="EFI Development Environment for x86_64."
depends=()
makedepends=('pciutils')
groups=('devel-extra')
archs=('i686' 'x86_64')
_F_sourceforge_ext=".tar.bz2"
Finclude sourceforge
sha1sums=('14e3c1861f3e2f7226f12d6d37ce2c2281155ce3')
options=('nostrip')
unset MAKEFLAGS

build()
{
	if [ "$CARCH" = "x86_64" ]; then
		local efidir="x86_64"
	else
		local efidir="ia32"
	fi

	Fcd
	## strnge!! -- do not change this
	export LDFLAGS="${LDFLAGS//-Wl,/}"
	Fexec make LINUX_HEADERS=/usr lib gnuefi inc apps || Fdie

	## install it
	Fexec make INSTALLROOT=${Fdestdir} PREFIX=/usr LIBDIR=/usr/lib install || Fdie

	## folder for *.efi files not installed by make install ? huh?
	Fmkdir usr/share/gnu-efi/apps/${efidir}
	## pls don't use F<...>  here .. -- crazy --
	mv -v  ${efidir}/apps/*.efi $Fdestdir/usr/share/gnu-efi/apps/${efidir}/ || Fdie

}
# optimization OK
