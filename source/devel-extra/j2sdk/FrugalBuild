# Compiling Time: 0.07 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=j2sdk
pkgver=5.0_10
oldpkgver=${pkgver/5.0/1.5.0}
realver=${oldpkgver//./_}
pkgrel=1
pkgdesc="Sun's java development kit"
url="http://java.sun.com/j2se/downloads.html"
depends=('j2re') # NO, please don't add x to here!
groups=('devel-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://java.sun.com/javase/downloads/index.jsp|grep JRE.*Update|sed 's/.* \([0-9|.]*\) Update \([0-9\.]*\)/\1_\2/'"
if [ "$CARCH" == "i686" ]; then
	_arch="i586"
	sha1sums=('fc4883d6da60940cbe4b6c2575478cead26313ff')
elif [ "$CARCH" == "x86_64" ]; then
	_arch="amd64"
	sha1sums=('b0c4440f7059b2d477a437e5c58f135820e86326')
fi
source=(http://download.java.net/dlj/binaries/jdk-$realver-dlj-linux-$_arch.bin \
	https://jdk-distros.dev.java.net/source/browse/*checkout*/jdk-distros/trunk/utils/construct.sh \
	j2sdk.sh)
sha1sums=(${sha1sums[@]} '966b9c8229ef3dfb588c108124f367cc993cb581' \
	'8ece7898cf1e1b7f437455360c2549b0b8683723')

# TODO: 1) update j2sdk.sh based on openjdk.sh
#       2) maybe package j2re as a subpkg of j2sdk?

build() {
	Fmkdir /usr/lib
	mkdir $pkgname
	cd $pkgname
	sh ../jdk-$realver-dlj-linux-$_arch.bin --accept-license
	cd ..
	sh construct.sh $pkgname linux-jdk linux-jre
	rm -rf linux-jdk/{jre,src.zip}
	mv linux-jdk $Fdestdir/usr/lib/java
	Fexe /etc/profile.d/$pkgname.sh
}

# optimization ok
