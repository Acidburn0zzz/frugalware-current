# Compiling Time: 0.01 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=java-gcj-compat
pkgver=1.0.77
pkgrel=2
gccver=4.3.0
javaver="1.5.0-gcj-1.5.0.0"
pkgdesc="A collection of wrapper scripts, symlinks and jar files."
url="ftp://sources.redhat.com/pub/rhug/"
depends=("libgcj=$gccver" 'gjdoc' 'fastjar')
makedepends=("gcc-gcj=$gccver" 'ecj')
groups=('devel-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump $url|grep $pkgname-.*tar.gz$|sed 's/.*-\([^-]*\)\.t.*/\1/'|Fsort|sed -n '$ p'"
source=(ftp://sources.redhat.com/pub/rhug/java-gcj-compat-$pkgver.tar.gz \
	java-gcj.sh)
sha1sums=('07b4058ed0a254462d5196fee91e660d434f84ec' \
          '73c1f3cc2db4f63cb051e65f0c664358289e9f13')

build()
{
	Fcd
	Fpatchall
	Fautoreconf
	Fconf
	Fmakeinstall
	Fexe /etc/profile.d/java-gcj.sh
	echo 'if [ -z "$CLASSPATH" ]; then' >>$Fdestdir/etc/profile.d/java-gcj.sh
	echo "	export CLASSPATH=/usr/share/java/libgcj-$gccver.jar" >>$Fdestdir/etc/profile.d/java-gcj.sh
	echo "else" >>$Fdestdir/etc/profile.d/java-gcj.sh
	echo "	export CLASSPATH=\$CLASSPATH:/usr/share/java/libgcj-$gccver.jar" \
		>>$Fdestdir/etc/profile.d/java-gcj.sh
	echo "fi" >>$Fdestdir/etc/profile.d/java-gcj.sh
	Fln /usr/bin/gjdoc /usr/lib/jvm/java-$javaver/bin/javadoc
	# openoffice.org wants this
	gcjver=$(basename /usr/lib/gcj-${gccver}*)
	Fln gcj-$gcjver/libjawt.so /usr/lib
}

# optimization OK

