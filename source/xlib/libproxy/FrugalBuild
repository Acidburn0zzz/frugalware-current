# Compiling time: 0.05 SBU
# Maintainer: crazy <crazy@frugalware.org>

## TODO: add kf5 support
##       add perl support

pkgname=libproxy
pkgver=0.4.12
pkgrel=1
pkgdesc="libproxy is a library that provides automatic proxy configuration management."
depends=('libstdc++>=5.3.0-2')
makedepends=('networkmanager>=1.0.10') ## not a depend.. need to find out
groups=('xlib')
archs=('i686' 'x86_64')
_F_github_tag=yes
Finclude cmake python github
source=(https://github.com/$pkgname/$pkgname/archive/$pkgver.tar.gz)
up2date="$up2date | sed 's/libproxy_//'"
sha1sums=('f11a86858ab02819eefb55de50d9175c23829a06')


subpkgs=("${subpkgs[@]}" "$pkgname-python")
subdescs=("${subdescs[@]}" "$pkgname python binding")
subdepends=("${subdepends[@]}" "python>=2.7.11-3")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xlib')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-gnome")
subdescs=("${subdescs[@]}" "$pkgname gnome support")
subdepends=("${subdepends[@]}" "glib2>=2.46.2-4")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'gnome')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-networkmanager")
subdescs=("${subdescs[@]}" "$pkgname networkmanager support")
subdepends=("${subdepends[@]}" "dbus>=1.10.6-5")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-vala")
subdescs=("${subdescs[@]}" "$pkgname vala support")
subdepends=("${subdepends[@]}" "vala>=0.30.0-3")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')


build() {

	Fcd
	CMake_build \
		-DWITH_KDE4=OFF -DWITH_DOTNET=OFF \
		-DWITH_VALA=ON  -DWITH_PERL=OFF \
		-DWITH_WEBKIT=OFF -DWITH_WEBKIT3=OFF \
		-DWITH_MOZJS=OFF

	Fsplit $pkgname-vala usr/share/vala
	Fsplit $pkgname-python $_F_python_libdir
	Fsplit $pkgname-gnome usr/lib/$pkgname/$pkgver/modules/config_gnome3.so
	Fsplit $pkgname-gnome usr/libexec/pxgsettings
	Fsplit $pkgname-networkmanager usr/lib/$pkgname/$pkgver/modules/network_networkmanager.so

}

# optimization OK
