# Compiling time: 0.05 SBU
# Maintainer: crazy <crazy@frugalware.org>

## TODO: add perl support

pkgname=libproxy
pkgver=0.4.13
pkgrel=2
pkgdesc="libproxy is a library that provides automatic proxy configuration management."
depends=('libstdc++>=6.2.1-5')
makedepends=('networkmanager>=1.4.0') ## not a depend.. need to find out
groups=('xlib')
archs=('i686' 'x86_64')
_F_github_tag=yes
Finclude cmake python github
source=(https://github.com/$pkgname/$pkgname/archive/$pkgver.tar.gz)
up2date="$up2date | sed 's/libproxy_//'"
sha1sums=('fadd9e3c9c418496b0836527c89ac6d84f0e37c9')


subpkgs=("${subpkgs[@]}" "$pkgname-python")
subdescs=("${subdescs[@]}" "$pkgname python binding")
subdepends=("${subdepends[@]}" "python>=2.7.12-2")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xlib')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-gnome")
subdescs=("${subdescs[@]}" "$pkgname gnome support")
subdepends=("${subdepends[@]}" "glib2>=2.50.0")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'gnome')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-networkmanager")
subdescs=("${subdescs[@]}" "$pkgname networkmanager support")
subdepends=("${subdepends[@]}" "dbus>=1.10.10-4")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-vala")
subdescs=("${subdescs[@]}" "$pkgname vala support")
subdepends=("${subdepends[@]}" "vala>=0.30.0-3")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xlib-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')


build() {

	Fcd
	CMake_build \
		-DWITH_KDE=ON -DWITH_DOTNET=OFF \
		-DWITH_VALA=ON  -DWITH_PERL=OFF \
		-DWITH_WEBKIT=OFF -DWITH_WEBKIT3=OFF \
		-DWITH_MOZJS=OFF

	Fsplit $pkgname-vala usr/share/vala
	Fsplit $pkgname-python $_F_python_libdir
	Fsplit $pkgname-gnome usr/lib/$pkgname/$pkgver/modules/config_gnome3.so
	Fsplit $pkgname-gnome usr/libexec/pxgsettings
	Fsplit $pkgname-networkmanager usr/lib/$pkgname/$pkgver/modules/network_networkmanager.so

}

# optimization OK
