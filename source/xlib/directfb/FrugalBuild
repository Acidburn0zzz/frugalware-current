# Last Modified: Fri, 14 Jul 2006 00:13:04 +0200
# Compiling Time: 1.28 SBU
# Maintainer: Priyank <priyankmg@gmail.com>

pkgname=directfb
pkgver=0.9.25.1
pkgrel=4
pkgdesc="A thin library that provides hardware graphics acceleration, input device handling and abstraction, integrated windowing system on top of the Linux Framebuffer Device."
url="http://www.directfb.org"
license="LGPL"
depends=('sdl' 'sysfsutils' 'freetype2' 'libpng' 'libjpeg' 'libmpeg3' 'zlib'
	'xf86-input-joystick' 'xf86-input-keyboard' 'xf86-input-mouse' \
	'xf86-video-i810' 'xf86-video-mga' 'xf86-video-nv' 'xf86-video-savage' \
	'xf86-video-sis' 'xf86-video-neomagic' 'xf86-video-ati')
groups=('xlib')
archs=('i686' 'x86_64')
up2date="lynx -dump http://directfb.org/index.php?path=Main%2FDownloads | grep -m1 tar.gz | sed 's/.*B-\(.*\).t.*/\1/'"
source=(http://www.directfb.org/downloads/Core/DirectFB-$pkgver.tar.gz \
	directfb-0.9.25.1-x86_64.diff)
sha1sums=('40654da2fde2fd5539f5a0c5cdac50e1a8a52bb4' \
	  '09524cdd69787e3a464cbc605f654ebab6b681b0')

build() {
	Fcd DirectFB-$pkgver
	[ "$CARCH" == "x86_64" ] && Fpatchall
	Fconf --enable-x11 --enable-zlib --enable-sdl --enable-mmx --enable-sse \
	--enable-jpeg --enable-png --enable-freetype --enable-sysfs --enable-static \
	--enable-debug --disable-vnc --enable-fbdev \
	--with-input-drivers=keyboard,joystick,ps2mouse,serialmouse,linuxinput \
	--with-gfx-drivers=i810,i830,matrox,nvidia,sis315,neomagic,savage,ati128
	## HACK!
	for i in `find . -iname Makefile`
	do
		Fsed "-O3 -ffast-math -pipe" "" $i
	done
	make || return 1
	Fmakeinstall
}

# optimization OK
