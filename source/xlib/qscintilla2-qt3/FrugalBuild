# Compiling Time: 0.3 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=qscintilla2-qt3
ver1=1.73
ver2=2.1
pkgver=${ver1}_${ver2}
origname=QScintilla
pkgrel=1
pkgdesc="QScintilla2 is a port to Qt of Neil Hodgson's Scintilla C++ editor class. (Qt3)"
url="http://www.riverbankcomputing.co.uk/qscintilla"
license="GPL 2"
up2date="lynx -dump $url/download.php|grep -v "gpl-1.7"|grep -m1 'gpl-\(.*\).tar.gz'|sed 's/.*la-//;s/-gpl\(.*\).t.*/\1/;s/-/_/'"
source=(http://www.riverbankcomputing.com/Downloads/${origname}2/$origname-$ver1-gpl-$ver2.tar.gz \
	broken-destdir.patch)
groups=('xlib')
archs=('i686' 'x86_64')
depends=('qt>=3.3.8-3' 'libstdc++' 'libgl' 'libxmu' 'libxi' 'libxrandr' 'libxcursor' 'libxinerama' 'libxft')
makedepends=('qt4>=4.3.0' 'libxi' 'libstdc++' 'libice' 'libxrender')
_F_cd_path="$origname-$ver1-gpl-$ver2"
sha1sums=('ca9ac61cc3d537d7b53202ff5d8565365c3f8734'\
          '72ad3600a69f61134ad20e763542843d938691ee')

subpkgs=('qscintilla2-qt4')
subdescs=("QScintilla2 is a port to Qt of Neil Hodgson's Scintilla C++ editor class. (Qt4)")
subdepends=('qt4>=4.3.0 libxi libstdc++ libice libxrender')
subgroups=('xlib-extra')
subarchs=('i686 x86_64')
suboptions=('force') ## need to force this time '2007.. -> 1.73' does not work without force :/
subconflicts=('qscintilla2')
subreplaces=('qscintilla2')
subprovides=('qscintilla2')

build()
{
	Fpatchall
	## QT4
	source /etc/profile.d/qt4.sh.off
        cd Qt4
        /usr/bin/qmake qscintilla.pro || Fdie
        Fmakeinstall INSTALL_ROOT=$Fdestdir || Fdie
	Fsplit qscintilla2-qt4 /usr
	## QT3
	cd ../Qt3
	source /etc/profile.d/qt.sh
	/usr/lib/qt/bin/qmake qscintilla.pro || Fdie
	Fmakeinstall INSTALL_ROOT=$Fdestdir || Fdie
 	Fmkdir usr/lib/qt/translations/qscintilla2
	Fmv usr/lib/qt/translations/*.qm usr/lib/qt/translations/qscintilla2/
}

# optimization OK
