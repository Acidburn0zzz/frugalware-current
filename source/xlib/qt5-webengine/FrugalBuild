# Compiling Time: 64.56 SBU
# Maintainer: Marius Cirsta <mcirsta@frugalware.org>

pkgname=qt5-webengine
pkgver=5.7.0
pkgrel=1
depends=('qt5-declarative>=5.7' 'qt5-webchannel>=5.7' 'qt5-location>=5.7' 'libxcomposite' 'libxrandr' 'nss' 'libxtst' \
	'libxscrnsaver' 'zlib' 'libwebp' 'libxml2' 'libevent' 'jsoncpp' 'opus' 'libvpx' 'snappy' 'icu4c' 'ffmpeg' 'zlib' 'libsrtp' )
makedepends=('git' 're2c' 'x11-protos')
Finclude qt5
archs=('x86_64' 'i686')
source+=(libjpeg.patch)
replaces=('libqt5webengine')
conflicts=("${replaces[@]}")
provides=("${replaces[@]}")
sha1sums=('bff07a36115d0a3f44e396c738ce9579ef2cec5b' \
          'fc40f2d0b97dfec78b3ca4a125dee8edbbd4da0a')

build()
{
	Fpatchall
	if [ "$CARCH" == "i686" ]; then
		unset MAKEFLAGS
		qmake-qt5 -d WEBENGINE_CONFIG+=" use_proprietary_codecs use_system_ffmpeg" || Fdie
		make -j1 || Fdie
		make -j1  INSTALL_ROOT=$Fdestdir install || Fdie
	else
		qmake-qt5 -d WEBENGINE_CONFIG+=" use_proprietary_codecs use_system_ffmpeg"
		make || Fdie
		make INSTALL_ROOT=$Fdestdir install || Fdie
	fi
}

# optimization OK
