# Compiling Time: 0.37 SBU
# Maintainer: Miklos Vajna <vmiklos@frugalware.org>

pkgname=imlib2
pkgver=1.4.9
pkgrel=2
pkgdesc="Imlib 2 is the successor to Imlib."
_F_sourceforge_dirname="enlightenment"
Finclude sourceforge
url="http://enlightenment.org"
depends=('freetype2>=2.7' 'libxext>=1.3.3-3' 'libtiff>=4.0.6' 'libid3tag>=0.15.1b-6' \
	'libjpeg>=9a-2' 'libgif>=5.1.1-2' 'libpng>=1.6.25')
makedepends=('x11-protos')
groups=('xlib')
archs=('i686' 'x86_64')
sha1sums=('77ba47763a32579b9c72f603ccdbd9bde18a8009')

if [ "$CARCH" = "i686" ]; then
	Fconfopts+=" --enable-mmx"
elif [ "$CARCH" = "x86_64" ]; then
	## ADM64 assembler code optimizazion is buggy , do _ NOT _ enable for now
	## see FS#3647
	Fconfopts+=" --disable-amd64"
fi

build()
{
	Fpatchall
	Fmake --sysconfdir=/etc/imlib2
	Fmkdir /usr/{bin,include,lib/pkgconfig}
	Fmakeinstall DESTDIR=$Fdestdir
	Ffilerel src/lib/Imlib2.h /usr/include/Imlib2.h
}

# optimization OK
