# Last Modified: Mon, 16 May 2005 19:04:20 +0200
# Compiling Time: ~10 minutes
# Maintainer: Zoltan Kiss <djsmiley@inflame.hu>

pkgname=courier-authlib
pkgver=0.56
pkgrel=1
pkgdesc="The Courier authentication library & daemon"
depends=('expect')
groups=('network')
backup=('etc/courier/authdaemonrc')
makedepends=('openldap' 'mysql' 'postgresql')
up2date="lynx -dump 'http://www.courier-mta.org/download.php'|grep authlib|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=(http://dl.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.bz2 rc.courier-authlib authdaemonrc.frugal README.frugalware)
md5sums=('d4348a3add731fadd1c3c445aa8c904a' 'ec05d0028fa38de6d7f78d86cd753c5c' \
	'140bd6ed28419f055ef66f1516795157' 'e484a46ea43b738d2ae805e4ea7f60e2')

build() {
	Fmake --mandir=/usr/share/man \
	--sysconfdir=/etc/courier \
	--libexecdir=/usr/libexec \
	--datadir=/usr/lib \
	--with-authshadow \
	--localstatedir=/var/lib/courier \
	--with-db=gdbm \
	--without-authpam \
	--with-authldaprc=/etc/courier/authldaprc \
	--with-authpgsqlrc=/etc/courier/authpgsqlrc \
	--with-pgsql-libs=/usr/lib/postgresql/ \
	--with-pgsql-includes=/usr/include/postgresql/ \
	--with-authmysqlrc=/etc/courier/authmysqlrc \
	--with-mysql-libs=/usr/lib/mysql/ \
	--with-mysql-includes=/usr/lib/mysql/ \
	--with-authdaemonrc=/etc/courier/authdaemonrc \
	--with-authdaemonvar=/var/run/courier \
	--with-mailuser=daemon \
	--with-mailgroup=daemon || return 1

	Fmkdir  /usr
	Fmakeinstall
	
        # remove original courier rc scripts (we don't need them :P )
        Frm /usr/sbin/authdaemond

	# config files
	Fmkdir /usr/share/doc/$pkgname-$pkgver/examples
	Fmv /etc/courier/* /usr/share/doc/$pkgname-$pkgver/examples/
	# all .dist configfiles moved out from /etc/courier
	
	# place my sample config file in confdir
	Ffile authdaemonrc.frugal /etc/courier/authdaemonrc	
	Fdoc README.frugalware
	
	#init scripts
	Frcd courier-authlib
	
}

# vim: ft=sh
