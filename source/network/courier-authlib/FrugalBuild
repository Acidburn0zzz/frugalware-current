# Last Modified: Tue, 25 Oct 2005 18:02:55 +0200
# Compiling Time: 2.66 SBU
# Maintainer: Zoltan Kiss <djsmiley@inflame.hu>

pkgname=courier-authlib
pkgver=0.57
pkgrel=4
pkgdesc="The Courier authentication library & daemon"
depends=('expect' 'openldap' 'mysql' 'postgresql' 'gdbm' 'procps')
groups=('network')
archs=('i686' 'x86_64')
backup=('etc/courier/authdaemonrc')
up2date="lynx -dump 'http://www.courier-mta.org/download.php'|grep authlib|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=(http://dl.sourceforge.net/sourceforge/courier/$pkgname-$pkgver.tar.bz2 rc.courier-authlib authdaemonrc.frugal README.frugalware)
md5sums=('af146ac84f0c3ee00006af50b4415d8a' 'ec05d0028fa38de6d7f78d86cd753c5c' \
	'140bd6ed28419f055ef66f1516795157' 'e484a46ea43b738d2ae805e4ea7f60e2')

build()
{
	Fmkdir  /usr
	Fbuild --mandir=/usr/share/man \
	--sysconfdir=/etc/courier \
	--libexecdir=/usr/libexec \
	--datadir=/usr/lib \
	--with-authshadow \
	--with-authmysql \
	--with-authpgsql \
	--with-authcram \
	--enable-userdb \
	--localstatedir=/var/lib/courier \
	--with-db=gdbm \
	--without-authpam \
	--with-authldaprc=/etc/courier/authldaprc \
	--with-authpgsqlrc=/etc/courier/authpgsqlrc \
	--with-pgsql-libs=/usr/lib/postgresql/ \
	--with-pgsql-includes=/usr/include/postgresql/ \
	--with-authmysqlrc=/etc/courier/authmysqlrc \
	--with-mysql-libs=/usr/lib/mysql/ \
	--with-mysql-includes=/usr/lib/mysql/ \
	--with-authdaemonrc=/etc/courier/authdaemonrc \
	--with-authdaemonvar=/var/run/courier/authdaemon \
	--with-mailuser=daemon \
	--with-mailgroup=daemon
	
        # remove original courier rc scripts (we don't need them :P )
        Frm /usr/sbin/authdaemond

	# config files
	Fmkdir /usr/share/doc/$pkgname-$pkgver/examples
	Fmv '/etc/courier/*' /usr/share/doc/$pkgname-$pkgver/examples/
	# all .dist configfiles moved out from /etc/courier
	
	# place my sample config file in confdir
	Ffile authdaemonrc.frugal /etc/courier/authdaemonrc	
	Fdoc README.frugalware
	
	#init scripts
	Frcd courier-authlib
}

# vim: ft=sh

# optimalization OK
