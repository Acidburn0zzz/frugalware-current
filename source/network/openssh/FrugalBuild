# Last Modified: Thu, 09 Mar 2006 00:26:12 +0100
# Compiling Time: 0.4 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Old-Maintainer: Zsolt Szalai <xbit.lists@chello.hu>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=openssh
pkgver=4.3p2
pkgrel=1
pkgdesc='Secure Shell daemon and clients'
url="http://www.openssh.com/"
backup=('etc/ssh/ssh_config' 'etc/ssh/sshd_config')
depends=('openssl=0.9.8' 'zlib')
makedepends=('tcp_wrappers')
groups=('network')
archs=('i686' 'x86_64')
up2date="lynx -dump ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/|Flasttar"
source=(ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/$pkgname-$pkgver.tar.gz \
	rc.sshd rc.sshd-{hu,de}.po)
sha1sums=('2b5b0751fd578283ba7b106025c0ba391fd72f1f' \
	'0b14a96fbe15bec5dab0317e9fc05670bc161595' \
	'2ff8e762c2c04dfe5c0b2d3333acbf49689303ba' \
	'2eb20d499ddc70490c01c9c9b62b8964ca3fe4ea')

build()
{
	Fbuild --sysconfdir=/etc/ssh --datadir=/usr/share/openssh \
		--without-pam \
		--with-md5-passwords \
		--with-tcp-wrappers \
		--with-default-path=/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/bin:/bin \
		--with-ipv4-default \
		--with-privsep-path=/var/empty \
		--with-privsep-user=sshd
	Fmkdir /var/empty
	Frm /etc/ssh/ssh_host_{dsa_key,dsa_key.pub,rsa_key,rsa_key.pub,key,key.pub}
	Frcd2 sshd
	Fsed '^#PermitRootLogin yes$' 'PermitRootLogin no' $Fdestdir/etc/ssh/sshd_config
	Fsed '^#X11Forwarding no$' 'X11Forwarding yes' $Fdestdir/etc/ssh/sshd_config
	Fsed '#   ForwardX11 no' 'ForwardX11Trusted yes' $Fdestdir/etc/ssh/ssh_config
}

# optimalization OK
