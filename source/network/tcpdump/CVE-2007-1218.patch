diff -Naur tcpdump-3.9.5/print-802_11.c tcpdump-3.9.5-p/print-802_11.c
--- tcpdump-3.9.5/print-802_11.c	2006-06-14 00:25:43.000000000 +0200
+++ tcpdump-3.9.5-p/print-802_11.c	2007-03-08 20:03:40.000000000 +0100
@@ -264,7 +264,7 @@
 
 			if (pbody->tim.length <= 3)
 				break;
-			if (pbody->rates.length > sizeof pbody->tim.bitmap)
+			if (pbody->tim.length - 3 > sizeof pbody->tim.bitmap)
 				return;
 			if (!TTEST2(*(p + offset), pbody->tim.length - 3))
 				return;
