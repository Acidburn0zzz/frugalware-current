# Last Modified: Wed, 30 Nov 2005 11:43:50 +0100
# Compiling Time: 1.03 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

# NOTE: Need to fix up2date!
pkgname=openldap
pkgver=2.3.13
pkgrel=1
pkgdesc="A suite of the Lightweight Directory Access Protocol servers"
url="http://www.openldap.org/"
groups=('network')
archs=('i686' 'x86_64')
backup=(etc/openldap/ldap.conf etc/openldap/slapd.conf)
depends=('db' 'openssl' 'libtool' 'cyrus-sasl')
makedepends=('tcp_wrappers')
up2date="lynx -dump ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/ | grep openldap | grep tgz | sed -e 's/.*-\(.*\).tgz/\1/;1 p'"
source=(ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/$pkgname-$pkgver.tgz rc.slapd \
	openldap-ntlm.patch0)
sha1sums=('f194a3c99de98265da326af30a4782414244bfb0' \
	  'e2e32477a3252545c04709b172eb65b1847c3678' \
	  '29b8e9c4835235c976f026cd5883228b77581083')

build()
{
	Fpatchall
	autoconf || return 1
	Fmake \
		--localstatedir=/var/openldap --enable-syslog --enable-dynamic \
		--with-readline --with-threads --with-tls --enable-slapd \
		--enable-cleartext --enable-modules --enable-rlookups \
		--enable-wrappers --enable-bdb --enable-slurpd

	make DESTDIR=$Fdestdir install || return 1

	Fln liblber.so /usr/lib/liblber.so.2
	Fln libldap.so /usr/lib/libldap.so.2
	Frcd slapd
}

# vim: ft=sh
# optimalization ok
