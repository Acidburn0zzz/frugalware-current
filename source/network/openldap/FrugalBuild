# Last Modified: Fri Sep 24 16:29:16 CEST 2004
# Compiling Time: ~9 minutes
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=openldap
pkgver=2.2.17
pkgrel=1
pkgdesc="A suite of the Lightweight Directory Access Protocol servers"
url="http://www.openldap.org/"
backup=(etc/openldap/ldap.conf etc/openldap/slapd.conf)
depends=('db' 'openssl')
up2date=`lynx -dump http://www.openldap.org/software/download/|grep 'United States'|tr -s ' '|cut -d ' ' -f 6|cut -d ] -f 2`
source=(ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/$pkgname-$pkgver.tgz rc.slapd)
md5sums=('aa10b961d02fbe331cd53214b7746c73' 'd99310417801d3839839b340156129fa')

build() {
	cd $startdir/src/$pkgname-$pkgver
	./configure --prefix=/usr --sysconfdir=/etc \
		--localstatedir=/var/openldap --enable-syslog --enable-dynamic \
		--with-readline --with-threads --with-tls --enable-slapd \
		--enable-cleartext --enable-modules --enable-rlookups \
		--enable-wrappers --enable-bdb --enable-slurpd
	
	make || return 1

	make DESTDIR=$startdir/pkg install
	cd $startdir/pkg/usr/lib && ln -s `readlink liblber.so` liblber.so.2
	cd $startdir/pkg/usr/lib && ln -s `readlink libldap.so` libldap.so.2
	mkdir -p $startdir/pkg/etc/rc.d/rc.messages
	install -m 755 $startdir/src/rc.slapd $startdir/pkg/etc/rc.d/rc.slapd
	cp -a $startdir/messages/slapd.* $startdir/pkg/etc/rc.d/rc.messages/
}

# vim: ft=sh
