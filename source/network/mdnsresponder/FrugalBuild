# Last Modified: Wed, 22 Mar 2006 12:12:30 +0100
# Compiling Time: ~0.04 SBU
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=mdnsresponder
origname=mDNSResponder
pkgver=107.1
pkgrel=2
pkgdesc="Multi-cast DNS responder written in C# to the Mono/.NET platform."
url="http://developer.apple.com/networking/bonjour/index.html"
depends=('glibc')
#makedepends=('j2sdk')
groups=('network')
archs=('i686')
up2date="lynx -dump http://helios.et.put.poznan.pl/~jstachow/pub/ |grep http.*mDNS |sed -ne 's/.*r-\(.*\).t.*/\1/;1 p'"
source=(http://helios.et.put.poznan.pl/~jstachow/pub/$origname-$pkgver.tar.gz \
	Makefiles.patch rc.mdnsd)
sha1sums=('272c97dce83cea643a75ddd46a6e7d4c4e05d1ef' \
	'0fe3c7676eca7614a9cca5b9ee4e6eb0fbfb4f47' \
	'd0a8838c2975dff0dfad10d1eea0243d5c1a4470')

build() {
	Fmkdir /usr/{sbin,lib,include,man/man{5,8}} /{lib,etc}
	patch -p0 < Makefiles.patch || Fdie
	Fcd $origname-$pkgver/mDNSPosix
	make os=linux || Fdie
	#make os=linux Java || Fdie
	Fcd $origname-$pkgver/Clients
	make os=linux || Fdie
	Fcd $origname-$pkgver/mDNSPosix
	make DESTDIR="$Fdestdir/" os=linux install || Fdie

	Fexe $origname-$pkgver/mDNSPosix/build/prod/dnsextd /usr/sbin/dnsextd
	Fexe $origname-$pkgver/mDNSPosix/build/prod/mDNSResponderPosix /usr/sbin/mDNSResponderPosix
	Fexe $origname-$pkgver/mDNSPosix/build/prod/mDNSNetMonitor /usr/sbin/mDNSNetMonitor
	Fexe $origname-$pkgver/mDNSPosix/build/prod/mDNSProxyResponderPosix /usr/bin/mDNSProxyResponderPosix
	Fexe $origname-$pkgver/mDNSPosix/build/prod/mDNSIdentify /usr/bin/mDNSIdentify

	Frcd2 mdnsd
}
