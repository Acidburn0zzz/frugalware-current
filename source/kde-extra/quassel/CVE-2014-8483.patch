diff -Naur quassel-0.8.0/src/core/cipher.cpp quassel-0.8.0.new/src/core/cipher.cpp
--- quassel-0.8.0/src/core/cipher.cpp	2012-03-20 21:39:20.000000000 +0100
+++ quassel-0.8.0.new/src/core/cipher.cpp	2014-10-28 10:11:28.736888116 +0100
@@ -342,8 +342,12 @@
   }
   else
   {
+  // ECB Blowfish encodes in blocks of 12 chars, so anything else is malformed input
+  if ((temp.length() % 12) != 0)
+    return cipherText;
+
     temp = b64ToByte(temp);
-    while((temp.length() % 8) != 0) temp.append('\0');
+    while ((temp.length() % 8) != 0) temp.append('\0');
   }
 
   QCA::Direction dir = (direction) ? QCA::Encode : QCA::Decode;
@@ -351,12 +355,18 @@
   QByteArray temp2 = cipher.update(QCA::MemoryRegion(temp)).toByteArray();
   temp2 += cipher.final().toByteArray();
 
-  if(!cipher.ok())
+  if (!cipher.ok())
     return cipherText;
 
-  if(direction)
-    temp2 = byteToB64(temp2);
+  if (direction)
+  {
+  // Sanity check
+  if ((temp2.length() % 8) != 0)
+    return cipherText;
 
+    temp2 = byteToB64(temp2);
+  }
+  
   return temp2;
 }
 
