pkgname=qtscriptgenerator
pkgver=0.1.0
pkgrel=5
pkgdesc="Script generator for qt"
group=('kde-extra')
archs=("i686" "x86_64")
license=('GPL')
depends=('phonon' 'libqtxmlpatterns' 'libqtscript' 'libqtscripttools' \
	'libqtnetwork' 'libqtopengl' 'libqtsql' 'libqtxml' 'libqtgui'\
	'libqtuitools' 'libqtwebkit')
makedepends=('pkgconfig')
source=(http://$pkgname.googlecode.com/files/$pkgname-src-$pkgver.tar.gz
	gcc44.patch \
	phonon.patch \
	drop_extra_linkage_fix.patch \
	memory_alignment_fix.patch \
	support_out_of_source_tree_build.patch \
	qs_eval_globalize.patch )
_F_archive_name=$pkgname-src
export QT_XFT=true
export QTDIR=/usr/lib/qt4

build() {
  Fpatchall
  cd generator || Fdie
  # prepare plugins
  qmake || Fdie
  Fmake
  Fexec ./generator --include-paths=/usr/include
  cd ../qtbindings || Fdie
  qmake || Fdie
  Fmake
  # move plugins to correct directory this is ridiculous
  Fmkdir $pkgdir/usr/lib/kde4/plugins/script/
  Fcp $pkgname-src-$pkgver/plugins/script/* /usr/lib/kde4/plugins/script/
}

# optimization OK
