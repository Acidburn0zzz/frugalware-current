# Compiling time: ~0.45 SBU
# Contributor: Laszlo Dvornik <dvornik@gnome.hu>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=openttd
pkgver=0.5.2
pkgrel=1
pkgdesc="An open source clone of the Microprose game Transport Tycoon Deluxe"
_F_sourceforge_ext="-source.tar.gz"
Finclude sourceforge
url="http://www.openttd.com/"
depends=('sdl' 'libpng')
groups=('games-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.openttd.com/downloads.php |grep latest |sed -ne 's/.*is \(.*\),.*/\1/;1p'"
source=($source $pkgname.desktop README.Frugalware \
	http://$_F_sourceforge_mirror.dl.sourceforge.net/openttd/openttd-0.5.0-scenarios.tar.bz2 \
	http://$_F_sourceforge_mirror.dl.sourceforge.net/openttd/openttd-0.4.8-scenarios.tar.bz2)

build() {
	#scenarios
	SDIR="/usr/share/$pkgname/scenario"
	Fmkdir $SDIR
	mv $Fsrcdir/$pkgname-0.4.8-RC1-scenarios/*.scn $Fdestdir/$SDIR || Fdie
	mv $Fsrcdir/*.scn $Fdestdir/$SDIR || Fdie

	Fcd $pkgname-$pkgver
	make PREFIX=/usr INSTALL=1 BINARY_DIR=bin \
		DATA_DIR=share/openttd PERSONAL_DIR=.openttd \
		USE_HOMEDIR=1 RELEASE=$pkgver ICON_DIR=share/openttd \
		WITH_PNG=1 WITH_ZLIB=1 WITH_NETWORK=1 UNIX=1 || Fdie
	make DEST_DIR=$Fdestdir install || Fdie
	Ffile /usr/share/applications/openttd.desktop
	Fdoc README.Frugalware
	#make info 
}
sha1sums=('6b56153ae88b2830f9852ae9e7c5d6ced9d8cb98'\
          '2461241ca67d122d5da4466a59899ae221282227'\
          'f4fbcdeb9109489bf69e0976c68955381ff6d6d6'\
          '965fc34bbe9998741ea07531772c9673b33aab99'\
          '88b3caff739fbf7bd4eb143ae97925556e813ce4')

# optimization OK
