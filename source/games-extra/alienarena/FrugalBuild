# Compiling Time: 0.25 SBU
# Maintainer: Devil505 <devil505linux@gmail.com>

pkgname=alienarena
pkgver=20100504
pkgrel=1
gamever=7_40
pkgdesc="Multiplayer retro sci-fi deathmatch game"
url='http://icculus.org/alienarena/rpa/'
depends=('curl' 'libgl' 'libjpeg' 'libxxf86dga' 'libxxf86vm' 'libvorbis' 'sdl' 'openal' 'freeglut')
makedepends=('pkgconfig' 'unzip' 'hd2u')
groups=('games-extra')
options=('nobuild')
archs=('i686' 'x86_64')
up2date="Flastarchive http://icculus.org/alienarena/Files/ .zip | sed 's/linux//g'"
source=(http://icculus.org/alienarena/Files/${pkgname}-linux${pkgver}.zip)
sha1sums=('9c982d097d885af0cbd06bfbe6c4185936c43c4d')

_F_desktop_name="Alien Arena"
_F_desktop_desc="Multiplayer retro sci-fi deathmatch"
_F_desktop_icon="$pkgname"
_F_desktop_categories="Game;ActionGame;"

build() {
    Fcd "${pkgname}${gamever}/source"

    make PREFIX=/usr \
	WITH_DATADIR=yes WITH_LIBDIR=yes \
	DATADIR="/usr/share/$pkgname" LIBDIR="$/usr/lib/$pkgname" \
     || Fdie


    Finstallrel 755 release/game.so /usr/lib/$pkgname/arena/game.so
    Fexerel release/crx usr/bin/$pkgname
    Fexerel release/crded usr/bin/${pkgname}-ded

    cd .. || Fdie

    # Data files
    find arena botinfo data1 -type f | while read _f ; do
    install -D -m644 "$_f" "$Fdestdir//usr/share/$pkgname/$_f" || Fdie
    done

    # Desktop entry
    Finstallrel 644 aa.png usr/share/pixmaps/$pkgname.png
    Fdesktop2

    # Docs
    pwd
    cd docs  || Fdie
    dos2unix readme.txt  || Fdie
    Fdocrel {license,readme}.txt
}


# optimization OK
