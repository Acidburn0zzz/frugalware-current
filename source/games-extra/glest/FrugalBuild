# Compiling Time: 0.83 SBU
# Maintainer: Priyank Gosalia <priyankmg@gmail.com>

pkgname=glest
pkgver=2.0.1
pkgrel=2
pkgdesc="Cross-platform 3D realtime strategy game."
_F_sourceforge_ext=".zip"
Finclude sourceforge
url="http://www.glest.org/"
makedepends=('jam' 'hd2u')
rodepends=('glest-data')
depends=('sdl' 'libogg' 'libvorbis' 'openal' 'xerces-c>=2.8.0' 'libxt' 'libx11' 'mesa' 'corefonts')
groups=('games-extra')
archs=('i686' 'x86_64')
options=('scriptlet')
up2date="lynx -dump $url/en/downloads.html | grep -m1 glest | sed 's/.*t_\(.*\).ex.*/\1/'"
source=(${source/glest-/glest_source_} $pkgname $pkgname.png)
Fprefix="/usr/share"
sha1sums=('20625eb567de3de9e3f2c5ec91e6c5da0dd6dca8' \
          '8a0b4eb824a4ecd48cda3b836f60570188bdd096' \
          'ebc17786df24dd19c375f112a02ed6f35ab77ce1')

build()
{
	for i in `find $Fsrcdir/{source,mk} -type f`; do dos2unix $i; done
	cd $Fsrcdir || Fdie
	cd mk/linux || Fdie
	chmod a+x *.sh || return 1
	Fmkdir usr/{share/glest,bin}
	if [[ ! -e configure ]] ; then
	./autogen.sh || die "autogen failed"
	fi

	# Lets build glest
	Fconf
	jam || return 1

	# Install glest
	Finstallrel 755 glest usr/share/glest/
	Fsed 'utopia' 'arial' glest.ini
	Ffilerel glest.ini usr/share/glest/
	Finstall 0755 glest usr/bin/glest
	Fexe /usr/share/pixmaps/$pkgname.png
	Fdesktop "/usr/bin/$pkgname" "/usr/share/pixmaps/$pkgname.png" "Qt;Gtk;Game;StrategyGame;"
}

# optimization OK
