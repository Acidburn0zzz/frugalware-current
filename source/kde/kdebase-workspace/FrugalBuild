# Compiling Time: 17.03 SBU
# Maintainer: DeX77 <dex@dragonslave.de>

pkgname=kdebase-workspace
pkgrel=8
pkgdesc="Programs specific for the KDE4 desktop."
groups=('kde')
archs=('i686' 'x86_64')
_F_cmakekde_final=OFF
_F_kde_split_docs=1
_F_cmake_confopts="-DKDE4_COMMON_PAM_SERVICE=system-auth"
Finclude kde
rodepends=('kde-frugalware>=1.2')
depends=('consolekit' 'libusb' 'libxcomposite' 'libxdamage' \
	'libxklavier>=4.0' 'libxxf86misc' 'lmsensors' 'libxtst' \
	"kdebase-runtime>=$_F_kde_ver" "kdepimlibs>=$_F_kde_ver" \
	'polkit-qt' 'qimageblitz' 'xdg-utils' 'dbus-x11' 'libxscrnsaver')
makedepends=("${makedepends[@]}" 'boost' 'bluez-libs' 'sip>=4.10' 'pyqt4>=4.7' \
	"kdebindings>=$_F_kde_ver" 'xrdb')
## xrdb needed by font part .. from code in fonts.cpp ->:
## " proc << "xrdb" << "-quiet" << "-remove" << "-nocpp"; "
source=("${source[@]}" \
	systemsettings-root.patch \
	kdm-make_it_cool.diff\
	default-fonts.patch)
replaces=('ksensors' 'katapult' 'tastymenu' 'kbfx' 'kdesktop-menu' \
	'kicker-compiz' 'taskbar-compiz' 'mtaskbar' 'ksmoothdock')
sha1sums=('5b43447139d22247d5bc2deee8e3a944447f0bbf' \
          'da461b91ab3ffaa5d29e2c88448ed61ed280b652' \
          '5b16b82ff8f0084d15db9adf98c423906ff816e9' \
          '03a6acd95841885d684fc05f53566a0e36dd600a')


subpkgs=("$pkgname-docs" "$pkgname-wallpapers")
subdescs=("Kdebase Workspace Documentation" "Kdebase Workspace Wallpapers")
subdepends=('' '')
subgroups=('docs-extra kde-docs' 'kde-extra')
subarchs=('i686 x86_64' 'i686 x86_64')


build()
{
	KDE_build

	## No go 48MB extra wallpapers ..
	## Kill from here and move to subpackage...
	## Keep Air but that is..
	find "$Fdestdir/usr/share/wallpapers" -maxdepth 1 -type d|grep -v Air | grep [A-Z]| sed 's/.*pkg\///1' >wall_list || Fdie
	Fmessage "Moving the following Wallpapers to $pkgname-wallpapers"
	cat wall_list || Fdie
	for i in `cat wall_list`
	do
		Fsplit $pkgname-wallpapers $i
	done

	## kdmrc should be in kde-fw package ( need to finish some kde-fw package first )
	Fmv /etc/kde/config/kdm/kdmrc /etc/kde/config/kdm/kdmrc-kde4-$pkgver.orig

}
# optimization OK

