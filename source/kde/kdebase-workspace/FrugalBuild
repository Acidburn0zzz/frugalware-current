# Compiling Time: 17.03 SBU
# Maintainer: DeX77 <dex@dragonslave.de>

pkgname=kdebase-workspace
pkgrel=1
pkgdesc="Programs specific for the KDE4 desktop."
groups=('kde')
archs=('i686' 'x86_64' 'ppc')
_F_kde_subpkgs_custom_path=1
_F_kde_split_docs=1
Finclude kde
rodepends=("${rodepends[@]}" 'xorg-server>=1.6.1' 'kde-frugalware>=4.3' \
	'xsetroot' 'xmessage' 'xrandr' 'xset' 'xprop' 'xrdb')
depends=('consolekit-x11' 'libusb' 'libxcomposite' 'libxdamage' \
	'libxklavier>=4.0' 'libxxf86misc' 'lmsensors' 'libxtst' \
	"kdebase-runtime>=${_F_kde_ver}" "kdepimlibs>=${_F_kde_ver}" \
	'polkit-qt-1>=0.95' 'qimageblitz' 'xdg-utils' 'dbus-x11' 'libxscrnsaver' "kdelibs>=${_F_kde_ver}" \
	'libggadget' 'libggadget-qt' 'consolekit-x11')
makedepends=("${makedepends[@]}" 'boost' 'bluez>=4.61' 'gpsd')
## xrdb needed by font part .. from code in fonts.cpp ->:
## " proc << "xrdb" << "-quiet" << "-remove" << "-nocpp"; "
source=("${source[@]}" \
	xinitrc.kde \
	kde.desktop \
	kde.pamd \
	kde-np.pamd \
        04-systemsettings-root.patch \
        05-Suse-kdm-make_it_cool.diff \
        07-kspalsh-fix.patch \
        10-kxftconfig-defaults.patch \
        12-cursors-location.patch \
        kwin-KDE3-is-gone.patch \
        kcontrol-kthememanager-gone.patch \
	14-PyKde4.patch)
replaces=('ksensors' 'katapult' 'tastymenu' 'kbfx' 'kdesktop-menu' \
	'kicker-compiz' 'taskbar-compiz' 'mtaskbar' 'ksmoothdock' \
	'kompose' 'dbus-qt3' 'katapult' 'compiz-kde')
sha1sums=('f72e0e31c2ea4dc377e7fc14f2a0f5fb6304e71e' \
          '81092d3c9cfc08de1ac63c8318f0f1391501fb8d' \
          'e1f706c984fc81633663c662e674b6f2c64d2f83' \
          '9ff7d6cf01f42d513cf16a0d2c302cadde38f857' \
          '4632f6e2a199f91f8aa068e0335dbae43813aaed' \
          'cb5353c2238cc8c38f4dda8eb51373fe7ea17428' \
          '5b16b82ff8f0084d15db9adf98c423906ff816e9' \
          'be19f30fcffd85e899d7557c4b483d5c16f15b7e' \
          'ff0ffac7528cf3a0c51f1f31933ac0ea059396b3' \
          '454f18f51d225d8e9c05985ea42a0a713727f964' \
          '45d16ed762567bd48ef216a11804bb9f5c61bfce' \
          '2d98bfd2e01c13a15568afb83049f5acb64cd842' \
          '5fa17cf59d4a3eec413b44ef2abf11ed43da668a')

subpkgs=("${subpkgs[@]}" "kdm")
subdescs=("${subdescs[@]}" "KDE Display Manager")
subdepends=("${subdepends[@]}" "kdelibs>=$_F_kde_ver")
subgroups=("${subgroups[@]}" 'kde')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-wallpapers")
subdescs=("${subdescs[@]}" "Kdebase Workspace Wallpapers")
subdepends=("${subdepends[@]}" '')
subgroups=("${subgroups[@]}" 'kde-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-extra-cursors")
subdescs=("${subdescs[@]}" "Kdebase Workspace Big Cursors")
subdepends=("${subdepends[@]}" '')
subgroups=("${subgroups[@]}" 'kde-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

subpkgs=("${subpkgs[@]}" "$pkgname-docs")
subdescs=("${subdescs[@]}" "Kdebase Workspace Documentation")
subdepends=("${subdepends[@]}" '')
subgroups=("${subgroups[@]}" 'docs-extra kde-docs')
subarchs=("${subarchs[@]}" 'i686 x86_64 ppc')

rodepends=("${rodepends[@]}" "kdm=${_F_kde_ver}")

build()
{
	KDE_make

	## Do all manually ..
	KDE_project_install kdm

	Finstall 0544 kde.pamd /etc/pam.d/kde
	Finstall 0544 kde-np.pamd /etc/pam.d/kde-np
	Ffile /etc/X11/sessions/kde.desktop
	Fsplit kdm /\*

	## No go 48MB extra wallpapers ..
	## Kill from here and move to subpackage...
	## Keep Air but that is..

	KDE_project_install wallpapers
	Frm usr/share/wallpapers/Air*
	Fsplit $pkgname-wallpapers /\*

	KDE_project_install cursors
	Fsplit $pkgname-extra-cursors /usr/share/icons/Oxygen_*_Big

	## xinitrc for KDE.
        Fexe /etc/X11/xinit/xinitrc.kde

	KDE_install

	## default ksplash ...
        Fmv /usr/share/apps/ksplash/Themes/Default /usr/share/apps/ksplash/Themes/Default.kde4
	Fsubmv kdm /etc/kde/config/kdm/kdmrc /etc/kde/config/kdm/kdmrc-kde4-$pkgver.orig

}

# optimization OK

