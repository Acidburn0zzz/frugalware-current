# Last Modified: Sat, 06 Aug 2005 15:06:51 +0200
# Compiling Time: ~6.17 SBU
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=qt
pkgver=3.3.4
pkgrel=4
pkgdesc="The QT GUI toolkit."
url="http://www.trolltech.com/products/qt"
install=qt.install
depends=('x' 'libpng' 'libjpeg')
groups=('kde' 'kde-lib')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.trolltech.com/download/qt/x11.html |grep current|sed 's/.*s \(.*\)\. .*/\1/'"
source=(ftp://ftp.trolltech.com/qt/source/$pkgname-x11-free-$pkgver.tar.bz2 \
	qt.sh qt-visibility.patch)
sha1sums=('cb5f452bcdc9d2ed0201481f4b8f152edfda9523' \
          'c969bbcefc2e176af693af85efdf05eafd983e92' \
          '233d1b2994274875199721b5d09487b9cfb1ef55')

export QTDIR=$startdir/src/$pkgname-x11-free-$pkgver
export PATH=${QTDIR}/bin:${PATH}
export LD_LIBRARY_PATH=${QTDIR}/lib:${LD_LIBRARY_PATH}

build()
{
	Fcd $pkgname-x11-free-$pkgver
	Fpatch qt-visibility.patch
	echo "yes" | ./configure -prefix /usr/lib/qt-$pkgver -system-zlib \
		-qt-gif -system-libpng -system-libjpeg -plugin-imgfmt-mng \
		-thread -no-stl -no-g++-exceptions 
	Fsed ' *strip.*doc/html.*$' '#' src/Makefile
	Fsed "-O2" "${CFLAGS} -fPIC" mkspecs/linux-g++/qmake.conf

	make || return 1
	
	make INSTALL_ROOT=$Fdestdir install
	Fexe /etc/profile.d/qt.sh
	Fln qt-$pkgver /usr/lib/qt
}

# vim: ft=sh

# optimalization OK
