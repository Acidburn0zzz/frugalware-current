# Compiling Time: 12.85 SBU
# Maintainer: DeX77 <dex@dragonslave.de>

pkgname=kdenetwork
pkgrel=5
pkgdesc="KDE Networking Programs"
depends=('kdebase-workspace>=4.3.2' 'libvncserver' 'libidn' \
	'qca' 'rdesktop' 'ppp' 'libxdamage')
makedepends=('pkgconfig' 'automoc4' 'boost' 'xmms')
groups=('kde')
archs=('i686' 'x86_64')
_F_cmakekde_final=OFF
Finclude kde
source=("$_F_kde_mirror/$_F_kde_dirname/$_F_kde_name-$_F_kde_pkgver.tar.bz2"\
	"find_libortp.patch" "find_libgadu.patch" \
	"duplicate_contacts_fix.patch" )

sha1sums=('7b384e11b551c9d1113cc39d318ca1b9d7712864' \
          '306e8f8c6fa6f088923496d110589d9bce2434a6' \
          '0ad2fe189ddadbcde4dacf4b0c2dd2082635e836' \
          '6b9ca5ae09c1f9150b81c98b60b919a36fc31bcc')


subpkgs=("$pkgname-docs" 'kopete')
subdescs=("Kdenetwork Documentation" "Kopete is a multi-protocol instant messenger for the KDE Desktop.")
subdepends=('' \
"ortp meanwhile speex libotr libidn libgadu libmsn qca-tls libv4l")
subgroups=('docs-extra kde-docs' 'kde')
subarchs=('i686 x86_64 ppc' 'i686 x86_64 ppc')

build(){
	#cd in
	Fcd $_F_cd_path

	#build kopete
	cd kopete || Fdie
	CMake_prepare_build
	CMake_conf
	make DESTDIR=$Fdestdir install || Fdie
	Fsplit kopete /usr /etc

	#now the rest
	cd ../..
	_F_cmake_confopts=-DBUILD_kopete=OFF
        if [ -d  "build" ]; then
	  rm -rf build || Fdie
	  mkdir build || Fdie
          cd build || Fdie
        else
          mkdir build || Fdie
          cd build || Fdie
	fi
	
	CMake_conf
	make DESTDIR=$Fdestdir install || Fdie

	#docs
	Fsplit $pkgname-docs usr/share/doc/HTML
}
# optimization OK
