# Compiling Time: 0.27 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=gammu
pkgver=1.10.3
pkgrel=1
pkgdesc="Mobile phones tools for Unix (Linux)"
url="http://www.gammu.org/wiki/index.php?title=Gammu:Main_Page"
backup=(etc/gammu/gammurc)
depends=('libmysqlclient' 'bluez-libs>=3.9' 'openssl') # depend to openssl too, if we drop mysql support
makedepends=('mysql')
groups=('apps-extra')
archs=('x86_64' 'i686')
up2date="lynx -dump http://dl.cihar.com/gammu/releases/|Flasttarbz2"
source=(http://dl.cihar.com/gammu/releases/$pkgname-$pkgver.tar.bz2)

build() {
	Fsed "-O2 -fPIC -Wall -Wno-format-y2k -pthread" "$CFLAGS -fPIC -Wno-format-y2k -pthread" cfg/Makefile.cfg
	Fsed "-lbluetooth -lsdp" "-lbluetooth" cfg/Makefile.cfg
	Fsed "/etc/gammurc" "/etc/gammu/gammurc" common/gsmstate.c
	Fconf --sysconfdir=/etc/gammu --enable-cb \
		--enable-7110incoming --enable-6210calendar \
		--with-bluedir=/usr/lib --with-docdir=/usr/share/doc/$pkgname-$pkgver \
		--with-localedir=/usr/share/gammu --prefix=/usr
	Fsed "-lz  -pthread" "-lz  -lpthread -lssl" cfg/Makefile.cfg
	make || Fdie
	make DESTDIR=$Fdestdir installshared || Fdie
	Ffilerel docs/examples/config/gammurc /etc/gammu/gammurc
	chmod +x $Fdestdir/usr/lib/libGammu.so.* || Fdie
}

sha1sums=('efc72aca54543510ee35dbc120401f83d01d8f14')
