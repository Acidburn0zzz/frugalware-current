# Compiling Time: 1.30 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=user-mode-linux
pkgver=2.6.22
patchlevel=.1
pkgrel=1
pkgdesc="A safe, secure way of running Linux versions and Linux processes."
url="http://user-mode-linux.sourceforge.net/"
depends=('uml_utilities')
groups=('apps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.kernel.org/kdist/finger_banner |sed -n 's/.* \([0-9]*\.[0-9]*\.[0-9]*\).*/\1/;1 p'"
# check http://uml.nagafix.co.uk/kernels for configs
source=(ftp://ftp.kernel.org/pub/linux/kernel/v2.6/linux-$pkgver$patchlevel.tar.bz2 \
	config.i686 config.x86_64 README.Frugalware linux-2.6.22-aio.diff)
signatures=($source.sign '' '' '' '')

build()
{
	Fcd linux-$pkgver$patchlevel
	Fpatchall
	cp $Fsrcdir/config.$CARCH .config
	Fsed "EXTRAVERSION =.*" "EXTRAVERSION = -fw$pkgrel" Makefile
	export LDFLAGS="${LDFLAGS/-Wl,/}"
	make linux ARCH=um || return 1
	Fexerel /usr/bin/linux
	Fdoc README.Frugalware
}
