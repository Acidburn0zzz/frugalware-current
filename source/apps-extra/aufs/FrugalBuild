# Compiling Time: 0.01 SBU
# Maintainer: Janny <janny@frugalware.org>

pkgname=aufs
pkgver=cvs20070228
pkgrel=1
pkgdesc="Aufs -- Another Unionfs"
depends=('kernel-fwlive' 'zlib')
groups=('apps-extra')
archs=('i686' 'x86_64')
Finclude sourceforge
Finclude kernel-module
up2date=$pkgver
source=(http://ftp.frugalware.org/pub/other/sources/aufs/$pkgname-$pkgver.tar.bz2)
options=('force' 'scriptlet')
sha1sums=('127bd09f67601d8198f4f52f5ad9f1cb68b43ab1')

build()
{
	Fcd
	cat local.mk | grep -v "^CONFIG_AUFS_DEBUG =" \
	 | grep -v "^CONFIG_AUFS_COMPAT =" \
	 | sed "s/#CONFIG_AUFS_KSIZE_PATCH/CONFIG_AUFS_KSIZE_PATCH/" \
	 | sed "s/#CONFIG_AUFS_LHASH_PATCH/CONFIG_AUFS_LHASH_PATCH/" >Makefile
	make KDIR=/usr/src/linux
	Ffilerel /lib/modules/`uname -r`/kernel/fs/aufs/aufs.ko
}

# optimization OK
