# Compiling Time: 0.01 SBU
# Maintainer: Janny <janny@frugalware.org>

pkgname=aufs
pkgver=cvs20070715
kver=2.6.22-1
pkgrel=1
pkgdesc="Aufs -- Another Unionfs"
depends=('zlib' "kernel-fwlive=$kver")
makedepends=("kernel-fwlive-source=$kver")
groups=('apps-extra')
archs=('i686' 'x86_64')
#_F_kernel_name="-fwlive"
Finclude sourceforge
up2date=$pkgver
source=(http://ftp.frugalware.org/pub/other/sources/aufs/$pkgname-$pkgver.tar.bz2)
options=('force' 'scriptlet')
sha1sums=('ce84034584a3a966a0041bf4cc6add7d0aaeac55')

build()
{
	Fcd
	cat local.mk | grep -v "^CONFIG_AUFS_DEBUG =" \
	 | grep -v "^CONFIG_AUFS_COMPAT =" \
	 | sed "s/#CONFIG_AUFS_KSIZE_PATCH/CONFIG_AUFS_KSIZE_PATCH/" \
	 | sed "s/#CONFIG_AUFS_LHASH_PATCH/CONFIG_AUFS_LHASH_PATCH/" >Makefile
	make KDIR=/usr/src/linux
	Ffilerel /lib/modules/${kver/-/-fw}/kernel/fs/aufs/aufs.ko
}

# optimization OK
