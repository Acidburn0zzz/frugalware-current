# Compiling Time: 0.01 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=j2me
pkgver=2.2_1
basever=${pkgver/_*}
updatever=${pkgver#*_}
pkgrel=1
pkgdesc="Java 2 Micro Edition Wireless Toolkit for developing wireless applications"
url="http://java.sun.com/products/j2mewtoolkit/"
rodepends=('j2sdk')
groups=('apps-extra')
archs=('i686')
# comments to this khm.. ugly up2date :)
# 1) first check for basever, that's basically normal
# 2) when basever is okay, check for the update. on the website there is only a
# date, but the filename is a number, so on every update you must update the
# s/date/number/ command
up2date="echo \$(lynx -dump http://java.sun.com/javame/downloads/index.jsp|grep \
'Wireless Toolkit'|grep -v CLDC|sed 's/.* \([0-9][^ ]*\)/\1/;q')_\$(lynx -dump \
http://java.sun.com/products/sjwtoolkit/download-${basever/./_}.html|grep \
patch|sed 's/.*patch \([0-9]*\) .*/\1/;s/200511/1/;q')"
# download them from http://java.sun.com/products/sjwtoolkit/download-2_2.html
source=(j2me_wireless_toolkit-${basever/./_}-linux-i386.bin \
	j2me_wireless_toolkit-${basever/./_}-update_$updatever-linux.zip)
options=('nobuild')

build()
{
	dd bs=2048 if=j2me_wireless_toolkit-${basever/./_}-linux-i386.bin of=j2me.zip skip=10
	unzip -qqo j2me.zip
	unzip -qqo j2me_wireless_toolkit-${basever/./_}-update_$updatever-linux.zip
	Fmkdir /usr/{bin,lib/j2me}
	cp -a appdb bin lib wtklib $Fdestdir/usr/lib/j2me
	chmod 755 $Fdestdir/usr/lib/j2me/bin/*
	chmod 644 $Fdestdir/usr/lib/j2me/bin/*.jar
	Fdocrel *.html docs
	Fln /usr/lib/j2me/bin/ktoolbar /usr/bin/ktoolbar
}

sha1sums=('fa9888ab2a7486be1b168e395e0aa40ca0103f14' \
	  'd83a9b6a7c253633d37619b2796f4aa271bd57f0')
