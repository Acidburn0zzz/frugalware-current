# Compiling Time: 0.01 SBU
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=asciidoc
pkgver=8.3.0
pkgrel=3
pkgdesc="AsciiDoc is a text document format for writing short documents, articles, books and UNIX man pages."
url="http://www.methods.co.nz/asciidoc/index.html"
depends=()
rodepends=('python' 'libxslt')
groups=('apps-extra')
archs=('i686' 'x86_64' 'ppc')
up2date="lynx -dump http://www.methods.co.nz/asciidoc/downloads.html |Flasttar"
source=(http://www.methods.co.nz/asciidoc/asciidoc-$pkgver.tar.gz \
	http://ftp.frugalware.org/pub/other/sources/asciidoc/asciidoc-fonts-0.1.tar.bz2 \
	README.Frugalware \
	baf9c1979fb1.patch 2f2256c31fbe.patch)
sha1sums=('22fec74428e52191b837568e4bff53988be6fabc' \
          '717779406f876f439ac37c79878f403ecdef3467' \
          '31d7a38de67fd8d2492b8a07d64721491b69d1ea' \
          '4ba8dbe478a49290587aa8af0b2a602cae651fe1' \
          '507bdbbcb2825f5056aa04a7f04f9055086d96b2')

build() {
	Fpatchall
	Fmkdir $Fprefix/bin $Fprefix/share/vim
	Fsed 'BINDIR=/usr/local/bin' "BINDIR=$Fdestdir/$Fprefix/bin" install.sh
	Fsed 'MANDIR=/usr/local/man' "MANDIR=$Fdestdir/$Fprefix/man" install.sh
	Fsed 'CONFDIR=/etc/asciidoc' "CONFDIR=$Fdestdir/$Fsysconfdir/asciidoc" install.sh
	Fsed 'VIM_CONFDIR=/etc/vim' "VIM_CONFDIR=$Fdestdir/$Fprefix/share/vim" install.sh
	# enable offline build
	Fsed 'http://www.oasis-open.org/docbook/xml/' 'file:///usr/share/sgml/docbook/dtd/xml-dtd-' docbook.conf
	sh install.sh
	Fdocrel doc/*
	# install the mathml fonts
	Fmkdir /usr/lib/X11/fonts/TTF
	Ffile asciidoc-fonts-0.1/*.ttf /usr/lib/X11/fonts/TTF
}
