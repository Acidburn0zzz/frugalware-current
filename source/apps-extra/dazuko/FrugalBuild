# Compiling time: 0.01 SBU
# Maintainer: Janny <janny@frugalware.org>
 
pkgname=dazuko
pkgver=2.3.2
pkgrel=7
pkgdesc="On-access virus scanning kernel interface"
url="http://www.dazuko.org"
license="GPL-2 BSD"
Finclude kernel-module
archs=('i686' 'x86_64')
groups=('apps-extra')
up2date="lynx -dump '$url/files/?M=O' | grep -v source |grep -v birthday|grep -v pre|Flasttar"
source=(http://www.dazuko.org/files/$pkgname-$pkgver.tar.gz \
	README.Frugalware \
	dazuko-2.3.2-linux-2.6.20.patch)
 
build() {
	Fcd
	# Patch needed by some F-Secure softwares
	patch -p0 < patch_fsecure_init_event.diff || Fdie
	# no Fcheckkernel, crosscompilation verified
	Fpatchall
	Fsed '`uname -r`' "$_F_kernelmod_uname" configure
	find . -type f -exec sed -i '/#include <linux\/config.h>/d' {} \;
	./configure --system=linux26 --disable-chroot-support \
		--without-dep --enable-event-init-module || Fdie
	make || Fdie
	Ffilerel $_F_kernelmod_dir/extra/$pkgname.ko
	make -C library || Fdie
	Ffile $pkgname-${pkgver//_/-}/library/libdazuko.a /usr/lib/libdazuko.a
	Fdoc README.Frugalware
}

sha1sums=('a0c404062d3eb0f095aa4fc75f6279f61a5e8700'\
          'c3eefee5bb64ebb52fa5862d48c79da17153e8e7'\
          'b6064b7e68bb050fa9994ed5aab9c8ab62dcdf61')
