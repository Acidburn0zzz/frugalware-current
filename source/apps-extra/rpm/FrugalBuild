# Compiling Time: 3.42 SBU
# Contributor: VMiklos <vmiklos@frugalware.org>
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=rpm
pkgver=5.0.3
pkgrel=1
pkgdesc="Red Hat Package Manager"
url="http://rpm5.org"
depends=('heimdal>=1.0.2' 'pcre' 'sqlite3' 'popt' 'beecrypt' 'bzip2' 'neon' 'sqlite2' 'xfsprogs-acl' 'libxml2')
groups=('apps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://rpm5.org/|grep -m1 'RPM version \(.*\) released'|sed 's/.*on \(.*\) .*re.*/\1/'"
source=(http://rpm5.org/files/$pkgname/$pkgname-5.0/$pkgname-$pkgver.tar.gz)
sha1sums=('d3461710de17a8f7dc3e49371d7edf620b10c27e')

build()
{

	Fpatchall
	Fconf \
		--without-selinux \
		--with-perl \
		--with-python \
		--with-bzip2=external \
		--with-beecrypt=external \
		--with-neon=external \
		--with-db=internal \
		--with-sqlite=external \
		--with-popt=external \
		--with-file=internal \
		--with-xar=internal \
		--with-pcre=external \
		--disable-dependency-tracking \
		--libdir=/usr/lib \
		--with-openssl=external
	
	make || Fdie
	Fmakeinstall	
	# fixes bug "can't create transaction lock"	
	Fmkdir /var/lock/rpm
}

# optimization OK
