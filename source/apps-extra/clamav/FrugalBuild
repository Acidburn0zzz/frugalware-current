# Compiling Time: 0.51 SBU
# Maintainer: Janny <janny@frugalware.org>

pkgname=clamav
pkgver=0.91.2
pkgrel=2sayshell1
pkgdesc="Clam AntiVirus is a GPL anti-virus toolkit for UNIX"
depends=('gmp' 'bzip2' 'curl>=7.16.0')
rodepends=('shadow')
backup=(etc/{freshclam,clamd}.conf)
groups=('apps-extra')
archs=('i686' 'x86_64')
Finclude sourceforge
source=($source rc.clamav rc.clamav-hu.po \
	clamav-0.91.2-CVE-2007-6335.patch \
	clamav-0.91.2-CVE-2007-6336.patch \
	clamav-0.91.2-CVE-2007-6337.patch)
sha1sums=('f18007c3045a1d78967adad805c6934d46ca6419' \
          '90b22c99927b56992ac05042029d2702db79a8b0' \
          '57d36966c45adfd6b3ebd10b91874194924ab2c3' \
          '48707d513348dd87ff74beaff7370a91a097acec' \
          '482fa318c9d1172c1a2b3a652936e8a417e11817' \
          'e02199c35043a1811a077e7fb6a7044dd820d12b')

build()
{
	Fbuild --disable-clamav --sysconfdir=/etc
	Fsed '^Example' '# Example' $Fdestdir/etc/{clamd,freshclam}.conf
	Fsed '^#LogFile' 'LogFile'  $Fdestdir/etc/clamd.conf
	Fsed '/tmp/clamd.log' '/var/log/clamd.log' $Fdestdir/etc/clamd.conf
	Fsed '^#DatabaseDirectory' 'DatabaseDirectory' $Fdestdir/etc/{clamd,freshclam}.conf
	Fsed '/usr/share/clamav' '/var/lib/clamav' $Fdestdir/etc/{clamd,freshclam}.conf
	Fsed '/var/log/' '/var/log/clamav/'  $Fdestdir/etc/{clamd,freshclam}.conf
	Fsed '/var/run/' '/var/run/clamav/' $Fdestdir/etc/{clamd,freshclam}.conf
	Frm /usr/share/clamav
	Fmkdir /var/{run,log,lib}/clamav
	chown 26.26 $Fdestdir/var/{run,log,lib}/clamav || Fdie
	Frcd2
}

# optimization OK
