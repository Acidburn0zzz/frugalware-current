===================================================================
RCS file: /repo/OpenLDAP/pkg/ldap/servers/slapd/back-bdb/modrdn.c,v
retrieving revision 1.197
retrieving revision 1.198
diff -p -u -r1.197 -r1.198
--- ldap/servers/slapd/back-bdb/modrdn.c	2008/01/11 03:01:37	1.197
+++ ldap/servers/slapd/back-bdb/modrdn.c	2008/02/07 11:06:24	1.198
@@ -739,6 +739,8 @@ retry:	/* transaction retry */
 		} else {
 			rs->sr_err = LDAP_X_NO_OPERATION;
 			ltid = NULL;
+			/* Only free attrs if they were dup'd.  */
+			if ( dummy.e_attrs == e->e_attrs ) dummy.e_attrs = NULL;
 			goto return_results;
 		}
 
