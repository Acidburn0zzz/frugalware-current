# Compiling Time: 0.97 SBU
# Maintainer: Janny <janny@frugalware.org>

pkgname=mutt-ng
pkgver=20070514
muttver=1.5.15
pkgrel=1
pkgdesc="A fork of the well-known email client mutt."
url="http://mutt-ng.berlios.de"
groups=('network-extra')
archs=('i686' 'x86_64')
depends=('openssl' 'gdbm' 'libidn' 'gpgme' 'ncurses')
makedepends=('tetex' 'libxslt' 'docbook-xml' 'docbook-xsl')
conflicts=('mutt' 'mutt-devel')
backup=(etc/Muttrc)
options=('scriptlet')
up2date="svn log --limit 1 http://bereshit.synflood.at/svn/mutt-patches/trunk|sed -n 's/[^|]*|[^|]*| \([^ ]*\) .*/\1/;s/-//g;2p'"
source=(ftp://ftp.mutt.org/mutt/devel/mutt-$muttver.tar.gz \
	http://ftp.frugalware.org/pub/other/sources/mutt-ng/mutt-patches-$pkgver.tar.gz \
	CVE-2007-2683.diff)
sha1sums=('1adabf6e07e099bb664c83e3c0100bbbdfec7a9a' \
          'bb5c208890c8e872912ad76c5b2d8f531858eb22' \
          '4d458de180b57558c41450992b5d78ce8b3040f0')

build() 
{
	Fcd mutt-${muttver}
	for muttng in $(cat ../mutt-patches-$pkgver/patches/series | cut -d ' ' -f 1)
	do
		Fpatch mutt-patches-$pkgver/patches/${muttng}
	done
	autoreconf --install --include=m4 || Fdie
	Fsed '-muttng' '-muttng-frugalware' sendlib.c
	Fbuild --with-docdir=/usr/share/doc/$pkgname-$pkgver --with-ssl --enable-gpgme \
	--enable-pgp --enable-smime --with-regex --enable-pop --enable-imap --enable-debug \
	--enable-nntp --enable-imap-edit-threads --enable-hcache --enable-nfs-fix \
	--enable-buffy-size --enable-mailtool --enable-compressed
	Ffilerel {PATCHES,ABOUT-NLS,OPS,OPS.{CRYPT,MIX,PGP,SMIME}} /usr/share/doc/$pkgname-$pkgver
}

# optimization OK
