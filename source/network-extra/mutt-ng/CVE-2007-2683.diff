
# HG changeset patch
# User Jonathan Smith <https://issues.rpath.com/>
# Date 1179873167 14400
# Node ID 736653ce1896d754da5771458af0c6f68c4cf17c
# Parent 3d1d7f6cf693b610993860b2495fb3f01da97f88
merge changeset 47d08903b79b: Use signed arithmetic in mutt_gecos_name to avoid an overflow. Closes #2885.

--- a/muttlib.c	Mon Apr 02 15:20:58 2007 -0700
+++ b/muttlib.c	Tue May 22 18:32:47 2007 -0400
@@ -514,7 +514,7 @@ char *mutt_gecos_name (char *dest, size_
     if (dest[idx] == '&')
     {
       memmove (&dest[idx + pwnl], &dest[idx + 1],
-	       MAX(destlen - idx - pwnl - 1, 0));
+	       MAX((ssize_t)(destlen - idx - pwnl - 1), 0));
       memcpy (&dest[idx], pw->pw_name, MIN(destlen - idx - 1, pwnl));
       dest[idx] = toupper (dest[idx]);
     }

