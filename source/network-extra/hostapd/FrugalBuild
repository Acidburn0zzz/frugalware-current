# Compiling Time: 0.12 SBU
# Maintainer: James Buren <ryuo@frugalware.org>

pkgname=hostapd
pkgver=0.7.3
pkgrel=2
pkgdesc="A daemon for managing software wireless access points."
url="http://hostap.epitest.fi/hostapd"
depends=('openssl>=1.0.0' 'libnl>=3.2.9')
groups=('network-extra')
archs=('i686' 'x86_64')
up2date="Flasttar $url"
source=(${url/hostapd/releases}/$pkgname-$pkgver.tar.gz config rc.$pkgname README.Frugalware hostap_allow-linking-with-libnl-3.2.patch)
backup=(etc/$pkgname/$pkgname.{accept,conf,deny})
sha1sums=('7a8853fe41ee5a2b9f03f608cf7a61c7ccea4f4c' \
          '284e2146132ce79555d1317476792f800463760d' \
          'f4f0f2967b3fc68aec7121b489e5650de4d76c62' \
          '94c24e4311a366421592031cbb2ae67c41b4a880' \
          '69fbaac28aef4fbdac333c6ba4382567202c77b2')

build() {
	Fcd $pkgname-$pkgver
	Fpatchall
	cd $pkgname || Fdie
	cp $Fsrcdir/config .config || Fdie
	make || Fdie
	sed -i -r -e "s:#(.*)=/etc/$pkgname\.(accept|deny):\1=/etc/$pkgname/$pkgname.\2:" $pkgname.conf || Fdie
	Fexerel ${pkgname}{,_cli} /usr/bin
	Fmanrel ${pkgname}{.8,_cli.1}
	Ffilerel $pkgname.{accept,conf,deny,eap_user,radius_clients,sim_db,vlan,wpa_psk} wired.conf /etc/$pkgname
	Fdocrel README-WPS
	Frcd2
}
