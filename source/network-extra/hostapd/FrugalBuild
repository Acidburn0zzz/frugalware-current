# Compiling Time: 0.02 SBU
# Maintainer: James Buren <ryuo@frugalware.org>

pkgname=hostapd
pkgver=0.6.10
pkgrel=1
pkgdesc="A daemon for managing software wireless access points."
url="http://hostap.epitest.fi/hostapd"
depends=('openssl' 'libnl')
groups=('network-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump $url | grep -A 1 'Latest stable release' | Flasttar"
source=(${url/hostapd/releases}/$pkgname-$pkgver.tar.gz config rc.$pkgname README.Frugalware $pkgname-0.6.10-dtim.patch)
backup=(etc/$pkgname/$pkgname.{accept,conf,deny})
sha1sums=('2cacf994abd3cebad36679d32f64c9e9906ccff8' \
          'ba92a1bf132517f23c865142951e8d7b9d06f4f8' \
          'f4f0f2967b3fc68aec7121b489e5650de4d76c62' \
          '94c24e4311a366421592031cbb2ae67c41b4a880' \
          'efda5a29c3a9b2478960c30eb537d1b483636c3d')

build() {
	Fpatchall
	cd $pkgname || Fdie
	cp $Fsrcdir/config .config || Fdie
	make || Fdie
	sed -i -r -e "s:#(.*)=/etc/$pkgname\.(accept|deny):\1=/etc/$pkgname/$pkgname.\2:" $pkgname.conf || Fdie
	Fexerel ${pkgname}{,_cli} /usr/bin
	Fmanrel ${pkgname}{.8,_cli.1}
	Ffilerel $pkgname.{accept,conf,deny,eap_user,radius_clients,sim_db,vlan,wpa_psk} wired.conf /etc/$pkgname
	Frcd2
}
