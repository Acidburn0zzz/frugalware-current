# Compiling Time: 0.85 SBU
# Maintainer: CSÉCSY László <boobaa@frugalware.org>
# Contributor: Krisztian VASAS <iron@frugalware.org>

pkgname=ntp
pkgver=4.2.6p5
pkgrel=3arcturus2
pkgdesc="The ntp daemon from ntp.org"
url="http://www.ntp.org/"
conflicts=('openntpd')
groups=('network-extra')
archs=('i686' 'x86_64' 'arm')
depends=('openssl>=1.0.0' 'libedit')
up2date="lynx -dump http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ | grep -m1 'http.*tar.gz$' | sed 's/.*ntp-\(.*\)\.tar.*/\1/'"
source=(http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/$pkgname-$pkgver.tar.gz \
	ntp-4.2.6p1-nano.patch \
	ntpd.service \
	ntp.org.conf)
backup=(etc/ntp.org.conf)
sha1sums=('4a5353a4791b6f4315a66c28d504ec6c7926b192' \
          '21ecca90c622951fcb8469ee5822416bb6bf6a68' \
          'cc45d5cd82b38615f5606b38c280482dd2b00f0b' \
          '102821bd112d6d273403273b07bc9b65d70e8589')
_F_systemd_units=(ntpd=e)
Finclude systemd


# FSA fix ***
source=(${source[@]} CVE-2014-9293.patch CVE-2014-9294.patch CVE-2014-9295.patch
                     CVE-2014-9296.patch)
sha1sums=(${sha1sums[@]} '5898c58eb67fcee45d26c4b350405d800dcf7309' \
                         'cddcedeb928a980f070c216ea44e569fd9cf044d' \
                         '398b7b5999554fac2aacc406d992bfd132e11279' \
                         'e9a1c5ffb2408dcdd532796fa692d0394ef33cc5')
# ***********


build()
{
	Fbuild
	Ffile /etc/ntp.org.conf
	Fmkdir lib/systemd/system/
	Finstall 0644 ntpd.service /lib/systemd/system/ntpd.service
	Fgenscriptlet
}

# optimization OK
