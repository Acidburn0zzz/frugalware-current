diff -Naur miniupnpc-1.7/miniwget.c miniupnpc-1.7.new/miniwget.c
--- miniupnpc-1.7/miniwget.c	2012-05-01 22:11:49.000000000 +0200
+++ miniupnpc-1.7.new/miniwget.c	2014-07-18 11:08:22.462418000 +0200
@@ -157,7 +157,7 @@
 							chunked = 1;
 						}
 					}
-					while(header_buf[i]=='\r' || header_buf[i] == '\n')
+					while((i < (int)header_buf_used) && (header_buf[i]=='\r' || header_buf[i] == '\n'))
 						i++;
 					linestart = i;
 					colon = linestart;
