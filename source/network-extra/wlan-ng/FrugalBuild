# Last Modified: Thu, 07 Sep 2006 12:41:06 +0200
# Compiling Time: 0.33 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=wlan-ng
pkgver=0.2.3
realver=`echo $pkgver|sed 's/\([a-z]\+\)/-\1/'`
pkgrel=13
pkgdesc="Wireless Lan modules"
url="http://www.linux-wlan.org/"
Finclude kernel-module
depends=(${depends[@]} 'bash')
groups=('network-extra')
archs=('i686' 'x86_64')
backup=(etc/wlan/wlan.conf)
up2date="lynx -dump ftp://ftp.linux-wlan.org/pub/linux-wlan-ng/|grep tar.bz2$|sed -n 's/.*g-\(.*\)\.t.*/\1/;s/-//;$ p'"
source=(ftp://ftp.linux-wlan.org/pub/linux-wlan-ng/linux-$pkgname-$realver.tar.bz2 \
	rc.wlan 01-wlan-ng-0.2.3-linux-2.6.16.patch \
	02-wlan-ng-0.2.3-linux-2.6.17.patch)
sha1sums=('72fdb2d7af8e071db169b56df594d0ce8a91abc8' \
	  '3c50d5e942999a968437093a17e3864a4733e11e' \
	  '2bf7477a2e6cce8ae4f5308f11e0b8503aa1c758' \
	  'c812a1488df0b163def1731abbb7eaaa09edfa81')

build()
{
	# no Fcheckkernel, crosscompilation verified
	Fcd linux-$pkgname-$realver
	Fsed '`uname -r`' "$kernelbasever-fw$kernelrel" Configure
	Fsed "TARGET_ROOT_ON_HOST=" "TARGET_ROOT_ON_HOST=$Fdestdir" config.in
	Fsed "PRISM2_PLX=n" "PRISM2_PLX=y" config.in
	Fsed "PRISM2_PCI=n" "PRISM2_PCI=y" config.in
	Fsed "PRISM2_USB=n" "PRISM2_USB=y" config.in
	Fsed "PRISM2_PCMCIA=y" "PRISM2_PCMCIA=n" config.in
	Fpatchall
	make auto_config
	make all || return 1
	make install
	Fmv /usr/local/man /usr/man
	Frm /init.d
	Frcd wlan
}

# optimization OK
