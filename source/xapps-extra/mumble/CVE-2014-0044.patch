Description: Fix denial-of-service vulnerability
 CVE-2014-0044: A malformed Opus voice packet sent to a Mumble client
 could trigger a NULL pointer dereference or an out-of-bounds array
 access, leading to a crash (Denial of Service).
Origin: upstream
Last-Update: 2014-02-02
Applied-Upstream: 1.2.5

--- a/src/mumble/AudioOutputSpeech.cpp
+++ b/src/mumble/AudioOutputSpeech.cpp
@@ -151,8 +151,15 @@
 		int size;
 		pds >> size;
 		size &= 0x1fff;
+		if (size == 0) {
+			return;
+		}
 
 		const QByteArray &qba = pds.dataBlock(size);
+		if (size != qba.size() || !pds.isValid()) {
+			return;
+		}
+
 		const unsigned char *packet = reinterpret_cast<const unsigned char*>(qba.constData());
 
 #ifdef USE_OPUS
