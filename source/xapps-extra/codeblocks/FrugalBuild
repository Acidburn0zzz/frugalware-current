# Compiling Time: 2.36 SBU
# Maintainer: Priyank Gosalia <priyankmg@gmail.com>

pkgname=codeblocks
pkgver=1.0rc2
pkgrel=1
pkgdesc="A free cross platform C++ IDE"
url="http://www.codeblocks.org/"
depends=('wxgtk')
makedepends=('hd2u' 'autoconf' 'libtool')
groups=('xapps-extra')
archs=('i686')
_F_sourceforge_ext=".tgz"
Finclude sourceforge
source=(${source[@]} codeblocks-1.0rc2_main.patch codeblocks-1.0rc2_sdk.patch barholder.patch)
sha1sums=('f5ffae4af7caeeef51b44fee76cf7c3d892b8efa' \
	  '5195dd6a070da8bf4b8df5bde2c8ff1e27f3f8d8' \
	  '2afef53b1fcb163cc6e0674cdeca312e9d4dc18b' \
	  '7d2d3cf212ca8374e58bea1a7fe03b36fc79bf32')

build() {
	Fcd

	# Apply patches to compile with gcc41
	patch -Np0 -i $Fsrcdir/codeblocks-1.0rc2_main.patch || return 1
	patch -Np0 -i $Fsrcdir/codeblocks-1.0rc2_sdk.patch || return 1
	patch -Np0 -i $Fsrcdir/barholder.patch || return 1

	# Build Code::Blocks
	chmod +x bootstrap
	dos2unix bootstrap && ./bootstrap
	dos2unix configure
	dos2unix src/setup/mime/{codeblocks.desktop,codeblocks.applications}
	Fconf
	find . -name Makefile -exec dos2unix {} \;
	Fmake
	Fmakeinstall
}

# optimization OK
