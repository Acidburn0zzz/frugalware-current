# Compiling Time: 0.43 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=gmerlin-avdecoder
pkgver=1.0.3
pkgrel=3
pkgdesc="Gmerlin_avdecoder is a general purpose media decoding library."
_F_sourceforge_dirname="gmerlin"
Finclude sourceforge
url="http://gmerlin.sourceforge.net/"
## libsmbclient
depends=('gmerlin>=0.4.3-2' 'libmpcdec' 'libtiff' 'mpeg2dec' 'libcdio'  'libdvdread>=4.1.3' 'speex' 'libmad' \
	'ffmpeg>=0.6' 'x264>=20100715' 'libxtst' 'libvisual')
if [ "$CARCH" == "i686" ]; then
	depends=(${depends[@]} 'codecs')
fi
makedepends=('doxygen')
groups=('xapps-extra')
archs=('i686' 'x86_64')
options=('scriptlet')
sha1sums=('74ce800dadadea3cb09b1b7f07db1361fe304488')

build()
{
	Fcd
	Fconf --with-cpuflags=none
	for i in `find . -name Makefile`
	do
		Fsed "-O3" "$CFLAGS" $i
	done
	Fsed "png_set_gray_1_2_4_to_8" "png_set_expand_gray_1_2_4_to_8" lib/pngreader.c
	make || Fdie
	Fmakeinstall
}


# optimization OK
