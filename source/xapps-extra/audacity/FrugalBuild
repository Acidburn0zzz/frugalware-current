# Compiling Time: 4.89 SBU
# Maintainer: Miklos Vajna <vmiklos@frugalware.org>


pkgname=audacity
pkgver=2.1.1
pkgrel=1
pkgdesc="A program that lets you manipulate digital audio waveforms"
_F_archive_name='Audacity'
url="http://audacityteam.org"
depends=('wxwidget' 'libvorbis' 'libid3tag' 'libmad' 'libogg' \
	'libsamplerate' 'flac>=1.1.3' 'soundtouch' 'alsa-lib' \
	'taglib' 'portaudio' 'ffmpeg' 'twolame')
# TODO: twolame
makedepends=('zip' 'cmake' 'x11-protos')
groups=('xapps-extra')
archs=('i686' 'x86_64')
options=('scriptlet')
#temp src for wx3 support
source=(https://github.com/audacity/audacity/archive/wx3-stable.tar.gz \
	audacity-ffmpeg.patch)
up2date="Flasttar https://github.com/audacity/audacity/releases"
sha1sums=('394233ef4d999d24c7a9454973f6e264b1069f97' \
          '5f1733a3802bcec7d9b54cb3ec8d7d81fc38fc61')


build()
{

	export CXXFLAGS="$CXXFLAGS -fno-strict-aliasing"
	Fcd audacity-wx3-stable
	Fpatchall
	WX_CONFIG=/usr/bin/wx-config Fconf \
		--enable-unicode \
		--with-portaudio \
		--with-portmixer \
		--with-libsamplerate=system \
		--without-libresample \
		--with-libmad=system \
		--with-id3tag=system \
		--with-flac=system \
		--with-vorbis=system \
		--with-libexpat=system \
		--with-libsndfile=system \
		--with-taglib=system \
		--with-ffmpeg=system \
		--with-twolame=system
	make || Fdie
	Fmakeinstall
	Ffilerel images/AudacityLogo48x48.xpm /usr/share/$pkgname/$pkgname.xpm
}
# optimization OK
