# Compiling Time: 3.00 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=qemu
pkgver=0.8.2
pkgrel=2
pkgdesc="QEMU is a FAST! processor emulator"
url="http://fabrice.bellard.free.fr/qemu/"
depends=('sdl' 'zlib')
makedepends=('gcc-3.3')
groups=('xapps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump $url/download.html|grep Source|sed 's/.*-\(.*\)\.t.*/\1/'"
source=($url/$pkgname-$pkgver.tar.gz rc.qemu rc.qemu-hu.po \
	qemu-0.8.2-include.diff \
	README.Frugalware)

build()
{
	Fpatchall
	Fsed '^cc="gcc"$' 'cc="gcc-3.3"' configure
	if [ "$CARCH" == "x86_64" ]; then
		# sparc-* does not build
		Fmake --target-list="i386-user arm-user armeb-user ppc-user mips-user mipsel-user i386-softmmu ppc-softmmu x86_64-softmmu mips-softmmu arm-softmmu"
	else
		Fmake
	fi
	make prefix=$Fdestdir$Fprefix bindir=$Fdestdir$Fprefix/bin \
		datadir=$Fdestdir$Fprefix/share/qemu \
		docdir=$Fdestdir$Fprefix/share/doc/$pkgname-$pkgver \
		mandir=$Fdestdir$Fprefix/share/man install
	Frcd2
	Fdoc README.Frugalware
}
sha1sums=('d775239a545e7d0c5b677660a2122df590afde6d' \
	  '60639d14ee193cc0a9911f7948719ab3fbc9737a' \
	  'ce31601e5712057938227923d4a9adf16eeb36e7' \
	  'ace30c10c5ad8d2e907f9978706d361880360baa' \
	  'a60647a24b47496055da8f22c5d9022ed77d7f40')
