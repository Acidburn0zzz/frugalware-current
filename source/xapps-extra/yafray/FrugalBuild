# Compiling Time: 0.40 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=yafray
pkgver=0.1.1
pkgrel=1
pkgdesc="YafRay is a powerful raytracer, under the LGPL license."
url="http://www.yafray.org"
depends=('openexr>=1.4.0a' 'libjpeg>=8a' 'zlib' 'libstdc++')
makedepends=('scons')
groups=('xapps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.yafray.org/sec/2/downloads/ |Flasttar"
source=(http://static.yafaray.org/sources/YafaRay.$pkgver.zip gcc43.diff gcc44.diff)
sha1sums=('430deeb5462ebef27fb433ad5d8ca868d8f291c2' \
          '9292c277901c38af0f9ac80bc4f73b22b63b05a5' \
          '83333d1f3ca71a49d7a01fc2d20650b62edf2ee4')

build() {
	Fcd $pkgname
	Fpatchall
	sed -i -e "s:-O3:${CXXFLAGS} -fsigned-char:g" *-settings.py || Fdie
	scons prefix="/usr" || Fdie
	scons prefix=/usr installprefix=${Fdestdir} install || Fdie
	# cleanup
	find $Fdestdir -name .sconsign -exec rm {} ';' || Fdie
}


# optimization OK
