# Compiling time: 0.02 SBU
# Maintainer: Janos Kovacs <janny@frugalware.org>

USE_STATIC=${USE_STATIC:-"n"}

pkgname=skype
pkgver=2.1.0.81
pkgrel=1
pkgdesc="Skype will let you make free calls to your friends all over the world."
url="http://skype.com"
rodepends=('libstdc++5' 'alsa-lib')
if ! Fuse $USE_STATIC; then
	_static=""
	rodepends=("${rodepends[@]}" 'libsigc++2' 'qt4-qdbus' 'libqtgui' 'libqtnetwork')
	sha1sums=('8d4fbb26eb1a791f2e6f2da7bba8a698377b8592')
else
	_static="_static"
	sha1sums=('8839a80b2fe7276c53ac4ec5b0fd77f2e8d63904')
fi
groups=('xapps-extra')
archs=('i686')
up2date="lynx -dump http://www.skype.com/intl/en/download/skype/linux/choose/ | grep Version | sed 's/.*n \(.*\).*/\1/'"
source=(http://download.skype.com/linux/${pkgname}$_static-${pkgver}.tar.bz2)
license="skype-eula"
options=('nobuild')

build()
{
	Fcd ${pkgname}$_static-${pkgver}
	Fmkdir usr/share/skype
	# Install dbus system conf file
	Ffilerel /etc/dbus-1/system.d/${pkgname}.conf
	# Install bin file
	Fexerel /usr/bin/skype
	# Install desktop file
	Ffilerel /usr/share/applications/${pkgname}.desktop
	# Install icons files
	Ffilerel icons/* usr/share/pixmaps/skype/
	# Install desktop icon link
	Fln /usr/share/pixmaps/skype/SkypeBlue_48x48.png \
		/usr/share/pixmaps/skype.png
	Fln /usr/share/pixmaps/skype/SkypeBlue_48x48.png \
		/usr/share/icons/skype.png
	# Install sound, avatars and language directoryes
	Fcprel sounds usr/share/skype/sounds/
	Fcprel lang usr/share/skype/lang/
	Fcprel avatars usr/share/skype/
}

