# Compiling Time: 3.53 SBU
# Maintainer: Elentir <elentir@frugalware.org>

pkgname=qtiplot
pkgver=0.9.8.2
pkgrel=1
pkgdesc="QtiPlot is a professional scientific data analysis and visualisation solution"
depends=('libboost-mt>=1.39.0' 'pyqt4' 'muparser' 'gsl' 'libglu' 'libqtassistantclient' 'libglu' 'libqt3support' 'libqtopengl')
makedepends=('boost>=1.39.0')
groups=('xapps-extra')
archs=('i686' 'x86_64')
_F_berlios_ext=".tar.bz2"
Finclude berlios
url="http://soft.proindependent.com/qtiplot.html"
_F_desktop_icon="qtiplot.png"
_F_desktop_name="Qtiplot"
_F_desktop_categories="Qt;Education;Science;"
_F_desktop_mimetypes="application/x-qtiplot-project;application/x-qtiplot-project-compressed;application/x-qtiplot-project-backup"
source=($source build.conf qtiplot.xml)
up2date="Flasttar http://soft.proindependent.com/download.html"
sha1sums=('dd8d1003cee8767d4ba9e616e5263da1302c290d' \
          '145f86a395e9e69783896e813fa351bb9dee9d19' \
          '285f57d865956d93250ec548288c5bface096b6b')

build() {
	Fcd
	cp ../build.conf ./ || Fdie

	cd ./3rdparty/qwt || Fdie
	qmake || Fdie
	make || Fdie

	cd ../qwtplot3d || Fdie
	qmake || Fdie
	make || Fdie

	cd ../../qtiplot || Fdie
	## fix some path
	Fsed "pythonconfig.path = /usr/local/qtiplot" "pythonconfig.path = /usr/share/qtiplot" qtiplot.pro
	Fsed "/usr/local/" "/usr/" qtiplot.pro
	Fsed "doc/qtiplot/" "doc/qtiplot-$pkgver" qtiplot.pro
	Fsed "d_python_config_folder + \"" "\"/usr/share/qtiplot" src/core/ApplicationWindow.cpp
	qmake || Fdie
	make || Fdie
	INSTALL_ROOT=${Fdestdir} make install || Fdie

	Fmkdir usr/share/{pixmaps,mime/packages}
	Finstall 644 $_F_cd_path/${pkgname}_logo.png usr/share/pixmaps/${pkgname}.png
	Finstall 644 ${pkgname}.xml usr/share/mime/packages/qtiplot.xml
	Fdesktop2

	## fix doc
	Frm usr/share/doc/qtiplot-0.9.8.2manual
	Frm usr/share/doc/qtiplot
	Fdoc $_F_cd_path/gpl_licence.txt
}

# optimization OK
