# Compiling Time: 0.02 SBU
# Maintainer: Slown <slown@frugalware.org>

pkgname=gtk-youtube-viewer
pkgver=3.1.2
pkgrel=1
pkgdesc="Gtk2 interface for YouTube-Viewer"
url="https://github.com/trizen/youtube-viewer"
depends=('perl-gtk2' 'mplayer' 'perl-lwp-protocol-https' 'perl-data-dump' 'perl-text-charwidth' \
	 'perl-xml-fast' 'perl-term-readline-gnu' 'perl-file-sharedir')
makedepends=('perl-test-pod')
groups=('xapps-extra')
archs=('i686' 'x86_64')
_F_cd_path="youtube-viewer"
_F_github_author="trizen"
_F_github_name="youtube-viewer"
_F_github_tag="yes"
Finclude github
source+=(https://trizen.googlecode.com/files/yv_5.16_to_5.10.pl \
	$url/archive/$pkgver.tar.gz)
sha1sums=('b128c3974d94aaf3b5ab2eb09284973cb571bafa' \
          '1b0e0866238c79864787ea4f75d2a47150eb9592' \
          '5dce0e16c8796bef6b5973720d4bd4ffa0bca485')

# Remove after 2.0 release
options=('force')

build() {
	Fcd $_F_github_name-$pkgver/WWW-YoutubeViewer
	perl Build.PL --destdir $Fdestdir --gtk-youtube-viewer || Fdie
	./Build || Fdie
	./Build test || Fdie
	./Build install --install_path script=/usr/bin || Fdie

	# Fix build with perl-5.14
	cd $Fsrcdir || Fdie
	chmod +x yv_5.16_to_5.10.pl || Fdie
	./yv_5.16_to_5.10.pl $Fdestdir/usr/bin/youtube-viewer > youtube-viewer || Fdie
	Fexe /usr/bin/youtube-viewer
}
