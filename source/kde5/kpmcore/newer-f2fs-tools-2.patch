From fad8a3568e443dc42af003e83484541693397c25 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andrius=20=C5=A0tikonas?= <andrius@stikonas.eu>
Date: Sun, 12 Nov 2017 14:45:49 +0000
Subject: Fix the previous commit.

FileSystem::create is never called if createWithLabel is available.
---
 src/fs/f2fs.cpp | 15 +++++++--------
 1 file changed, 7 insertions(+), 8 deletions(-)

diff --git a/src/fs/f2fs.cpp b/src/fs/f2fs.cpp
index 298ec71..c4fdaf1 100644
--- a/src/fs/f2fs.cpp
+++ b/src/fs/f2fs.cpp
@@ -121,18 +121,17 @@ bool f2fs::check(Report& report, const QString& deviceNode) const
 
 bool f2fs::create(Report& report, const QString& deviceNode)
 {
-    QStringList args;
-    if (oldVersion)
-        args << deviceNode;
-    else
-        args << QStringLiteral("-f") << deviceNode;
-    ExternalCommand cmd(report, QStringLiteral("mkfs.f2fs"), { deviceNode });
-    return cmd.run(-1) && cmd.exitCode() == 0;
+    return createWithLabel(report, deviceNode, QString());
 }
 
 bool f2fs::createWithLabel(Report& report, const QString& deviceNode, const QString& label)
 {
-    ExternalCommand cmd(report, QStringLiteral("mkfs.f2fs"), { QStringLiteral("-l"), label, deviceNode });
+    QStringList args;
+    if (oldVersion)
+        args << QStringLiteral("-l") << label << deviceNode;
+    else
+        args << QStringLiteral("-f") << QStringLiteral("-l") << label << deviceNode;
+    ExternalCommand cmd(report, QStringLiteral("mkfs.f2fs"), args);
     return cmd.run(-1) && cmd.exitCode() == 0;
 }
 
-- 
cgit v0.11.2

