# Last modified: Thu, 11 Aug 2005 02:25:49 +0200
# Compiling time: ~0.05 SBU
# Contributor: Shrift <shrift@frugalware.org>
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=fglrx
pkgver=8.14.13
pkgrel=3
pkgdesc="Hardware Accelerated ATI driver for xorg"
url="http://www.ati.com/"
depends=('xorg' 'kernel-source' 'kernel-headers' 'gcc' 'make')
makedepends=('alien')
groups=('x11-extra')
archs=('i686')
install=$pkgname.install
up2date=""
# patch: http://ati.cchtml.com/attachment.cgi?id=114
# patch: http://rambo.its.tudelft.nl/~ewald/fglrx_6_8_0-8.14.13-fc4.patch
[ "$CARCH" == "i686" ] && source=(http://www2.ati.com/drivers/linux/${pkgname}_6_8_0-${pkgver}-1.i386.rpm fglrx-2.6.12-gcc4-agp-amd64.patch)
[ "$CARCH" == "x86_64" ] && source=(http://www2.ati.com/drivers/linux/64bit/${pkgname}64_6_8_0-${pkgver}-1.x86_64.rpm fglrx-2.6.12-gcc4-agp-amd64.patch)
[ "$CARCH" == "i686" ] && sha1sums=('4d9cc78bfbc4e1381c4ece25a97bb0137f7e8d6b' \
	'3136ba3a6c3f85f187a107b4de98e7ff24faaece')
[ "$CARCH" == "x86_64" ] && sha1sums=('49486be719b3e396db9e670b750c1a784e402ffd' \
	'3136ba3a6c3f85f187a107b4de98e7ff24faaece')

build() {
	if [ "$CARCH" == "i686" ]; then
		alien -t ${pkgname}_6_8_0-$pkgver-1.i386.rpm
		tar -xzf ${pkgname}_6_8_0-$pkgver.tgz
	fi
	if [ "$CARCH" == "x86_64" ]; then
		alien -t ${pkgname}64_6_8_0-$pkgver-1.x86_64.rpm
		tar -xzf ${pkgname}64_6_8_0-$pkgver.tgz
	fi
	for i in `find $Fsrcdir *` ; do
		if [ -x $i ]; then
			chmod 755 "$i"
		else chmod 644 "$i"
		fi
	done
	mv $Fsrcdir/{lib,usr} $Fdestdir/
	cd $Fdestdir
	Fpatch fglrx-2.6.12-gcc4-agp-amd64.patch
}

# vim: ft=sh
