# Last modified: Mon, 01 May 2006 23:10:37 +0200
# Compiling time: 1.24 SBU
# Maintainer: alex_extreme <alex.extreme2@gmail.com>

pkgname=beagle
pkgver=0.2.6
pkgrel=3
pkgdesc="Search tool that ransacks your personal information space"
url="http://beagle-project.org"
depends=('gecko-sharp' 'gmime>=2.1.19' 'libexif' 'sqlite3' 'scrnsaverproto' 'libxscrnsaver' 'perl-xml' \
	'wv' 'gtk2-sharp' 'gsf-sharp')
makedepends=('intltool' 'pygtk' 'zip' 'epiphany-extensions' 'unzip' 'evolution-sharp' 'python')
backup=('etc/beagle/crawl-applications' 'etc/beagle/crawl-documentation' 'etc/beagle/crawl-windows')
groups=('gnome-extra')
archs=('i686' 'x86_64')
Finclude gnome
source=(http://ftp.gnome.org/pub/GNOME/sources/$pkgname/$preup2date/$pkgname-$pkgver.tar.gz beagle-crawl-system)
sha1sums=('996d4e9a8dee09384aeefee8f3cb71f68c3b25f3' \
          'ff85c5a803f9bd8bfcf838b0c261093460305e34')
## TODO: move to main || figure howto 'package' the ff stuff || split more stuff || clean the other *-sharp package 
##       clean the depends()  

subpkgs=("$pkgname-epiphany" "$pkgname-evolution" "lib$pkgname" "$pkgname-gui")
subdescs=('Beagle  extensions for epiphany.' 'Beagle evolution bindings.' 'Beagle client library.' 'Desktop Search Application.')
subdepends=('epiphany-extensions glibc' 'evolution-sharp' 'libxml2 glib2 glibc python' "$pkgname=$pkgver")
subgroups=('gnome-extra' 'gnome-extra' 'lib-extra' 'gnome-extra')
suboptions=('scriptlet' 'scriptlet' 'scriptlet' 'scriptlet')
subarchs=('i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64')

build()
{
	export MONO_SHARED_DIR=$startdir/pkg/weird
	mkdir -p $MONO_SHARED_DIR
	
	Fbuild --enable-inotify --enable-epiphany-extension \
		--enable-epiphany-extension-install \
		--disable-schemas-install --enable-python
	Frm etc/cron.d
	Ffilerel ../beagle-crawl-system /etc/cron.daily/beagle-crawl-system
	echo 'OnlyShowIn=GNOME;' >> $Fdestdir/usr/share/applications/beagle-search.desktop
	echo 'OnlyShowIn=GNOME;' >> $Fdestdir/usr/share/applications/beagle-settings.desktop
	
	Fsplit $pkgname-epiphany usr/lib/epiphany/
	Fsplit $pkgname-evolution usr/lib/beagle/Backends/EvolutionBackends.*
	Fsplit lib$pkgname usr/include/libbeagle
	Fsplit lib$pkgname usr/lib/libbeagle.*
	Fsplit lib$pkgname usr/lib/python2.4
	Fsplit lib$pkgname usr/lib/pkgconfig/libbeagle-*
	Fsplit $pkgname-gui usr/bin/beagle-{imlogviewer,search,settings}
	Fsplit $pkgname-gui usr/lib/beagle/{Images.dll*,UiUtil.dll*,ImLogViewer.exe*,Search.exe*,Settings.exe*,libbeagleuiglue*}
	Fsplit $pkgname-gui usr/share/applications/*.desktop
	Fsplit $pkgname-gui usr/share/pixmaps/
	rm -rf $MONO_SHARED_DIR
}

# optimization OK
