# Last Modified: Wed, 22 Mar 2006 23:27:18 +0100
# Compiling Time: 3.01 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=abiword
pkgver=2.4.2
shortver=`echo $pkgver | cut -d . -f 1,2`
pkgrel=2
pkgdesc="AbiWord is a free word processing program similar to Microsoft(R) Word."
url="http://www.abisource.com"
groups=('gnome-extra')
archs=('i686' 'x86_64')
depends=('atk' 'libgnomeprintui' 'fribidi' 'bzip2' 'enchant')
rodepends=('aspell6-en')
makedepends=('imagemagick')
up2date="lynx -dump $url/download/ | grep tar.gz | cut -d '/' -f 6"
source=($url/downloads/$pkgname/$pkgver/source/$pkgname-$pkgver.tar.bz2 \
	$pkgname-$pkgver-spell.diff)
sha1sums=('a28b3a355d265223a651a43d51d550a7b97efe0a' \
	  '3875dd6dd7203b7d4e472bbd2660cd6df4122fc2')
license="GPL2"

build()
{
	unset MAKEFLAGS
	# AbiWord base
	Fpatchall
	cd abi
	Fmake --with-xml2 --enable-scripting --with-pspell
	Fmakeinstall
	# AbiWord plugins
	cd ../$pkgname-plugins || return 1
	./nextgen.sh || return 1
	Fmake --disable-all --with-wmf --with-bmp --with-babelfish \
	      --with-OpenWrite --with-wordperfect --with-aiksaurus \
	      --without-magick --with-librsvg --with-bz2abw --with-google \
	      --with-kword --with-xhtml --with-html --with-jpeg --with-gdict
	Fmakeinstall
	# AbiWord help files
	cd ../abiword-docs || return 1
	export ABI_DOC_PROG=`pwd`/../abi/src/wp/main/unix/AbiWord-$shortver
	./make-html.sh || exit 1
	Fmkdir /usr/share/AbiSuite-$shortver/AbiWord/help
	cp -rp help/* $Fdestdir/usr/share/AbiSuite-$shortver/AbiWord/help/
	# Fix some wrong permission on help files
	find $Fdestdir/usr/share/AbiSuite-$shortver/AbiWord/help/ -type d -exec chmod -c 755 {} \;
}

# optimalization OK

# vim: ft=sh
