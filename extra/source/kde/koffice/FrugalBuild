# Last Modified: Sun, 16 Apr 2006 02:55:47 +0200
# Compiling Time: 61.41 SBU
# Maintainer:  Kapolnasi Tamas <ktamas@tdc.hu>
# Contributor: crazy <crazy@frugalware.org>

pkgname=koffice
pkgver=1.5.0
pkgrel=2
pkgdesc="An integrated Office suite for KDE"
url="http://www.koffice.org"
depends=('libkexif' 'pkgconfig' 'kdebase>=3.5.2-1' 'libpqxx' 'wv2' 'mysql' 'libwpd' 'python' 'ruby>=1.8.4-2' 'imagemagick')
makedepends=('esd' 'doxygen' 'qt-docs>=3.3.6' 'kdebindings')
groups=('kde-extra')
archs=('i686' 'x86_64')
options=('nodocs' 'scriptlet')
up2date="lynx -dump ftp://ftp.fu-berlin.de/pub/unix/X11/gui/kde/stable/|grep -v "1.4"|grep -m1 'koffice-'|sed 's/.*-\(.*\)/\1/'"
#up2date="lynx -dump $url |grep current|sed 's/.*e \(.*\) i.*/\1/'"
source=(ftp://ftp.fu-berlin.de/pub/unix/X11/gui/kde/stable/koffice-1.5.0/src/$pkgname-$pkgver.tar.bz2 \
	koffice-1.5-gcc-bug-workaround)
# http://www.koffice.org/releases/$pkgver-release.php
sha1sums=('e8886c8dd438d5522a7b2fe514024543e33436d5' \
          '06b4a301d475235ec6cd7967c97c339830d201b7')

subpkgs=('koffice-docs')
subdescs=('Koffice Documentation')
subdepends=('koffice>=1.5.0')
subgroups=('kde-extra')
subarchs=('i686 x86_64')

build()
{
	Fcd
	Fpatch koffice-1.5-gcc-bug-workaround
	## kill off the  O2's
	for i in `find . -iname configure`
	do
		Fsed '-O2' '' $i
	done
	Fbuild CXXFLAGS="$CXXFLAGS -fno-strict-aliasing -Wno-deprecated" \
	       --disable-debug --without-debug \
	       --with-gnu-ld --disable-dependency-tracking \
	       --enable-new-ld-flags --enable--final --enable-kexi-reports
	Fsplit koffice-docs usr/share/doc
	##TODO: Split all other pkgs too
}

# optimalization OK
