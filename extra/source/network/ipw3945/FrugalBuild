# Last Modified: Wed, 21 Jun 2006 14:51:51 +0200
# Compiling Time: 0.05 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=ipw3945
pkgver=1.0.5
pkgrel=1
pkgdesc="Intel PRO/Wireless 3945ABG Driver for Linux"
_F_sourceforge_ext=".tgz"
Finclude sourceforge kernel-module
depends=(${depends[@]} 'ipw3945-ucode' 'ipw3945d' 'wireless_tools')
groups=('network-extra')
archs=('i686')
sha1sums=('8dc4a59a4228aaf69e605ed3ad48cabc84b41a31')

build()
{
	Fcheckkernel
	Fsed "s:^#\(CONFIG_IPW3945_QOS\)=.*:\1=y:" Makefile
	Fsed "s:^# \(CONFIG_IPW3945_MONITOR\)=.*:\1=y:" Makefile
	Fsed "s:^# \(CONFIG_IEEE80211_RADIOTAP\)=.*:\1=y:" Makefile
	Fsed "s:^# \(CONFIG_IPW3945_PROMISCUOUS\)=.*:\1=y:" Makefile
	make KVER=$kernelbasever-fw$kernelrel \
		IEEE80211_INC=/lib/modules/$kernelbasever-fw$kernelrel/build/include || return 1
	Ffilerel /lib/modules/$kernelbasever-fw$kernelrel/kernel/drivers/net/wireless/ipw3945/ipw3945.ko
}
