# Last Modified: Wed, 20 Jul 2005 20:23:03 +0200
# Compiling Time: ~ 1.51 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=ocaml
pkgver=3.08.3
pkgrel=1
pkgdesc="Caml is a general-purpose programming language, designed with program safety and reliability in mind."
url="http://caml.inria.fr/"
depends=('gdbm')
makedepends=('tk')
groups=('devel-extra')
archs=('x86_64')
up2date="lynx -dump http://caml.inria.fr/download.en.html|grep stable|sed -n 's/.*s \(.*\)\. .*/\1/;1 p'"
source=(http://caml.inria.fr/pub/distrib/$pkgname-3.08/$pkgname-$pkgver.tar.bz2)
md5sums=('8277bb1537051fe5151dc31c350d64cd')

build() {
    Fcd
    export LC_ALL=C
    ./configure -prefix /usr \
		-bindir /usr/bin \
		-libdir /usr/lib/ocaml \
		-mandir /usr/share/man \
		--with-pthread || return 1
    Fsed "\(BYTECCCOMPOPTS=.*\)" "\1 ${CFLAGS}" config/Makefile
    Fsed "\(NATIVECCCOMPOPTS=.*\)" "\1 ${CFLAGS}" config/Makefile
    make world || return 1
    make opt || return 1
    make opt.opt || return 1
    
    make BINDIR=$Fdestdir/usr/bin LIBDIR=$Fdestdir/usr/lib/ocaml \
	    MANDIR=$Fdestdir/usr/share/man install || return 1
    
    Fsed "{$Fdestdir}" "" $Fdestdir/usr/lib/ocaml/ld.conf
}

# optimalization OK

# vim: ft=sh
