# Last Modified: Thu, 06 Oct 2005 13:49:45 +0200
# Compiling Time: 0.17 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=lgeneral
pkgver=1.2beta_5
pkgrel=1
pkgdesc="LGeneral is a turn-based strategy engine heavily inspired by Panzer General."
url="http://lgames.sourceforge.net/index.php?project=LGeneral"
depends=('sdl_mixer')
groups=('games-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://lgames.sourceforge.net/downloads.php | grep 'http.*lgeneral-.*\.tar\.gz' | sed -e 's/.*lgeneral-\(.*\)\.tar\.gz.*/\1/' | sed -e 's/-/_/'"
source=(http://switch.dl.sourceforge.net/sourceforge/lgeneral/$pkgname-`echo $pkgver | sed 's/_/-/'`.tar.gz \
	http://switch.dl.sourceforge.net/sourceforge/lgeneral/pg-data.tar.gz \
	lgeneral-gcc4-fix.patch lgeneral-optimalization-fix.patch)
sha1sums=('97d73dd82864df2f612e3f7d9cdadb8203af67cc' \
          '2f7a63f0a8efc3215e5e61ec6b513b7d8ee3c32b' \
          '0bddbdce84dc2377f78154a814dd9c8bc0951e8c' \
          '7569be8cea41851cb6917459f131a5758bec8f66')

build()
{
	Fcd $pkgname-`echo $pkgver | sed 's/_/-/'`
	Fpatchall
	Fautoconfize

	# Needed for Panzer General data files population
	cp -pPR $Fsrcdir/$pkgname-`echo $pkgver | sed 's/_/-/'` $Fsrcdir/temp || return 1

	Fmake --localstatedir=/var/games/$pkgname --enable-sdl-mixer
	Fmakeinstall

	# Populate Panzer General data files # What a braindead mode ...
	cd $Fsrcdir/temp
	Fmake --datadir=$Fdestdir/usr/share --enable-sdl-mixer

	$Fsrcdir/temp/lgc-pg/lgc-pg -s $Fsrcdir/pg-data -d $Fdestdir/usr/share/games/lgeneral || return 1
}

# vim: ft=sh

# optimalization OK
