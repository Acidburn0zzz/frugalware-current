diff -Naur ooo-build-1.9.129.orig/patches/64bit/cws-ooo64bit02.2005-04-19.diff ooo-build-1.9.129/patches/64bit/cws-ooo64bit02.2005-04-19.diff
--- ooo-build-1.9.129.orig/patches/64bit/cws-ooo64bit02.2005-04-19.diff	2005-09-27 15:15:48.000000000 +0200
+++ ooo-build-1.9.129/patches/64bit/cws-ooo64bit02.2005-04-19.diff	2005-09-27 15:20:20.000000000 +0200
@@ -5785,32 +5785,6 @@
  }
  
  static sal_uInt32 checkReference(const OUString& keyName,
-Index: canvas/source/vcl/textlayout.cxx
-===================================================================
-RCS file: /cvs/gsl/canvas/source/vcl/textlayout.cxx,v
-retrieving revision 1.2
-retrieving revision 1.2.8.1
-diff -u -p -u -p -r1.2 -r1.2.8.1
---- canvas/source/vcl/textlayout.cxx	26 Nov 2004 17:16:04 -0000	1.2
-+++ canvas/source/vcl/textlayout.cxx	21 Jan 2005 15:48:09 -0000	1.2.8.1
-@@ -240,7 +240,7 @@ namespace vclcanvas
-         rOutDev.SetLayoutMode( nLayoutMode );
- 
-         // TODO(P2): cache that
--        ::boost::scoped_array< long > aOffsets(new long[maLogicalAdvancements.getLength()]);
-+        ::boost::scoped_array< sal_Int32 > aOffsets(new sal_Int32[maLogicalAdvancements.getLength()]);
-         setupTextOffsets( aOffsets.get(), maLogicalAdvancements, viewState, renderState );
- 
-         rOutDev.DrawTextArray( rOutpos,
-@@ -284,7 +284,7 @@ namespace vclcanvas
-         };
-     }
- 
--    void TextLayout::setupTextOffsets( long*							outputOffsets,
-+    void TextLayout::setupTextOffsets( sal_Int32*							outputOffsets,
-                                        const uno::Sequence< double >& 	inputOffsets,
-                                        const rendering::ViewState& 		viewState,
-                                        const rendering::RenderState& 	renderState		) const
 Index: canvas/source/vcl/textlayout.hxx
 ===================================================================
 RCS file: /cvs/gsl/canvas/source/vcl/textlayout.hxx,v
@@ -10492,96 +10466,6 @@
  			break;
  
  		case SbxLONG:
-Index: basic/source/runtime/methods.cxx
-===================================================================
-RCS file: /cvs/script/basic/source/runtime/methods.cxx,v
-retrieving revision 1.59
-retrieving revision 1.59.16.1
-diff -u -p -u -p -r1.59 -r1.59.16.1
---- basic/source/runtime/methods.cxx	15 Nov 2004 16:36:55 -0000	1.59
-+++ basic/source/runtime/methods.cxx	21 Jan 2005 16:01:25 -0000	1.59.16.1
-@@ -1753,11 +1753,11 @@ RTLFUNC(DateValue)
- 			pFormatter = pINST->GetNumberFormatter();
- 		else
- 		{
--			ULONG n;	// Dummy
-+			sal_uInt32 n;	// Dummy
- 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, n );
- 		}
- 
--		ULONG nIndex;
-+		sal_uInt32 nIndex;
- 		double fResult;
- 		String aStr( rPar.Get(1)->GetString() );
- 		BOOL bSuccess = pFormatter->IsNumberFormat( aStr, nIndex, fResult );
-@@ -1796,11 +1796,11 @@ RTLFUNC(TimeValue)
- 			pFormatter = pINST->GetNumberFormatter();
- 		else
- 		{
--			ULONG n;	// Dummy
-+			sal_uInt32 n;	// Dummy
- 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, n );
- 		}
- 
--		ULONG nIndex;
-+		sal_uInt32 nIndex;
- 		double fResult;
- 		BOOL bSuccess = pFormatter->IsNumberFormat( rPar.Get(1)->GetString(),
- 												   nIndex, fResult );
-@@ -1977,7 +1977,7 @@ RTLFUNC(Time)
- 
- 			// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
- 			SvNumberFormatter* pFormatter = NULL;
--			ULONG nIndex;
-+			sal_uInt32 nIndex;
- 			if( pINST )
- 			{
- 				pFormatter = pINST->GetNumberFormatter();
-@@ -1985,7 +1985,7 @@ RTLFUNC(Time)
- 			}
- 			else
- 			{
--				ULONG n;	// Dummy
-+				sal_uInt32 n;	// Dummy
- 				SbiInstance::PrepareNumberFormatter( pFormatter, n, nIndex, n );
- 			}
- 
-@@ -2028,7 +2028,7 @@ RTLFUNC(Date)
- 
- 			// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
- 			SvNumberFormatter* pFormatter = NULL;
--			ULONG nIndex;
-+			sal_uInt32 nIndex;
- 			if( pINST )
- 			{
- 				pFormatter = pINST->GetNumberFormatter();
-@@ -2036,7 +2036,7 @@ RTLFUNC(Date)
- 			}
- 			else
- 			{
--				ULONG n;	// Dummy
-+				sal_uInt32 n;	// Dummy
- 				SbiInstance::PrepareNumberFormatter( pFormatter, nIndex, n, n );
- 			}
- 
-@@ -2922,7 +2922,7 @@ RTLFUNC(FileDateTime)
- 
- 		// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
- 		SvNumberFormatter* pFormatter = NULL;
--		ULONG nIndex;
-+		sal_uInt32 nIndex;
- 		if( pINST )
- 		{
- 			pFormatter = pINST->GetNumberFormatter();
-@@ -2930,7 +2930,7 @@ RTLFUNC(FileDateTime)
- 		}
- 		else
- 		{
--			ULONG n;	// Dummy
-+			sal_uInt32 n;	// Dummy
- 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, nIndex );
- 		}
- 
 Index: basic/source/runtime/runtime.cxx
 ===================================================================
 RCS file: /cvs/script/basic/source/runtime/runtime.cxx,v
@@ -10773,77 +10657,6 @@
  	while( aTokens.getNextToken( aToken ) && aToken.getLength() != 0 )
  	{
  		if( !bHasWidth &&
-Index: xmloff/source/style/impastp4.cxx
-===================================================================
-RCS file: /cvs/xml/xmloff/source/style/impastp4.cxx,v
-retrieving revision 1.14
-retrieving revision 1.12.162.4
-diff -u -p -u -p -r1.14 -r1.12.162.4
---- xmloff/source/style/impastp4.cxx	5 Jan 2005 11:36:18 -0000	1.14
-+++ xmloff/source/style/impastp4.cxx	21 Jan 2005 15:12:40 -0000	1.12.162.4
-@@ -135,7 +135,7 @@ void SvXMLAutoStylePoolP_Impl::AddFamily
- 		sal_Bool bAsFamily )
- {
- 	// store family in a list if not already stored
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 	XMLFamilyData_Impl *pFamily = new XMLFamilyData_Impl( nFamily, rStrName, rMapper, rStrPrefix, bAsFamily );
- 	if( !maFamilyList.Seek_Entry( pFamily, &nPos ) )
- 		maFamilyList.Insert( pFamily );
-@@ -152,7 +152,7 @@ void SvXMLAutoStylePoolP_Impl::RegisterN
- {
- 	SvXMLAutoStylePoolNamesP_Impl *pNames = 0;
- 
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 	XMLFamilyData_Impl aTmp( nFamily );
- 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
- 		pNames = maFamilyList.GetObject( nPos )->mpNameList;
-@@ -222,7 +222,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
- 				sal_Bool bCache)
- {
- 	sal_Bool bRet(sal_False);
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 
- 	XMLFamilyData_Impl *pFamily = 0;
- 	XMLFamilyData_Impl aTmp( nFamily );
-@@ -270,7 +270,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
- OUString SvXMLAutoStylePoolP_Impl::AddToCache( sal_Int32 nFamily,
- 							 		    const OUString& rParent )
- {
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 
- 	XMLFamilyData_Impl *pFamily = 0;
- 	XMLFamilyData_Impl aTmp( nFamily );
-@@ -302,7 +302,7 @@ OUString SvXMLAutoStylePoolP_Impl::Find(
- {
- 	OUString sName;
- 
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 	XMLFamilyData_Impl aTmp( nFamily );
- 	XMLFamilyData_Impl *pFamily = 0;
- 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
-@@ -329,7 +329,7 @@ OUString SvXMLAutoStylePoolP_Impl::FindA
- {
- 	OUString sName;
- 
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 	XMLFamilyData_Impl aTmp( nFamily );
- 	XMLFamilyData_Impl *pFamily = 0;
- 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
-@@ -371,7 +371,7 @@ void SvXMLAutoStylePoolP_Impl::exportXML
- 	sal_uInt32 nCount = 0;
- 
- 	// Get list of parents for current family (nFamily)
--	sal_uInt32 nPos;
-+	ULONG nPos;
- 	XMLFamilyData_Impl aTmp( nFamily );
- 	XMLFamilyData_Impl *pFamily = 0;
- 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
 Index: xmloff/source/style/xmlnume.cxx
 ===================================================================
 RCS file: /cvs/xml/xmloff/source/style/xmlnume.cxx,v
@@ -15350,23 +15163,6 @@
                  String aTemp( pEntry->GetFormatstring() );
                  mxFormatter->PutandConvertEntry( aTemp, nCheckPos, nType, nKey, eLang, LANGUAGE_ENGLISH_US );
                  DBG_ASSERT( nCheckPos == 0, "XclExpNumFmtBuffer::WriteFormatRecord - format code not convertible" );
-Index: sc/source/filter/excel/xiescher.cxx
-===================================================================
-RCS file: /cvs/sc/sc/source/filter/excel/xiescher.cxx,v
-retrieving revision 1.33
-retrieving revision 1.30.6.2
-diff -u -p -u -p -r1.33 -r1.30.6.2
---- sc/source/filter/excel/xiescher.cxx	21 Feb 2005 13:31:50 -0000	1.33
-+++ sc/source/filter/excel/xiescher.cxx	9 Mar 2005 21:16:20 -0000	1.30.6.2
-@@ -1532,7 +1532,7 @@ SdrObject* XclImpDffManager::ProcessObj(
-             // automatic margin is handled by host
-             if( GetPropertyBool( DFF_Prop_AutoTextMargin ) )
-             {
--                long nMargin = EXC_ESCHER_AUTOMARGIN;
-+                sal_Int32 nMargin = EXC_ESCHER_AUTOMARGIN;
-                 ScaleEmu( nMargin );
-                 pRetSdrObj->SetMergedItem( SdrTextLeftDistItem( nMargin ) );
-                 pRetSdrObj->SetMergedItem( SdrTextRightDistItem( nMargin ) );
 Index: sc/source/filter/excel/xistyle.cxx
 ===================================================================
 RCS file: /cvs/sc/sc/source/filter/excel/xistyle.cxx,v
@@ -16927,3 +16723,207 @@
  //------------------------------------------------------------------------------
  const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int32 _nValue)
  {
+Index: basic/source/runtime/methods.cxx
+===================================================================
+RCS file: /cvs/script/basic/source/runtime/methods.cxx,v
+retrieving revision 1.59
+retrieving revision 1.59.16.1
+diff -u -p -u -p -r1.59 -r1.59.16.1
+--- basic/source/runtime/methods.cxx	15 Nov 2004 16:36:55 -0000	1.59
++++ basic/source/runtime/methods.cxx	21 Jan 2005 16:01:25 -0000	1.59.16.1
+@@ -1727,11 +1727,11 @@ RTLFUNC(DateValue)
+ 			pFormatter = pINST->GetNumberFormatter();
+ 		else
+ 		{
+-			ULONG n;	// Dummy
++			sal_uInt32 n;	// Dummy
+ 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, n );
+ 		}
+ 
+-		ULONG nIndex;
++		sal_uInt32 nIndex;
+ 		double fResult;
+ 		String aStr( rPar.Get(1)->GetString() );
+ 		BOOL bSuccess = pFormatter->IsNumberFormat( aStr, nIndex, fResult );
+@@ -1770,11 +1770,11 @@ RTLFUNC(TimeValue)
+ 			pFormatter = pINST->GetNumberFormatter();
+ 		else
+ 		{
+-			ULONG n;	// Dummy
++			sal_uInt32 n;	// Dummy
+ 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, n );
+ 		}
+ 
+-		ULONG nIndex;
++		sal_uInt32 nIndex;
+ 		double fResult;
+ 		BOOL bSuccess = pFormatter->IsNumberFormat( rPar.Get(1)->GetString(),
+ 												   nIndex, fResult );
+@@ -1951,7 +1951,7 @@ RTLFUNC(Time)
+ 
+ 			// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
+ 			SvNumberFormatter* pFormatter = NULL;
+-			ULONG nIndex;
++			sal_uInt32 nIndex;
+ 			if( pINST )
+ 			{
+ 				pFormatter = pINST->GetNumberFormatter();
+@@ -1959,7 +1959,7 @@ RTLFUNC(Time)
+ 			}
+ 			else
+ 			{
+-				ULONG n;	// Dummy
++				sal_uInt32 n;	// Dummy
+ 				SbiInstance::PrepareNumberFormatter( pFormatter, n, nIndex, n );
+ 			}
+ 
+@@ -2002,7 +2002,7 @@ RTLFUNC(Date)
+ 
+ 			// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
+ 			SvNumberFormatter* pFormatter = NULL;
+-			ULONG nIndex;
++			sal_uInt32 nIndex;
+ 			if( pINST )
+ 			{
+ 				pFormatter = pINST->GetNumberFormatter();
+@@ -2010,7 +2010,7 @@ RTLFUNC(Date)
+ 			}
+ 			else
+ 			{
+-				ULONG n;	// Dummy
++				sal_uInt32 n;	// Dummy
+ 				SbiInstance::PrepareNumberFormatter( pFormatter, nIndex, n, n );
+ 			}
+ 
+@@ -2896,7 +2896,7 @@ RTLFUNC(FileDateTime)
+ 
+ 		// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
+ 		SvNumberFormatter* pFormatter = NULL;
+-		ULONG nIndex;
++		sal_uInt32 nIndex;
+ 		if( pINST )
+ 		{
+ 			pFormatter = pINST->GetNumberFormatter();
+@@ -2904,7 +2904,7 @@ RTLFUNC(FileDateTime)
+ 		}
+ 		else
+ 		{
+-			ULONG n;	// Dummy
++			sal_uInt32 n;	// Dummy
+ 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, nIndex );
+ 		}
+ 
+Index: canvas/source/vcl/textlayout.cxx
+===================================================================
+RCS file: /cvs/gsl/canvas/source/vcl/textlayout.cxx,v
+retrieving revision 1.2
+retrieving revision 1.2.8.1
+diff -u -p -u -p -r1.2 -r1.2.8.1
+--- canvas/source/vcl/textlayout.cxx	26 Nov 2004 17:16:04 -0000	1.2
++++ canvas/source/vcl/textlayout.cxx	21 Jan 2005 15:48:09 -0000	1.2.8.1
+@@ -296,7 +296,7 @@ namespace vclcanvas
+         rOutDev.SetLayoutMode( nLayoutMode );
+ 
+         // TODO(P2): cache that
+-        ::boost::scoped_array< long > aOffsets(new long[maLogicalAdvancements.getLength()]);
++        ::boost::scoped_array< sal_Int32 > aOffsets(new sal_Int32[maLogicalAdvancements.getLength()]);
+         setupTextOffsets( aOffsets.get(), maLogicalAdvancements, viewState, renderState );
+ 
+         rOutDev.DrawTextArray( rOutpos,
+@@ -351,7 +351,7 @@ namespace vclcanvas
+         };
+     }
+ 
+-    void TextLayout::setupTextOffsets( long*							outputOffsets,
++    void TextLayout::setupTextOffsets( sal_Int32*							outputOffsets,
+                                        const uno::Sequence< double >& 	inputOffsets,
+                                        const rendering::ViewState& 		viewState,
+                                        const rendering::RenderState& 	renderState		) const
+Index: sc/source/filter/excel/xiescher.cxx
+===================================================================
+RCS file: /cvs/sc/sc/source/filter/excel/xiescher.cxx,v
+retrieving revision 1.33
+retrieving revision 1.30.6.2
+diff -u -p -u -p -r1.33 -r1.30.6.2
+--- sc/source/filter/excel/xiescher.cxx	21 Feb 2005 13:31:50 -0000	1.33
++++ sc/source/filter/excel/xiescher.cxx	9 Mar 2005 21:16:20 -0000	1.30.6.2
+@@ -1412,7 +1412,7 @@ SdrObject* XclImpDffManager::ProcessObj(
+             // automatic margin is handled by host
+             if( GetPropertyBool( DFF_Prop_AutoTextMargin ) )
+             {
+-                long nMargin = EXC_ESCHER_AUTOMARGIN;
++                sal_Int32 nMargin = EXC_ESCHER_AUTOMARGIN;
+                 ScaleEmu( nMargin );
+                 pRetSdrObj->SetMergedItem( SdrTextLeftDistItem( nMargin ) );
+                 pRetSdrObj->SetMergedItem( SdrTextRightDistItem( nMargin ) );
+Index: xmloff/source/style/impastp4.cxx
+===================================================================
+RCS file: /cvs/xml/xmloff/source/style/impastp4.cxx,v
+retrieving revision 1.14
+retrieving revision 1.12.162.4
+diff -u -p -u -p -r1.14 -r1.12.162.4
+--- xmloff/source/style/impastp4.cxx	5 Jan 2005 11:36:18 -0000	1.14
++++ xmloff/source/style/impastp4.cxx	21 Jan 2005 15:12:40 -0000	1.12.162.4
+@@ -109,7 +109,7 @@ void SvXMLAutoStylePoolP_Impl::AddFamily
+ 		sal_Bool bAsFamily )
+ {
+ 	// store family in a list if not already stored
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 	XMLFamilyData_Impl *pFamily = new XMLFamilyData_Impl( nFamily, rStrName, rMapper, rStrPrefix, bAsFamily );
+ 	if( !maFamilyList.Seek_Entry( pFamily, &nPos ) )
+ 		maFamilyList.Insert( pFamily );
+@@ -126,7 +126,7 @@ void SvXMLAutoStylePoolP_Impl::RegisterN
+ {
+ 	SvXMLAutoStylePoolNamesP_Impl *pNames = 0;
+ 
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 	XMLFamilyData_Impl aTmp( nFamily );
+ 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
+ 		pNames = maFamilyList.GetObject( nPos )->mpNameList;
+@@ -196,7 +196,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
+ 				sal_Bool bCache)
+ {
+ 	sal_Bool bRet(sal_False);
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 
+ 	XMLFamilyData_Impl *pFamily = 0;
+ 	XMLFamilyData_Impl aTmp( nFamily );
+@@ -244,7 +244,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
+ OUString SvXMLAutoStylePoolP_Impl::AddToCache( sal_Int32 nFamily,
+ 							 		    const OUString& rParent )
+ {
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 
+ 	XMLFamilyData_Impl *pFamily = 0;
+ 	XMLFamilyData_Impl aTmp( nFamily );
+@@ -276,7 +276,7 @@ OUString SvXMLAutoStylePoolP_Impl::Find(
+ {
+ 	OUString sName;
+ 
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 	XMLFamilyData_Impl aTmp( nFamily );
+ 	XMLFamilyData_Impl *pFamily = 0;
+ 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
+@@ -303,7 +303,7 @@ OUString SvXMLAutoStylePoolP_Impl::FindA
+ {
+ 	OUString sName;
+ 
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 	XMLFamilyData_Impl aTmp( nFamily );
+ 	XMLFamilyData_Impl *pFamily = 0;
+ 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
+@@ -345,7 +345,7 @@ void SvXMLAutoStylePoolP_Impl::exportXML
+ 	sal_uInt32 nCount = 0;
+ 
+ 	// Get list of parents for current family (nFamily)
+-	sal_uInt32 nPos;
++	ULONG nPos;
+ 	XMLFamilyData_Impl aTmp( nFamily );
+ 	XMLFamilyData_Impl *pFamily = 0;
+ 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
