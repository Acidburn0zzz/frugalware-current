# Last Modified: Fri, 23 Sep 2005 18:20:26 +0200
# Compiling Time: 9.90 SBUs
# Maintainer: VMiklos <vmiklos@frugalware.org>
# Contributor: CSÉCSY László <boobaa@ajrg.hu>

pkgname=mozilla
pkgver=1.7.12
pkgrel=1
pkgdesc="The Mozilla Web Browser"
url="http://www.mozilla.org/"
depends=('gtk+2' 'libidl')
groups=('xapps-extra')
archs=('i686' 'x86_64')
makedepends=('zip')
up2date="lynx -dump http://www.mozilla.org/|grep 'Mozilla icon'|sed 's/.* \(.*\) /\1/'"
source=(http://ftp.mozilla.org/pub/mozilla.org/mozilla/releases/mozilla$pkgver/source/$pkgname-$pkgver-source.tar.bz2 config \
	mozilla-1.7.6-gcc4.patch mozilla-1.7.8-amd64.patch mozilla-gcc4-crash-fix.patch)
sha1sums=('d94251b86d36b8d5e3e45d31a67ebe334f1ba267' \
          'ff302320d8b5a03d23e8f5bb7e48081aa009ae23' \
          '035334857928da20d70c8dbac7f667348f4080dd' \
          'd952fe6541c0f15b00f85d92fbc99fb04f3cc674' \
	  'a52db97ffc190121a580de9d85b29cbab222ad70')

build()
{
	Fcd $pkgname
	Fpatch mozilla-1.7.6-gcc4.patch
	[ "$CARCH" == "x86_64" ] && Fpatch mozilla-1.7.8-amd64.patch
	[ "$CARCH" == "x86_64" ] && Fpatch mozilla-gcc4-crash-fix.patch
	sed "s/-march i686/$CFLAGS/" $startdir/src/config >.mozconfig
	export MOZILLA_OFFICIAL=1
	export BUILD_OFFICIAL=1

	make -f client.mk build || return 1

	Fmkdir /usr/bin
	make DESTDIR=$Fdestdir install
	Frm /etc
	Fmv /usr/lib/mozilla-$pkgver /usr/lib/mozilla
	Fln mozilla /usr/lib/mozilla-$pkgver
	Fln mozilla-$pkgver /usr/include/mozilla
	Frm /usr/share/aclocal/
}

# vim: ft=sh

# optimalization OK
