diff -Naur bluez-pin-0.26/main.c bluez-pin-0.26/main.c
--- bluez-pin-0.26/main.c	2005-09-05 21:11:20.000000000 +0200
+++ bluez-pin-0.26/main.c	2005-09-14 00:17:57.000000000 +0200
@@ -47,8 +47,8 @@
     return bluez_pin_handle_dbus_request (connection, message);
 
   if (dbus_message_is_signal (message,
-                              DBUS_INTERFACE_ORG_FREEDESKTOP_LOCAL,
-                              "Disconnected"))
+                              DBUS_INTERFACE_DBUS,
+                              "NameLost"))
     exit (0);
   
   return DBUS_HANDLER_RESULT_NOT_YET_HANDLED;
@@ -84,7 +84,7 @@
   dbus_connection_register_object_path (connection, new_object_path, &dbus_vtable, NULL);
   dbus_connection_register_object_path (connection, old_object_path, &dbus_vtable, NULL);
 
-  dbus_bus_acquire_service (connection, NEW_SERVICE_NAME, 0, &error);
+  dbus_bus_request_name (connection, NEW_SERVICE_NAME, 0, &error);
   if (dbus_error_is_set (&error))
     {
       fprintf (stderr, "Failed to acquire %s service: %s\n", NEW_SERVICE_NAME, error.message);
@@ -92,7 +92,7 @@
       errors++;
     }
 
-  dbus_bus_acquire_service (connection, OLD_SERVICE_NAME, 0, &error);
+  dbus_bus_request_name (connection, OLD_SERVICE_NAME, 0, &error);
   if (dbus_error_is_set (&error))
     {
       fprintf (stderr, "Failed to acquire %s service: %s\n", OLD_SERVICE_NAME, error.message);
diff -Naur bluez-pin-0.26/pin-dbus.c bluez-pin-0.26/pin-dbus.c
--- bluez-pin-0.26/pin-dbus.c	2005-09-05 21:09:13.000000000 +0200
+++ bluez-pin-0.26/pin-dbus.c	2005-09-14 00:22:20.000000000 +0200
@@ -42,9 +42,9 @@
 #ifndef HAVE_DBUS_MESSAGE_ITER_GET_BASIC
   DBusMessageIter iter;
 
-  dbus_message_append_iter_init (message, &iter);
+  dbus_message_iter_init_append (message, &iter);
   if (pin)
-    dbus_message_iter_append_string (&iter, pin);
+    dbus_message_iter_append_basic (&iter, DBUS_TYPE_STRING, &pin);
 #else
   dbus_message_append_args(message,
 			DBUS_TYPE_STRING, &pin,
@@ -95,7 +95,7 @@
 #ifdef HAVE_DBUS_MESSAGE_ITER_GET_BASIC
   dbus_message_iter_get_basic (&iter, &out);
 #else
-  out = dbus_message_iter_get_boolean (&iter);
+  dbus_message_iter_get_basic (&iter, &out);
 #endif
 
   if (! dbus_message_iter_next (&iter))
@@ -106,6 +106,7 @@
     }
 
   type = dbus_message_iter_get_arg_type (&iter);
+  dbus_message_iter_get_fixed_array (&iter, &bytes, &nbytes);
 
 #ifdef HAVE_DBUS_MESSAGE_ITER_GET_BASIC
   nbytes = 0;
@@ -114,7 +115,6 @@
   if (nbytes != sizeof (bdaddr))
 #else
   if (type != DBUS_TYPE_ARRAY
-      || ! dbus_message_iter_get_byte_array (&iter, &bytes, &nbytes)
       || nbytes != sizeof (bdaddr))
 #endif
   {
