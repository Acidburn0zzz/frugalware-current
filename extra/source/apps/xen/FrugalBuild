# Last Modified: Tue, 19 Jul 2005 21:18:51 +0200
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=xen
pkgver=2.0.6
pkgrel=1
pkgdesc="The Xen virtual machine monitor"
url="http://www.cl.cam.ac.uk/Research/SRG/netos/xen/"
depends=('iproute2' 'bridge-utils' 'twisted' 'curl')
groups=('apps-extra')
archs=('i686')
up2date="lynx -dump $url/downloads/|grep xen-[0-9\.]*.src.tgz$|sed -n 's/.*-\(.*\)-s.*/\1/;$ p'"
source=($url/downloads/$pkgname-$pkgver-src.tgz $pkgname-$pkgver-binutils.diff)
# lynx -dump $url/downloads/xen-$pkgver-src.tgz-md5
md5sums=('fcb4ea295b1ecbf7890d48bf721896a8' 'eed14a81d070880abcb23d252db90887')

# originally based on http://people.pwf.cam.ac.uk/pjt47/xentoo/
# TODO: it would be a good idea to create a xen-source pkg to provide the kernel
# source patched for xen

build()
{
	Fcd $pkgname-`echo $pkgver|sed 's/\.[0-9]$//'`
	Fpatchall
	Fsed 'tail -1' 'tail -n 1' xen/Makefile
	make xen || return 1
	make tools || return 1
	Fmakeinstall -C xen
	Fmakeinstall -C tools
	Fmv /etc/init.d /etc/rc.d
	Fmv /etc/rc.d/xend /etc/rc.d/rc.xend
	Fmv /etc/rc.d/xendomains /etc/rc.d/rc.xendomains
}

# vim: ft=sh

# optimalization OK
