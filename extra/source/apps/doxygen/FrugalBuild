# Last Modified: Thu, 06 Oct 2005 12:58:58 +0200
# Compiling Time: 0.88 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>

pkgname=doxygen
pkgver=1.4.5
pkgrel=1
pkgdesc="Doxygen is the documentation system for C/C++"
url="http://www.doxygen.org/"
depends=('gcc' 'libpng')
groups=('apps-extra')
archs=('x86_64' 'i686')
up2date="lynx -dump ftp://ftp.stack.nl/pub/users/dimitri/|grep 'doxygen-[0-9\.]*src.tar.gz'|tail -n 1|sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'| sed -n 's/.src//;1 p'"
source=(ftp://ftp.stack.nl/pub/users/dimitri/$pkgname-$pkgver.src.tar.gz \
	doxygen-cflags-and-misc-fixes.patch \
	doxygen-use-system-png.patch)
sha1sums=('cbd01c0f1369cdd078c7bee4646559f805bfb237' \
          '08e08e9fee37844a00db0eb261bd704c95ac109e' \
          '782d202479a8146e748b02385e9764a47a821098')

build ()
{
	Fcd
	sed -i.orig -e "s:^\(TMAKE_CFLAGS_RELEASE\t*\)= .*$:\1= ${CFLAGS}:" \
	    -e "s:^\(TMAKE_CXXFLAGS_RELEASE\t*\)= .*$:\1= ${CXXFLAGS}:" \
	    tmake/lib/linux-g++/tmake.conf
	Fpatchall
	# Do not replace with Fbuild or Fconf or any F* macros !!!
	./configure --prefix $Fdestdir/usr --release
	make DESTDIR=$Fdestdir all
	make docs
	make install INSTALL=$Fdestdir/usr
	Fmkdir usr/share/doc/$pkgname-$pkgver/
	cp -a $Fsrcdir/$pkgname-$pkgver/html/ \
		$Fdestdir/usr/share/doc/$pkgname-$pkgver
}

# optimalization OK

# vim: ft=sh
