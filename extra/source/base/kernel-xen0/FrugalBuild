# Last Modified: Sun, 12 Feb 2006 21:34:09 +0000
# Compiling Time: 8.02 SBU
# Maintainer: alex_extreme <alex.extreme2@gmail.com>

pkgname=kernel-xen0
pkgver=2.6.16
pkgrel=1
pkgdesc="Privelaged Xen virtual machine kernel"
url="http://www.cl.cam.ac.uk/Research/SRG/netos/xen/"
depends=('xen' 'module-init-tools')
groups=('base-extra')
archs=('i686')
up2date="lynx -dump http://ftp.frugalware.org/pub/other/people/alex/|grep tar.bz2$|sed -n 's/.*x-\([^-]*\)-.*/\1/;$ p'"
source=(http://ftp.frugalware.org/pub/other/people/alex/linux-$pkgver-xen.tar.bz2 \
	config \
	README.Frugalware)

sha1sums=('5533d720db7189da0507686ebb5e8d7e5cdaa7ad' \
          '47c66bdc046b46fb8cc86d320046b851d179873a' \
	  'b2243c3cf51195fe45ea472e45369a772204d935')

build()
{
	Fcd linux-$pkgver-xen
	
	cp $Fsrcdir/config .config
	yes "" | make config
	Fsed "EXTRAVERSION =.*" "EXTRAVERSION = -fw$pkgrel-xen0" Makefile
	
	make || return 1
	
	Fmkdir /boot
	Ffilerel .config /boot/config-$pkgver-fw$pkgrel-xen0
	Ffilerel vmlinuz \
		/boot/vmlinuz-$pkgver-fw$pkgrel-xen0
	Fmkdir /lib/modules
	make INSTALL_MOD_PATH=$Fdestdir modules_install || return 1
	Ffilerel System.map /boot/System.map-$pkgver-fw$pkgrel-xen0
	Frm /lib/modules/$pkgver-fw$pkgrel-xen0/build
	Frm /lib/modules/$pkgver-fw$pkgrel-xen0/source
	Fdoc README.Frugalware
}

# vim: ft=sh

# optimalization OK
